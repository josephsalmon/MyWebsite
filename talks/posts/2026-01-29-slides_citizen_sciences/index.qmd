---
# description: |
date: "2026-29-01"
title-slide-attributes:
  center-title-slide: false
format:
  revealjs:
    # preview-links: true
    code-link: true
    highlight-style: a11y
    width: 1280
    height: 720
    theme: local.scss
    slideNumber: true
    jupyter: python3
    pdf-separate-fragments: false
    pdf-max-pages-per-slide: 1
    view-distance: 100
    mobile-view-distance: 100
    include-in-header:
      - text: |
          <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
bibliography: references.bib
csl: https://www.zotero.org/styles/apa
cite-method: citeproc
link-citations: true
resources:
    - "*.html"

---

::: {.hidden}
{{

\DeclareMathOperator*{\argmax}{arg\,max}
\newcommand{\1}{{1\hspace{-3.8pt} 1}}

}}
:::

<style>
    .vertical-line{
        display: inline-block;
        border-left: 6px solid rgb(0, 0, 0);
        margin: 0 10px;
      height: 500px;
        border-radius: 3px;
        overflow: hidden;

}
@import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Nunito:wght@200;300;400;500;600;700;800;900&family=Roboto+Mono:wght@300;400&family=Sanchez&display=swap');

/* Set default font for entire SVG */
svg {
    font-family: 'Nunito Bold', 'Arial', sans-serif;
}

/* Specific targeting for dinov2 SVG numbers */
img[src*="dinov2-PN.svg"] + svg text,
img[src*="dinov2-PN.svg"] + svg tspan {
    font-family: 'Nunito', sans-serif !important;
    font-weight: 800 !important;
}

/* Specific targeting for dinov2 SVG numbers - extra weight */
svg text:contains("DinoV2"), 
svg tspan:contains("DinoV2"),
svg text:contains("224"), 
svg tspan:contains("224"),
svg text:contains("518") {
    font-family: 'Nunito', Arial, sans-serif !important;
    font-weight: 800 !important;
}

/* Force Nunito for any SVG that might be inline */
object[data*=".svg"] text,
object[data*=".svg"] tspan,
embed[src*=".svg"] text,
embed[src*=".svg"] tspan {
    font-family: 'Nunito', Arial, sans-serif !important;
}


/* avoid scrolling bar and set refs content size */
#refs {
    font-size: 150% !important;
    overflow: visible !important;
    max-height: none !important;
    height: auto !important;
}
.reveal .slides section {
    overflow: visible !important;
}
.reveal .slides {
    overflow: visible !important;
}
.reveal {
    overflow: visible !important;
}


.img-author-container {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-width: 180px;
    box-sizing: border-box;
}
.img-author-img {
    display: block;
    width: 100% !important;
    object-fit: contain !important;
    background: transparent;
    border-radius: 8px;
    position: relative;
    z-index: 1;
}
.img-author-overlay {
    position: absolute;
    top: 15px;
    right: 35px;
    background: rgba(0,0,0,0.5);
    color: #fff;
    padding: 1px 6px;
    border-radius: 8px;
    font-size: 0.5em;
    font-family: Nunito, Arial, sans-serif;
    font-weight: bold;
    z-index: 2;
    pointer-events: none;
}

/* Make captions immune to long names and keep grid aligned */
.img-author-caption {
     text-align: center;
     font-size: 0.75em;
     color: #222;
     margin-top: 2px;
     font-family: Nunito, Arial, sans-serif;
     height: 2.6em; /* fixed height for one line */
     line-height: 1.3em;
     white-space: normal;
     overflow: hidden;
     text-overflow: ellipsis;
     width: 100%;
     display: block;
}


/* PDF print adjustments */
@media print {
    .reveal .slides section {
        page-break-after: always !important;
        overflow: visible !important;
        height: 100% !important;
    }
    .reveal .slides {
        width: 100% !important;
        height: 100% !important;
        zoom: 1 !important;
        transform: none !important;
    }
}

#filter-container > div,
#filter-container-2 > div { /* legendBox */
    padding: 5px !important;
    max-width: 100% !important;
}
#filter-container > div > div:first-child,
#filter-container-2 > div > div:first-child { /* legendTitle */
    font-size: 12px !important;
    margin-bottom: 2px !important;
    padding-bottom: 2px !important;
}
#filter-container > div > div:last-child,
#filter-container-2 > div > div:last-child { /* legendGrid */
    gap: 5px !important;
    grid-template-columns: repeat(4, 1fr) !important;
}
/* Flatten the column grouping divs to allow 4-column flow */
#filter-container > div > div:last-child > div:nth-child(n+2),
#filter-container-2 > div > div:last-child > div:nth-child(n+2) {
    display: contents !important;
}
/* Hide the sub-headers (At Group, etc.) */
#filter-container div[role="heading"],
#filter-container-2 div[role="heading"] {
    display: none !important;
}
#filter-container label,
#filter-container-2 label {
    font-size: 10px !important;
    margin-left: 4px !important;
}
#filter-container .status-color-box,
#filter-container-2 .status-color-box {
    width: 10px !important;
    height: 10px !important;
    margin-right: 4px !important;
}
#filter-container input[type="checkbox"],
#filter-container-2 input[type="checkbox"] {
    transform: scale(0.7);
    margin: 0 !important;
}
/* Select All row */
#filter-container > div > div:last-child > div:first-child label,
#filter-container-2 > div > div:last-child > div:first-child label {
    font-size: 11px !important;
}
/* Reduce vertical padding on rows */
#filter-container > div > div:last-child > div > div,
#filter-container-2 > div > div:last-child > div > div {
    padding: 0px !important;
}

</style>

<!------------------------------------------------------------------------ -->
#### {#title-slide data-menu-title="Title Slide" background="#053660"}

[Citizen science & machine learning for plant Identification: challenges from Pl@ntNet]{.custom-title}


<br>

<!-- <hr class="hr-teal"> -->

:::: {.columns}

::: {.column width="48% border-right:5px solid rgb(0, 0, 0);"}
[Joseph Salmon]{.custom-subtitle2}

[IMAG, Univ Montpellier, CNRS, Inria, Montpellier, France]{.custom-subtitle3}
<div style="text-align: center;">

![](../../images/team_logo.svg){width=100% style="display: block; margin-left: 0; margin-right: auto;"}

</div>

:::

::: {.column width="2%"}

<span class="vertical-line"></span>

:::

::: {.column width="48%"}

<div style="text-align: center;">

[Consortium  Pl@ntnet]{.custom-subtitle2}

![](../../images/plantnet_consortium.svg){width=89%}

</div>

:::

::::



<!------------------------------------------------------------------------ -->
# Pl@ntNet insights {.section-background}
<!------------------------------------------------------------------------ -->



<!------------------------------------------------------------------------- -->
### Pl@ntNet: ML for citizen science
<hr>


::::{.columns}

::: {.column width="30%"}
![](../2024-09-25_slides_sierra/images/plantnet-logo-title.26755cd.svg){width=106%}
:::

::: {.column width="69%"}
A **citizen science** platform using machine learning to help people identify plants with their mobile phones



:::

::::

:::: {.columns style='display: flex !important'}

::: {.column width="55%"}

<div style="text-align: center;">

<img src="../2024-09-25_slides_sierra/images/plantnet_app.jpg" width="55%" align="middle">

- **Birth**: Montpellier,  2009
- **Website**: [https://plantnet.org/](https://plantnet.org/)
- **[Note]{.underline}**: no mushroom identification!
</div>
:::


::: {.column width="30%"}
![](../2024-09-25_slides_sierra/images/plantnet_image_ambiguity_js.svg){width=60%}
:::



::: {.column width="15%"}


::: {layout-nrow=3  .v-center-container}

<br>
<br>
<br>
<br>

<img src="../2025-04-03-IAUM/images/AppStore_FR-1.png" width="100%" align="middle">
<img src="../2025-04-03-IAUM/images/Google_FR-1.png" width="100%" align="middle">
<img src="../2025-04-03-IAUM/images/identifyFR.png" width="100%" align="middle">

:::

:::

::::
<!------------------------------------------------------------------------ -->








<!------------------------------------------------------------------------ -->
### {{< iconify hugeicons:chatting-01 >}} Pl@ntNet: usage
<hr>

<br>
<div style="text-align: center;">

<img src="../2024-09-25_slides_sierra/images/plantnet_usage_rasterized.svg" width="95%" align="middle" >

</div>
<!------------------------------------------------------------------------




<!------------------------------------------------------------------------ -->
###

<div style="text-align: center;">
  <iframe src="https://identify.plantnet.org/stats" width="850" height="700" style="border: none; display: inline-block;"></iframe>
</div>


<!------------------------------------------------------------------------ -->
### {{< iconify streamline-ultimate:workflow-teamwork-user-high-five-bold >}} The current Pl@ntNet Team
<!-- copy paste here the full list of plantnet pople -->
```{=html}
<style>
    /* Custom gap and width for 4 images per row */
    .img-author-group-centered.img-4-per-row {
        gap: 3vw 3vw !important;
        justify-content: center;
    }
    .img-author-group-centered.img-4-per-row .img-author-container {
        width: 22vw !important;
        min-width: 180px;
        max-width: 24vw;
    }
</style>
<div class="img-author-group-centered img-4-per-row">
<style>
    .team-slide-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 1px 1px;
        font-size: 40%;
        margin: 0 auto;
        max-width: 1200px;
    }
    .team-member {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 180px;
        margin-bottom: 10px;
    }
    .team-member img + p {
        margin-top: -2px !important;
    }

.img-author-group-centered {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    align-items: flex-start;
    gap: 0.5em 0.5em;
    width: 100%;
    margin: 0 auto 1em auto;
}
</style>
<div class="team-slide-container">

<div class="team-member" id="AlexisJoly">
                        <img decoding="async" src="https://plantnet.org/wp-content/uploads/2023/11/Sans-titre.jpg" style="border-radius: 100px;width: 85px; height:85px; object-fit: cover;">
<p style="text-align: center;">
                            <strong>Alexis Joly</strong><br>
                            Primary investigator, INRIA<br>
                            <a href="https://www.researchgate.net/profile/Alexis-Joly">ResearchGate</a>
                        </p>
</div>
<div class="team-member" id="PierreBonnet">
                        <img decoding="async" src="https://plantnet.org/wp-content/uploads/2023/11/image-20221012-11-obdm4k.jpg" style="border-radius: 100px;width: 85px; height:85px; object-fit: cover;">
<p style="text-align: center;">
                            <strong>Pierre Bonnet</strong><br>
                            Primary investigator, CIRAD<br>
                            <a href="https://www.researchgate.net/profile/Pierre-Bonnet-5">ResearchGate</a>
                        </p>
</div>
<div class="team-member" id="HervéGoëau">
                        <img decoding="async" src="https://plantnet.org/wp-content/uploads/2023/11/photo_130.jpeg" style="border-radius: 100px;width: 85px; height:85px; object-fit: cover;">
<p style="text-align: center;">
                            <strong>Hervé Goëau</strong><br>
                            Researcher, CIRAD<br>
                            <a href="https://www.researchgate.net/profile/Herve-Goeau">ResearchGate</a>
                        </p>
</div>
<div class="team-member" id="AntoineAffouard">
                        <img decoding="async" src="https://plantnet.org/wp-content/uploads/2023/11/1700494763648.jpg" style="border-radius: 100px;width: 85px; height:85px; object-fit: cover;">
<p style="text-align: center;">
                            <strong>Antoine Affouard</strong><br>
                            Backend &amp; Staff engineer, INRIA<br>
                            <a href="https://www.linkedin.com/in/antoine-affouard-044b01a3/">LinkedIn</a>
                        </p>
</div>
<div class="team-member" id="Jean-ChristopheLombardo">
                        <img decoding="async" src="https://plantnet.org/wp-content/uploads/2023/11/1562916381981.jpg" style="border-radius: 100px;width: 85px; height:85px; object-fit: cover;">
<p style="text-align: center;">
                            <strong>Jean-Christophe Lombardo</strong><br>
                            IA engineer, INRIA<br>
                            <a href="https://www.linkedin.com/in/jeanchristophelombardo">LinkedIn</a>
                        </p>
</div>
<div class="team-member" id="MathiasChouet">
                        <img decoding="async" src="https://plantnet.org/wp-content/uploads/2023/11/chouet_mathias_c4c.jpg" style="border-radius: 100px;width: 85px; height:85px; object-fit: cover;">
<p style="text-align: center;">
                            <strong>Mathias Chouet</strong><br>
                            Backend engineer, CIRAD<br>
                            <a href="https://github.com/matcho">GitHub</a>
                        </p>
</div>
<div class="team-member" id="HugoGresse">
                        <img decoding="async" src="https://plantnet.org/wp-content/uploads/2023/11/HTukpCAn_400x400-1.jpg" style="border-radius: 100px;width: 85px; height:85px; object-fit: cover;">
<p style="text-align: center;">
                            <strong>Hugo Gresse</strong><br>
                            Mobile engineer, INRIA<br>
                            <a href="https://github.com/HugoGresse/">GitHub</a> | <a href="https://www.linkedin.com/in/hugogresse/">LinkedIn</a>
                        </p>
</div>
<div class="team-member" id="ThomasPaillot">
                        <img decoding="async" src="https://plantnet.org/wp-content/uploads/2023/11/1633618903597.jpg" style="border-radius: 100px;width: 85px; height:85px; object-fit: cover;">
<p style="text-align: center;">
                            <strong>Thomas Paillot</strong><br>
                            Front engineer, INRIA<br>
                            <a href="https://www.linkedin.com/in/thomaspaillot/">LinkedIn</a>
                        </p>
</div>
<div class="team-member" id="RémiPalard">
                        <img decoding="async" src="https://plantnet.org/wp-content/uploads/2023/11/1668098526264.jpg" style="border-radius: 100px;width: 85px; height:85px; object-fit: cover;">
<p style="text-align: center;">
                            <strong>Rémi Palard</strong><br>
                            Geo &amp; Fullstack engineer, CIRAD<br>
                            <a href="https://www.linkedin.com/in/remi-palard/">LinkedIn</a>
                        </p>
</div>
<div class="team-member" id="VanessaHequet">
                        <img decoding="async" src="https://plantnet.org/wp-content/uploads/2023/11/vanessa.jpg" style="border-radius: 100px;width: 85px; height:85px; object-fit: cover;">
<p style="text-align: center;">
                            <strong>Vanessa Hequet</strong><br>
                            Botanist, IRD<br>
                            <a href="https://www.linkedin.com/in/vanessa-hequet-1a091b180/">LinkedIn</a>
                        </p>
</div>
<div class="team-member" id="MurielleSimo-Droissart">
                        <img decoding="async" src="https://plantnet.org/wp-content/uploads/2024/03/murielle_3-scaled.jpg" style="border-radius: 100px;width: 85px; height:85px; object-fit: cover;">
<p style="text-align: center;">
                            <strong>Murielle Simo-Droissart</strong><br>
                            Botanist, IRD<br>
                            <a href="https://www.researchgate.net/profile/Murielle-Simo-Droissart">ResearchGate</a>
                        </p>
</div>
<div class="team-member" id="ThéoSimoes">
                        <img decoding="async" src="https://plantnet.org/wp-content/uploads/2024/10/theo.simoes.jpg" style="border-radius: 100px;width: 85px; height:85px; object-fit: cover;">
<p style="text-align: center;">
                            <strong>Théo Simoes</strong><br>
                            Backend engineer, INRAE<br>
                            <a href="https://www.linkedin.com/in/th%C3%A9o-simoes-311480157/">LinkedIn</a>
                        </p>
</div>
<div class="team-member" id="Jean-MarcSadaillan">
                        <img decoding="async" src="https://plantnet.org/wp-content/uploads/2025/01/jean-marc_sadaillan.jpg" style="border-radius: 100px;width: 85px; height:85px; object-fit: cover;">
<p style="text-align: center;">
                            <strong>Jean-Marc Sadaillan</strong><br>
                            Project manager, INRAE<br>
                            <a href="https://fr.linkedin.com/in/jean-marc-sadaillan/">LinkedIn</a>
                        </p>
</div>
<div class="team-member" id="ChristopheBotella">
                        <img decoding="async" src="https://plantnet.org/wp-content/uploads/2025/05/44.jpg" style="border-radius: 100px;width: 85px; height:85px; object-fit: cover;">
<p style="text-align: center;">
                            <strong>Christophe Botella</strong><br>
                            Researcher, INRIA<br>
                            <a href="https://www.researchgate.net/profile/Christophe-Botella?ev=hdr_xprf">ResearchGate</a>
                        </p>
</div>
<div class="team-member" id="JosephSalmon">
                        <img decoding="async" src="https://plantnet.org/wp-content/uploads/2025/09/joseph_2018.png" style="border-radius: 100px;width: 85px; height:85px; object-fit: cover;">
<p style="text-align: center;">
                            <strong>Joseph Salmon</strong><br>
                            Researcher, INRIA<br>
                            <a href="https://josephsalmon.eu/">Website</a>
                        </p>
</div>
<div class="team-member" id="BenjaminBourel">
                        <img decoding="async" src="https://plantnet.org/wp-content/uploads/2025/09/IMG_20210524_111031_modifi.jpg" style="border-radius: 100px;width: 85px; height:85px; object-fit: cover;">
<p style="text-align: center;">
                            <strong>Benjamin Bourel</strong><br>
                            Researcher, INRIA<br>
                            <a href="https://www-sop.inria.fr/members/Benjamin.Bourel/">Website</a>
                        </p>
</div>
<div class="team-member" id="ThéoLarcher">
                        <img decoding="async" src="https://plantnet.org/wp-content/uploads/2023/12/photo_passe_partout1.jpeg" style="border-radius: 100px;width: 85px; height:85px; object-fit: cover;">
<p style="text-align: center;">
                            <strong>Théo Larcher</strong><br>
                            PhD candidate, INRIA<br>
                            <a href="https://www.linkedin.com/in/th%C3%A9o-larcher-3405a5147/">LinkedIn</a>
                        </p>
</div>
<div class="team-member" id="GiulioMartellucci">
                        <img decoding="async" src="https://plantnet.org/wp-content/uploads/2026/01/1666560273150.jpg" style="border-radius: 100px;width: 85px; height:85px; object-fit: cover;">
<p style="text-align: center;">
                            <strong>Giulio Martellucci</strong><br>
                            PhD candidate, INRIA<br>
                            <a href="https://www.linkedin.com/in/giulio-martellucci-a05232176/">LinkedIn</a>
                        </p>
</div>
<div class="team-member" id="RaphaëlBenerradi">
                        <img decoding="async" src="https://plantnet.org/wp-content/uploads/2026/01/1645482074565.jpg" style="border-radius: 100px;width: 85px; height:85px; object-fit: cover;">
<p style="text-align: center;">
                            <strong>Raphaël Benerradi</strong><br>
                            PhD candidate, INRIA<br>
                            <a href="https://www.linkedin.com/in/rapha%C3%ABl-benerradi-531a83196/">LinkedIn</a>
                        </p>
</div>
<div class="team-member" id="IlyassMoummad">
                        <img decoding="async" src="https://plantnet.org/wp-content/uploads/2026/01/Ilyass-Moummad.webp" style="border-radius: 100px;width: 85px; height:85px; object-fit: cover;">
<p style="text-align: center;">
                            <strong>Ilyass Moummad</strong><br>
                            Post-doc, INRIA<br>
                            <a href="https://ilyassmoummad.github.io/">Personal website</a> | <a href="https://scholar.google.com/citations?user=2hA2XZcAAAAJ&amp;hl=en">Google Scholar</a>
                        </p>
</div>

</div>
```
<!-------------------------------------------------------------------------- -->





<!-------------------------------------------------------------------------- -->

### {{< iconify fluent:people-community-20-filled >}} Pl@ntNet & Cooperative Learning

::: {.r-stack}
![](../2024-09-25_slides_sierra/images/plantnet_schema_global_js_0.svg){.fragment width=100% fragment-index=2}

![](../2024-09-25_slides_sierra/images/plantnet_schema_global_js_1.svg){.fragment width=100% fragment-index=3}

![](../2024-09-25_slides_sierra/images/plantnet_schema_global_js_2.svg){.fragment width=100% fragment-index=4}

![](../2024-09-25_slides_sierra/images/plantnet_schema_global_js_3.svg){.fragment width=100% fragment-index=5}

![](../2024-09-25_slides_sierra/images/plantnet_schema_global_js_4.svg){.fragment width=100% fragment-index=6}
<!-- SVG fonts embedding trick -->
<!-- https://lvngd.com/blog/how-embed-google-font-svg/ -->
<!-- https://amio.github.io/embedded-google-fonts/ -->
:::
<!------------------------------------------------------------------------ -->



<!------------------------------------------------------------------------ -->
### {{< iconify vaadin:hourglass-start >}} Chronology of Pl@ntNet {.center }
<hr>


<center>
<img src="images/PlantNet-overview-Janv-2026_en.svg" width="80%" >


**Note:** I am mostly innocent, I started working with the Pl@ntNet team in 2020

</center>
<!------------------------------------------------------------------------ -->


<!------------------------------------------------------------------------ -->
### {{< iconify eos-icons:science >}} Scientific challenges
<hr>

:::: {.columns style='display: flex !important'}

::: {.column width="50%"}

- Collaborative effort, involving:
    - machine learners
    - ecologist
    - engineers
    - amateurs

:::


::: {.column width="50%" .fragment}

- Open problems:
    - theoretical
    - methodological
    - computational (due to the size of the problems)
    - interfacing many disciplines
:::
::::


. . .


<center>
![](images/liftarn_Uncle_Sam_pointing.svg){width=23%}

**[We need you]{.underline}**: come and help us improve it!

</center>

<!------------------------------------------------------------------------ -->



<!------------------------------------------------------------------------ -->
# Contributions {.section-background}
<!------------------------------------------------------------------------ -->


<!------------------------------------------------------------------------ -->
### {{<iconify bxs:user-detail>}} Some personal contributions
<hr>

<br>

:::: {.columns }

::: {.column width="68%"}

- **Pl@ntNet-300K** [@Garcin_Joly_Bonnet_Affouard_Lombardo_Chouet_Servajean_Lorieul_Salmon2021]: **Creation** and **release** of a large-scale dataset sharing the same property (Long Tail!) as Pl@ntNet; available for the community to improve learning systems

:::

::: {.column width="29%"}

<center>
<img src="../2024-09-25_slides_sierra/images/sample_genus.svg" width="62%" align="middle">
</center>
<br>
:::

::::



::: fragment

:::: columns

::: {.column width="68%"}

- **Prediction uncertainty quantification** with long tail data [@Ding_Fermanian_Salmon25] : providing prediction sets with statistical guarantees with Conformal Prediction

:::

::: {.column width="29%"}
<center>
<img src="../../../blog/long-tail/GMM.png" width="78%" align="middle">
</center>
<br>
:::

::::

:::


::: fragment

:::: columns

::: {.column width="68%"}

- **Learning & crowd-sourced data** [@Lefort_Charlier_Joly_Salmon22] and [@Lefort_etal24]: How to leverage multiple labels per image to improve the model? Need to **assert quality**: the workers, the images/labels, the model, etc.

:::

::: {.column width="29%"}
<center>
<img src="../2024-09-25_slides_sierra/images/fullpipeline_small.svg" width="78%" align="middle">
</center>
<br>
:::

::::

:::


<!------------------------------------------------------------------------ -->





<!------------------------------------------------------------------------ -->
# Pl@ntNet data characteristics {.section-background}
<!------------------------------------------------------------------------ -->



<!------------------------------------------------------------------------ -->
### {{<iconify roentgen:tree-with-leaf>}} Plants trivia
<hr>
<br>

```{=html}
<div style="display: flex; gap: 2vw; max-width: 98%; margin: 0 auto; align-items: flex-start; justify-content: center;">

    <div style="height:75%; text-align: center; position: relative;">
        <img src="images/biomass.svg" alt="Biomass on earth" style="width: 100%; height: auto; max-height: 450px; object-fit: contain;">
```


<div style="font-size: 0.75em; margin-top: 5px; text-align: center;">Biomass on earth [@bar2018biomass]</div>


```{=html}
    </div>

    <div style="height:75%; text-align: center; position: relative;">
        <img src="images/Diversity_of_plants_(Streptophyta)_version_2.png" alt="Diversity of plants" style="width: 100%; height: auto; max-height: 450px; object-fit: contain;">
        <span class="img-author-overlay" style="top: 15px;
    right: 15px;">@ Rkitko (Wikimedia Commons)</span>
        <div style="font-size: 0.75em; margin-top: 5px;">Diversity: 400K+ species</div>
    </div>

    <div style="height:75%; text-align: center; position: relative;">
        <img src="images/03. Angiosperm Tree of Life_RBG_Kew_36_ppi.jpg.webp" alt="Angiosperm Tree of Life" style="width: 100%; height: auto; max-height: 450px; object-fit: contain;">
        <span class="img-author-overlay">© RBG Kew</span>
        <div style="font-size: 0.75em; margin-top: 5px;">Angiosperm Tree of Life</div>
    </div>
</div>  
```
<br>

. . .

<center>
**[Consequences]{.underline}**: for supervised learning, the classes are **many** and **hierarchically structured**
</center>
<!------------------------------------------------------------------------ -->




<!------------------------------------------------------------------------ -->
### Intra-class variability


```{=html}
<div class="img-author-group-centered" style="gap:0.7em; align-items:stretch;">
  <div class="img-author-container" style="width:19%; min-width:120px;">
      <img src="images/66c06ee4e4fd35c5a58b4d0b97dffcb2053a41d3.jpg" alt="Guizotia abyssinica (L.f.) Cass." class="img-author-img" style="width:100%;">
      <span class="img-author-overlay">© Benoît Janichon</span>
      <span class="img-author-caption"><span style="font-style:italic">Guizotia abyssinica</span> (L.f.) Cass.</span>
  </div>
  <div class="img-author-container" style="width:19%; min-width:120px;">
      <img src="images/858de40efb7c3c934e320429634aaef273c16878.jpg" alt="Diascia rigescens E.Mey. ex Benth." class="img-author-img" style="width:100%;">
      <span class="img-author-overlay">© Patrice SIROT</span>
      <span class="img-author-caption"><span style="font-style:italic">Diascia rigescens</span> E.Mey. ex Benth.</span>
  </div>
  <div class="img-author-container" style="width:19%; min-width:120px;">
      <img src="images/6ad45f4e4d2454728e6e41847dc8267227fc9b0d.jpg" alt="Lapageria rosea Ruiz & Pav." class="img-author-img" style="width:100%;">
      <span class="img-author-overlay">© Borquez Vicent</span>
      <span class="img-author-caption"><span style="font-style:italic">Lapageria rosea</span> Ruiz & Pav.</span>
  </div>
  <div class="img-author-container" style="width:19%; min-width:120px;">
      <img src="images/5b4cd720ce747c8a53e09e0caa2dc43f12b62610.jpg" alt="Casuarina cunninghamiana Miq. LC" class="img-author-img" style="width:100%;">
      <span class="img-author-overlay">© Наталья</span>
      <span class="img-author-caption"><span style="font-style:italic">Casuarina cunninghamiana</span> Miq. LC</span>
  </div>
  <div class="img-author-container" style="width:19%; min-width:120px;">
      <img src="../2024-09-25_slides_sierra/images/6_b.jpg" alt="Guizotia abyssinica (L.f.) Cass." class="img-author-img" style="width:100%;">
      <span class="img-author-overlay">© Annette Bejany</span>
      <span class="img-author-caption"><span style="font-style:italic">Guizotia abyssinica</span> (L.f.) Cass.</span>
  </div>
  <div class="img-author-container" style="width:19%; min-width:120px;">
      <img src="images/0231e8d9cb679d11e814a1f8c4227bd6cf7d2fe6.jpg" alt="Diascia rigescens E.Mey. ex Benth." class="img-author-img" style="width:100%;">
      <span class="img-author-overlay">© A Lee</span>
      <span class="img-author-caption"><span style="font-style:italic">Diascia rigescens</span> E.Mey. ex Benth.</span>
  </div>
    <div class="img-author-container" style="width:19%; min-width:120px;">
        <img src="images/ba4b0161aa17c364744ec58b69a9f77f26a4d8ce.jpg" alt="Lapageria rosea Ruiz & Pav.
" class="img-author-img" style="width:100%;">
    <span class="img-author-overlay">© Daniel Barthelemy</span>
    <span class="img-author-caption"><span style="font-style:italic">Lapageria rosea</span> Ruiz & Pav.</span>
    </div>
    <div class="img-author-container" style="width:19%; min-width:120px;">
        <img src="images/fa8e288f400456e08994113b3217a4cd2e1238df.jpg" alt="Casuarina cunninghamiana Miq. LC" class="img-author-img" style="width:100%;">
    <span class="img-author-overlay">© Campos Ignacio</span>
    <span class="img-author-caption"><span style="font-style:italic">Casuarina cunninghamiana</span> Miq. LC</span>
    </div>
</div>
```


<center>
**Based on pictures only, plant species are challenging to discriminate!**
</center>
<!-------------------------------------------------------------------------- -->




### Inter-class ambiguity


```{=html}
<div class="img-author-group-centered" style="gap:0.7em; align-items:stretch;">
  <div class="img-author-container" style="width:19%; min-width:120px;">
    <img src="images/12d7b180752393e86822c1fff68df8f8a19189fe.jpg" alt="Cirsium rivulare (Jacq.) All." class="img-author-img" style="width:100%;">
    <span class="img-author-overlay">© stefano mazzotti</span>
    <span class="img-author-caption"><span style="font-style:italic">Cirsium rivulare</span> (Jacq.) All.</span>
  </div>
  <div class="img-author-container" style="width:19%; min-width:120px;">
    <img src="images/565322614481c3092ce52239a62725f1992be393.jpg" alt="Chaerophyllum aromaticum L." class="img-author-img" style="width:100%;">
    <span class="img-author-overlay">© buqa Jarmil</span>
    <span class="img-author-caption"><span style="font-style:italic">Chaerophyllum aromaticum</span> L.</span>
  </div>
  <div class="img-author-container" style="width:19%; min-width:120px;">
    <img src="images/3f82867ba9d74fe1fd3af3093158634a666dd790.jpg" alt="Adenostyles leucophylla Rchb." class="img-author-img" style="width:100%;">
    <span class="img-author-overlay">© Walter Reider</span>
    <span class="img-author-caption"><span style="font-style:italic">Adenostyles leucophylla</span> Rchb.</span>
  </div>
  <div class="img-author-container" style="width:19%; min-width:120px;">
    <img src="images/7ebd92cd30be0d3476c79908347e4020ce359c61.jpg" alt="Petrosedum montanum (Songeon & E.P.Perrier) Grulich" class="img-author-img" style="width:100%;">
    <span class="img-author-overlay">© furs</span>
    <span class="img-author-caption"><span style="font-style:italic">Petrosedum montanum</span> (Songeon & E.P.Perrier) Grulich</span>
  </div>
  <div class="img-author-container" style="width:19%; min-width:120px;">
    <img src="images/47fad454bb29c34687cf1ab3ee6b456201ea0725.jpg" alt="Cirsium tuberosum (L.) All." class="img-author-img" style="width:100%;">
    <span class="img-author-overlay">© Rene Weck</span>
    <span class="img-author-caption"><span style="font-style:italic">Cirsium tuberosum</span> (L.) All.</span>
  </div>
  <div class="img-author-container" style="width:19%; min-width:120px;">
    <img src="images/ffc5f1b5aab703ea359922c92273ef86791f1662.jpg" alt="Chaerophyllum temulum L." class="img-author-img" style="width:100%;">
    <span class="img-author-overlay">© Jcm Arthur</span>
    <span class="img-author-caption"><span style="font-style:italic">Chaerophyllum temulum</span> L.</span>
  </div>
  <div class="img-author-container" style="width:19%; min-width:120px;">
    <img src="images/92e4cbe38e831d11526946389c2342db4499d436.jpg" alt="Adenostyles alpina (L.) Bluff & Fingerh." class="img-author-img" style="width:100%;">
    <span class="img-author-overlay">© pierre Lamy</span>
    <span class="img-author-caption"><span style="font-style:italic">Adenostyles alpina</span> (L.) Bluff & Fingerh.</span>
  </div>
  <div class="img-author-container" style="width:19%; min-width:120px;">
    <img src="images/dc051dace6de6cbdfe5202a4b900290525bfee3e.jpg" alt="Petrosedum rupestre (L.) P.V.Heath" class="img-author-img" style="width:100%;">
    <span class="img-author-overlay">© Wolfi 41</span>
    <span class="img-author-caption"><span style="font-style:italic">Petrosedum rupestre</span> (L.) P.V.Heath</span>
  </div>
</div>
```

<center>
**Based on pictures only, plant species are challenging to discriminate!**
</center>
<!-------------------------------------------------------------------------- -->




<!-------------------------------------------------------------------------- -->
## Sampling bias {.section-background-small}
<!-------------------------------------------------------------------------- -->


<!-------------------------------------------------------------------------- -->
### {{<iconify gis:globe-earth-alt>}} Geographic bias


<div style="display: flex; flex-direction: column;">
<center>
<img src="../2024-09-25_slides_sierra/images/plantnet_bias_geographic04_04_2024.png" style="width:100%; border-radius: 15px;" alt="Spatial density of images collected by Pl@ntNet (13/04/2024)">

Spatial density of images collected by Pl@ntNet (13/04/2024)
</center>
</div>
<!-------------------------------------------------------------------------- -->




### {{<iconify fluent:food-20-filled>}} Food bias
<hr>

<br>
<center>
Top-5 most observed plant species in Pl@ntNet (13/04/2024):
</center>

<br>


```{=html}
<div class="img-author-group-centered">
      <div class="img-author-container" style="width:19%; min-width:120px;">
        <div style="text-align:center; font-size:1.2em; color:#222; margin-bottom:6px; font-family: Nunito, Arial, sans-serif; font-weight:bold;">25134 obs.</div>
        <div style="position:relative; width:100%;">
            <img src="images/Echium_vulgare_L_1012470528.svg" alt="Echium vulgare L." class="img-author-img">
            <span class="img-author-overlay">© Llandrich anna</span>
        </div>
        <span class="img-author-caption"><span style="font-style:italic">Echium vulgare</span> L.</span>
    </div>
      <div class="img-author-container" style="width:19%; min-width:120px;">
        <div style="text-align:center; font-size:1.2em; color:#222; margin-bottom:6px; font-family: Nunito, Arial, sans-serif; font-weight:bold;">24720 obs.</div>
        <div style="position:relative; width:100%;">
            <img src="images/Ranunculus_ficaria_L_1012578129.svg" alt="Ranunculus ficaria L." class="img-author-img">
            <span class="img-author-overlay">© JYCO</span>
        </div>
        <span class="img-author-caption"><span style="font-style:italic">Ranunculus ficaria</span> L.</span>
    </div>
      <div class="img-author-container" style="width:19%; min-width:120px;">
        <div style="text-align:center; font-size:1.2em; color:#222; margin-bottom:6px; font-family: Nunito, Arial, sans-serif; font-weight:bold;">24103 obs.</div>
        <div style="position:relative; width:100%;">
            <img src="images/Prunus_spinosa_L_1023984740.svg" alt="Prunus spinosa L." class="img-author-img">
            <span class="img-author-overlay">© fuerst.ernst</span>
        </div>
        <span class="img-author-caption"><span style="font-style:italic">Prunus spinosa</span> L.</span>
    </div>
      <div class="img-author-container" style="width:19%; min-width:120px;">
        <div style="text-align:center; font-size:1.2em; color:#222; margin-bottom:6px; font-family: Nunito, Arial, sans-serif; font-weight:bold;">23288 obs.</div>
        <div style="position:relative; width:100%;">
            <img src="images/Zea_mays_L_1020124455.svg" alt="Zea mays L." class="img-author-img">
            <span class="img-author-overlay">© Uta Groger</span>
        </div>
        <span class="img-author-caption"><span style="font-style:italic">Zea mays</span> L.</span>
    </div>
      <div class="img-author-container" style="width:19%; min-width:120px;">
        <div style="text-align:center; font-size:1.2em; color:#222; margin-bottom:6px; font-family: Nunito, Arial, sans-serif; font-weight:bold;">23075 obs.</div>
        <div style="position:relative; width:100%;">
            <img src="images/Alliaria_petiolata_1013116480.svg" alt="Alliaria petiolata (M.Bieb.) Cavara &amp; Grande" class="img-author-img">
            <span class="img-author-overlay">© Pascal Ollagnier</span>
        </div>
        <span class="img-author-caption"><span style="font-style:italic">Alliaria petiolata</span> (M.Bieb.) Cavara &amp; Grande</span>
    </div>
</div>
```
<!----------------------------------------------------------------------- -->





<!----------------------------------------------------------------------- -->
### {{<iconify ri:sparkling-2-line>}} Beauty bias
<hr>


```{=html}
<div class="img-author-group-centered">
      <div class="img-author-container" style="width:40%; min-width:120px;">
        <div style="text-align:center; font-size:1.2em; color:#222; margin-bottom:6px; font-family: Nunito, Arial, sans-serif; font-weight:bold;">10753 obs.</div>
        <div style="position:relative; width:100%;">
            <img src="images/68ea71ff35a4ebf2c67011fcb54eba3a7671ea5e.jpeg" alt="Centaurea jacea L." class="img-author-img" style="width:100%;">
            <span class="img-author-overlay">© Dieter Wagner</span>
        </div>
        <span class="img-author-caption"><span style="font-style:italic">Centaurea jacea</span> L.</span>
    </div>
      <div class="img-author-container" style="width:40%; min-width:120px;">
        <div style="text-align:center; font-size:1.2em; color:#222; margin-bottom:6px; font-family: Nunito, Arial, sans-serif; font-weight:bold;">6 obs.</div>
        <div style="position:relative; width:100%;">
            <img src="images/4fe3e22073f23ba342555f2003fbb80221d47de3.jpeg" alt="Cenchrus agrimonioides Trin." class="img-author-img" style="width:100%;">
            <span class="img-author-overlay">© David Eickhoff − EOL</span>
        </div>
        <span class="img-author-caption"><span style="font-style:italic">Cenchrus agrimonioides</span> Trin.</span>
    </div>
</div>
```
<!----------------------------------------------------------------------- -->




<!-------------------------------------------------------------------------- -->
### {{<iconify emojione-monotone:straight-ruler>}} Size bias
<hr>


```{=html}
<div class="img-author-group-centered" style="gap:4em; align-items:stretch;">
    <div class="img-author-container" style="width:30%; min-width:120px;">
        <div style="text-align:center; font-size:1.2em; color:#222; margin-bottom:6px; font-family: Nunito, Arial, sans-serif; font-weight:bold;">8376 obs.</div>
        <div style="position:relative; width:100%;">
            <img src="images/0daa10dc3118cfb826faedc4e87a2f4b034db1d1.jpeg" alt="Magnolia grandiflora L." class="img-author-img" style="width:100%;">
            <span class="img-author-overlay">© Patrick Cartier</span>
        </div>
        <span class="img-author-caption"><span style="font-style:italic">Magnolia grandiflora</span> L.</span>
    </div>
    <div style="width:8%; min-width:60px; display:flex; align-items:center; justify-content:center; flex-direction:column;">
        <img src="../2024-09-25_slides_sierra/images/rule.png" style="width:100%; max-width:80px; height:80%; object-fit:contain; display:block; margin:auto; align-self:center;">
    </div>
    <div class="img-author-container" style="width:30%; min-width:120px;">
        <div style="text-align:center; font-size:1.2em; color:#222; margin-bottom:6px; font-family: Nunito, Arial, sans-serif; font-weight:bold;">413 obs.</div>
        <div style="position:relative; width:100%;">
            <img src="images/942686a7353fb3a7f566b7369f48ec6ca56b4338.jpeg" alt="Moehringia trinervia (L.) Clairv." class="img-author-img" style="width:100%;">
            <span class="img-author-overlay">© Maximilien Perrin</span>
        </div>
        <span class="img-author-caption"><span style="font-style:italic">Moehringia trinervia</span> (L.) Clairv.</span>
    </div>
</div>
```
<!-------------------------------------------------------------------------- -->


<!-------------------------------------------------------------------------- -->
### Many more biases ...
<hr>

<br>

- Selection bias
    - Convenience sampling: **easily** vs. *hardly* accessible
    - Preference for certain species: **visibility** / **ease of identification**
    - Subjective bias: selection based on **personal judgment**, may not be random or representative
     - Rare species: **rare** or **endangered** species may be under-represented

- Temporal bias / seasonal variation: **seasonal changes** in plant characteristics
- ...

<!-------------------------------------------------------------------------- -->

<!-------------------------------------------------------------------------- -->
## The Pl@ntNet-300K dataset {.section-background-small}
<!-------------------------------------------------------------------------- -->


<!-------------------------------------------------------------------------- -->
### {{<iconify gravity-ui:magnifier>}} A need for new benchmarks
<hr>
<br>
**Popular datasets limitations:**

<div style="margin-left: 2em;">

- structure of labels too simplistic (CIFAR-10, CIFAR-100)
- tasks too easy to discriminate (MNIST)
- too well-balanced, with same number of images per class (Imagenet)
- contains duplicate, low-quality, or irrelevant images [@recht2019imagenet]

</div>

**[Motivation]{.underline}**:
<div style="margin-left: 2em;">

Release a dataset **sharing similar features** as the Pl@ntNet dataset to foster research in plant identification

$\implies$ Pl@ntNet-300K [@Garcin_Joly_Bonnet_Affouard_Lombardo_Chouet_Servajean_Lorieul_Salmon2021]
</div>

<br>
<br>

***"The collective behavior induced by frictionless research exchange is the emergent superpower driving many events that are so striking today."*** [@donoho2024data]
<!------------------------------------------------------------------------ -->




<!-------------------------------------------------------------------------- -->
### Construction of Pl@ntNet-300K {style="text-align: center;"}


<center>
![](../2024-09-25_slides_sierra/images/sample_genus.svg){width=80%}

Sample at genus level to preserve intra-genus ambiguity: use **hierarchical structure**
</center>
<!-------------------------------------------------------------------------- -->





<!-------------------------------------------------------------------------- -->
### {{<iconify icon-park-solid:chart-histogram-two>}} Species distribution, long tail & Lorenz curve
<hr>

:::: {.columns style='display: flex !important'}

::: {.column width=82%}

::: {.r-stack}
![](../2024-09-25_slides_sierra/images/lorentz_plantnet.svg){.fragment width=85% fragment-index=2}

![](../2024-09-25_slides_sierra/images/lorentz_plantnet300K.svg){.fragment width=85% fragment-index=3}

![](../2024-09-25_slides_sierra/images/lorentz_with_Imagenet.svg){.fragment width=85% fragment-index=4}

![](../2024-09-25_slides_sierra/images/lorentz_with_CIFAR_Imagenet.svg){.fragment width=85% fragment-index=5}

:::

:::

::: {.column style='text-align: center;'}

<br>

:::{.fragment fragment-index=1}
- Earth: 400K+ species
- Pl@ntNet: 80K+ species
- Pl@ntNet-300K: 1K+ species
:::

:::{.fragment fragment-index=3}
**[Note]{.underline}**: long tail preserved by genera subsampling
:::
:::

::::

<br>

:::{.fragment fragment-index=2}

<center>
**80% of species | 11% of images** $\iff$ **20% of species | 89% of images**
</center>

:::
<!-------------------------------------------------------------------------- -->



<!-------------------------------------------------------------------------- -->
### Pl@ntNet300K: Long tail visualization
<hr>
<br>


```{=html}
<div style="text-align: center;">

<div style="width:98%; margin: 0 auto;">

<!-- Custom styles to compact the PlantNet filter menu for slides -->

<div id="plantnet-viz" style="max-width: 1200px; margin: 0 auto;">

  <div id="filter-container" style="margin-bottom: 20px;"></div>

  <!-- Main content area with side-by-side layout -->
  <div style="display: flex; flex-direction: row; align-items: flex-start; gap: 20px;">
  <!-- Plot container on the left (wider and shorter) -->
  <div id="plotly-container" style="flex: 4; height: 400px; width: 65vw; max-width: 65vw; min-width: 200px;"></div>

    <!-- Right sidebar with controls and image preview -->
    <div style="flex: 1; min-width: 280px; display: flex; flex-direction: column;">
      <!-- Controls for plot options (moved to align with plot head) -->
      <div style="display: flex; justify-content: flex-end; margin-bottom: 15px;">
        <div class="scale-toggle">
          <span class="scale-label">Y-Scale:</span>
          <button type="button" id="log-scale-btn" class="scale-btn"
            onclick="window.setScale('log'); return false;">Log</button>
          <button type="button" id="linear-scale-btn" class="scale-btn active"
            onclick="window.setScale('linear'); return false;">Linear</button>
        </div>
      </div>

      <!-- Image preview container -->
      <div id="image-preview-container" style="display: flex; flex-direction: column; justify-content: flex-start; align-items: center; flex: 1;">
        <div style="margin-bottom: 10px;">Species Preview</div>
        <img id="preview-image" src="" style="width: 35vw; height: 30vh; border: 1px solid #ccc; display: none; border-radius: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); object-fit: cover;" />
        <div id="image-label" style="font-weight: bold; font-size: 8px; min-height: 3.5em; margin-top: 10px; text-align: center; width: 100%; line-height: 1.2;"></div>
      </div>
    </div>
  </div>
</div>

<script type="module" src="../../../../blog/long-tail/plantnet_viz.js"></script>

</div>
</div>

```

<!-------------------------------------------------------------------------- -->


<!-------------------------------------------------------------------------- -->
### {{<iconify eos-icons:database>}} Details on Pl@ntNet-300K
<hr>
<br>

**{{< iconify mdi:bullseye-arrow >}} Goal:**
Provide a real life scenario for supervised learning, with multi-class and long-tail label distribution

<br>


:::: {.columns style='display: flex !important'}

::: {.column }

[**Caracteristics**]{.underline}:

<br>

- **306,146** color images
- Size : **32 GB**
- Labels: **1 000+** species
- Required **2 000 000** volunteers
:::


::: {.column width=55%}
:::{.fragment}

<br>

<center>
**Zenodo, 1 click download**

[https://zenodo.org/record/5645731](https://zenodo.org/record/5645731)

<br>

**Code to train models**

[https://github.com/plantnet/PlantNet-300K](https://github.com/plantnet/PlantNet-300K)
</center>

:::

:::

::::


. . .

<br>
<center>
<!-- ![](../2025-12-15-ICSDS25/images/plantnet_class_distribution_iucn_status_with_images.svg){width=100%} -->

<!-- More details on my blog post:  [https://josephsalmon.eu/blog/long-tail/](https://josephsalmon.eu/blog/long-tail/) -->

</center>
<!-------------------------------------------------------------------------- -->





<!-------------------------------------------------------------------------- -->
# Prediction<br>&<br>uncertainty quantification {.section-background}
<!-------------------------------------------------------------------------- -->



<!-------------------------------------------------------------------------- -->
### {{< iconify mdi:account-group >}} Joint work with
<hr>

<center>

:::: {.columns}

::: {.column width="34%"}

<div style="text-align: center;">

<img src="../2025-12-15-ICSDS25/images/Tiffany_Ding.jpg" style="width: 300px; height: 300px; object-fit: cover; border-radius: 10px;">

**Tiffany Ding**

UC Berkeley

</div>

:::

::: {.column width="22%"}

<div style="text-align: center;">

within

![](../2024-09-25_slides_sierra/images/plantnet-logo-title.26755cd.svg){width=96%}

</div>
:::

::: {.column width="34%"}

<div style="text-align: center;">

<img src="../2025-12-15-ICSDS25/images/JB_Fermanian.png" style="width: 300px; height: 300px; object-fit: cover; border-radius: 10px;">

**Jean-Baptiste Fermanian**

Inria

</div>

:::

::::

<br>
<br>


"***Conformal Prediction for Long-Tailed Classification***"

T. Ding, J.-B. Fermanian and J. Salmon

ICLR 2026

</center>

<!-------------------------------------------------------------------------- -->



<!-------------------------------------------------------------------------- -->
### Pl@ntNet: set prediction (recommendation)
<hr>

<br>

::::{.columns}
::: {.column width="58%"}
![](images/plantnet_image_ambiguity_js_detailed.svg){width=90%}
:::

::: {.column width="42%"}

Elements to help guide the users

- provide a set of possible species/labels
- display similar images from proposed species
- give a score of confidence

:::
::::
<!-------------------------------------------------------------------------- -->




<!-------------------------------------------------------------------------- -->
### {{<iconify icon-park-solid:chart-histogram-two>}}  (Split) Conformal Prediction [@vovk2005algorithmic]
<hr>

<br>
**{{< iconify mdi:bullseye-arrow >}} Goal:**

For an input image $X$, propose the most probable classes $y$ with **confidence level** $1-\alpha$ (with small $\alpha$)

<br>
<br>

. . .

**{{< iconify mdi:lightbulb-on >}} Main idea:** Return classes with predicted **score** above a threshold:

$$
\mathcal{C}_{\alpha}(X) = \big\{ y : s(X,y) \geq t_\alpha \big\}
$$


{{< iconify mdi:arrow-right-bold >}} **In classification**: a common conformal score is $s(x,y) = \hat{p}(y|x)$ (*e.g.,* softmax score from a classifier fitted on a train/validation set).

<br>
<br>

. . .

**{{< iconify mdi:swap-horizontal >}} Key assumption:** The data calibration $(X_i, Y_i)$ are **exchangeable** with the tested points.
<br>
<br>

. . .


**Conformal prediction**: sets $t_{\alpha}$ as the $(1-\alpha)$ quantile of the scores on a calibration set 


<!-------------------------------------------------------------------------- -->



<!-------------------------------------------------------------------------- -->
### {{< iconify ic:round-tune >}} Optimal sets [@sadinle2019least]
<hr>

:::: {.columns}

::: {.column width="48%"}

**Marginal coverage** targets:

$$\mathbb{P}\big[ Y \in \mathcal{C}_{\alpha}(X) \big ] \geq 1 - \alpha.$$

:::

::: {.column width="48%"}

::: {.fragment}

**Class conditional coverage** targets:

$$\forall y,\quad  \mathbb{P}\big[ Y \in \mathcal{C}_\alpha(X) | Y=y \big ] \geq 1 - \alpha.$$

:::

:::

::::

::: {.fragment}

:::: {.columns}

::: {.column width="48%"}


::: {.thenv data-text="Theorem (Informal)"}


The optimal set of minimum size and **marginal coverage** of at least $1-\alpha$ is:
$$
\mathcal{C}_{\alpha}(x) = \left\{ y : p(y|x) \geq t_\alpha \right\}
$$
:::

:::

::: {.column width="48%"}

::: {.fragment}

::: {.thenv data-text="Theorem (Informal)"}

The optimal set of minimum size and **conditional coverage** of at least $1-\alpha$ is:
$$
\mathcal{C}_{\alpha}(x) = \left\{ y : p(y|x) \geq t_\alpha^{y} \right\}
$$
:::

:::

:::

::::

:::

<br>


:::: {.columns}

::: {.column width="48%"}
::: {.fragment}

**Marginal:**

calibrate $t_{\alpha}$ on **whole calibration set** $(X_i, Y_i)_{i=1}^n$

:::
:::

::: {.column width="48%"}

::: {.fragment}

**Conditional:**

calibrate $t_{\alpha}^y$ **only on** $(X_i, Y_i)$ such that $Y_i = y$

:::
:::

::::

<!-------------------------------------------------------------------------- -->





<!-------------------------------------------------------------------------- -->

### Interactive optimal set visualization
<hr>

```{=html}
<div style="width:50%; margin: 0 auto;">

<div id="plots2" style="width:100%; max-width:800px; overflow-x:auto;"></div>
<div id="alphaControl" style="display:flex; align-items:center; justify-content:center; gap:12px;">
  <label for="alphaSlider"><span class="math inline">\(\alpha=\)</span> <span id="alphaValue">0.15</span></label>
  <input type="range" id="alphaSlider" min="0.001" max="0.20" step="0.001" value="0.15">
    </div>
</div>

<script type="module" src="../../../../blog/long-tail/subplot_viz.js"></script>
```
<!-------------------------------------------------------------------------- -->



### Class conditional: useless for long-tail
<hr>



<br>
<br>



```{=html}
<div id="all-metrics-softmax-container-2" style="width: 100%; height: 450px; margin: 20px 0;">
</div>

<script type="module" src="../../../blog/long-tail/all_metrics_softmax_viz_no_yellow.js"></script>
```


<!-------------------------------------------------------------------------- -->






<!-------------------------------------------------------------------------- -->
### Targeting Macro-Coverage
<hr>

**{{< iconify mdi:bullseye-arrow >}} Goal:** Average coverage across all classes (better for long-tail!)





::::{.columns}

::: {.column width="15%"}
:::


::: {.column width="70%"}

$$
\text{MacroCoverage} = \frac{1}{|\mathcal{Y}|} \sum_{y \in \mathcal{Y}} \mathbb{P}\big( y \in \mathcal{C}(X) \, | \, Y = y \big)
$$

::: {.fragment}

::: {.thenv data-text="Theorem (Informal)"}

The optimal set of minimum size and **Macro-Coverage** of at least $1-\alpha$ is:
$$
\mathcal{C}_{\alpha}(x) = \left\{ y : \frac{p(y|x)}{p(y)} \geq t_\alpha \right\}
$$

:::

:::

:::

::: {.column width="15%"}

:::

::::


::: {.fragment}

<br>

{{< iconify mdi:arrow-right-bold >}} Introduce a new conformal score, **Prevalence Adjusted Softmax (PAS)** : $s(x,y) = \frac{\hat{p}(y|x)}{\hat{p}(y)}$

:::

<!-------------------------------------------------------------------------- -->




<!-------------------------------------------------------------------------- -->
### Interactive optimal set visualization (II)
<hr>

```{=html}
<div style="width:50%; margin: 0 auto;">
    <div id="plots3" style="width:100%; max-width:800px; overflow-x:auto;"></div>
    <div id="alphaControl2" style="display:flex; align-items:center; justify-content:center; gap:2px;">
        <label for="alphaSlider2"><span class="math inline">\(\alpha\)</span>: <span id="alphaValue2">0.15</span></label>
        <input type="range" id="alphaSlider2" min="0.001" max="0.20" step="0.001" value="0.15">
    </div>
</div>
<script type="module" src="../../../../blog/long-tail/subplot_viz_3.js"></script>
```
<!-------------------------------------------------------------------------- -->






<!-------------------------------------------------------------------------- -->
### Experiments on Pl@ntNet-300K

<hr>
<br>

<!-- ![](../../../blog/long-tail/images/ALL_metrics_plantnet_softmax_pareto_NO_LEGEND_js.svg){width=100%}

![](../../../blog/long-tail/images/ALL_metrics_plantnet_softmax_pareto_LEGEND_ONLY_js.svg){width=100%}

<br> -->

```{=html}
<div id="all-metrics-softmax-container" style="width: 100%; height: 450px; margin: 20px 0;">
</div>

<script type="module" src="../../../blog/long-tail/all_metrics_softmax_viz.js"></script>
```

<!-------------------------------------------------------------------------- -->




<!-------------------------------------------------------------------------- -->
### Generalization : weighted Macro-Coverage
<hr>



Given user-chosen class weights $\omega(y)$ for $y \in \mathcal{Y}$ that sum to one, we can define the _$\omega$-weighted macro-coverage_ as




::::{.columns}

::: {.column width="15%"}
:::


::: {.column width="70%"}

$$
\begin{align}
    \mathrm{MacroCov}_{\omega}(\mathcal{C}) =
    \sum_{y \in \mathcal{Y}} \omega(y) \mathbb{P}(Y \in \mathcal{C}(X) \mid Y = y).
\end{align}
$$

::: {.fragment}

::: {.thenv data-text="Theorem (Informal)"}

The optimal set of minimum size and **Macro-Coverage** of at least $1-\alpha$ is:
$$
  \begin{align}
    \mathcal{C}^*(x) = \left\{ y \in \mathcal{Y} : \omega(y) \dfrac{p(y|x)}{p(y)} \geq t\right\},
  \end{align}
$$

:::

:::

:::

::: {.column width="15%"}

:::

::::


::: {.fragment}

<br>

{{< iconify mdi:arrow-right-bold >}} Introduce a new conformal score, **Weighted Prevalence Adjusted Softmax (WPAS)** : $s(x,y) = \omega(y) \frac{\hat{p}(y|x)}{\hat{p}(y)}$

:::
<!-------------------------------------------------------------------------- -->





<!-------------------------------------------------------------------------- -->
### Experiments on Pl@ntNet-300K: endangered species
<hr>

**{{< iconify mdi:bullseye-arrow >}} Goal:**  handle at-risk species in Pl@ntNet-300K,  weight by $\gamma \geq 1$ times more at-risk species:

$$
\omega(y) = \begin{cases}
    \frac{\gamma}{W} & \text{if } y \in \mathcal{Y}_{\text{at-risk}} \quad (\text{with } W = \gamma|\mathcal{Y}_{\text{at-risk}}| + |\mathcal{Y} \setminus \mathcal{Y}_{\text{at-risk}}|)\\
    \frac{1}{W} & \text{otherwise},
\end{cases}
$$

. . .


```{=html}
<div id="plantnet-comparison-container" style="width: 100%; height: 500px; margin: 20px 0;">
</div>

<script type="module" src="../../../blog/long-tail/plantnet_comparison_viz.js"></script>
```
<!-------------------------------------------------------------------------- -->



<!-------------------------------------------------------------------------- -->
# Crowd-sourced data: <br> Votes, labels & aggregation {.section-background}
<!-------------------------------------------------------------------------- -->



### {{< iconify mdi:account-group >}} Joint work with
<hr>

<center>

:::: {.columns}

::: {.column width="34%"}

<div style="text-align: center;">

<img src="images/tanguy_lefort.jpeg" style="width: 300px; height: 300px; object-fit: cover; border-radius: 10px;">

**Tanguy Lefort**

Now at Seenovate

</div>

:::

::: {.column width="22%"}

<div style="text-align: center;">

within

![](../2024-09-25_slides_sierra/images/plantnet-logo-title.26755cd.svg){width=96%}

</div>
:::

::: {.column width="34%"}

<div style="text-align: center;">

<img src="images/Benjamin_charlier.jpg" style="width: 300px; height: 300px; object-fit: cover; border-radius: 10px;">

**Benjamin Charlier**

Inrae

</div>

:::

::::

<br>
<br>


***"Cooperative learning of Pl@ntNet's Artificial Intelligence algorithm: <br> how does it work and how can we improve it?" ***


T. Lefort et al.

Methods in Ecology and Evolution, 2025

</center>




<!-------------------------------------------------------------------------- -->
### {{<iconify fluent:vote-24-filled>}} Pl@ntNet online "votes"
<hr>
<center>
![](../2024-09-25_slides_sierra/images/plantnet_online.png){width=50%}

Link: [https://identify.plantnet.org/weurope/observations/1012500059](https://identify.plantnet.org/weurope/observations/1012500059)
</center>
<!-------------------------------------------------------------------------- -->


<!-------------------------------------------------------------------------- -->
### {{<iconify pajamas:labels>}} What about labels?
<hr>

<br>

- Images from users... so are the labels!

- But **users** can be wrong or **not experts**

- **Several labels** can be available per image!
<!-------------------------------------------------------------------------- -->




<!-------------------------------------------------------------------------- -->
### {{<iconify jam:write-f>}} Users can make corrections
<hr>

<center>
![](../2024-09-25_slides_sierra/images/plantnet_corrected.png){width=50%}
</center>

<!-------------------------------------------------------------------------- -->



<!-------------------------------------------------------------------------- -->
### ... sometimes can't be trusted
<hr>


<center>
::: {.r-stack}

![](../2024-09-25_slides_sierra/images/vanessa_corrected.png){width=67%}

![](../2024-09-25_slides_sierra/images/right_vanessa_corrected.png){.fragment width=67% fragment-index=1}

:::


Link: [https://identify.plantnet.org/weurope/observations/1012500059](https://identify.plantnet.org/weurope/observations/1012500059)

</center>
<!-------------------------------------------------------------------------- -->




<!-------------------------------------------------------------------------- -->
### Pl@ntNet label aggregation (EM algorithm) {.center style="text-align: center;"}
<hr>


**Weighting scheme**: weight user vote by its number of identified species


::: {.r-stack}

![](images/schema_plantnet_aggregation_js_0.svg){.fragment width=81% fragment-index=1}

![](images/schema_plantnet_aggregation_js_1.svg){.fragment width=81% fragment-index=2}

![](images/schema_plantnet_aggregation_js.svg){.fragment width=81% fragment-index=3}
:::


::: {.fragment}


:::
<!-------------------------------------------------------------------------- -->





<!-------------------------------------------------------------------------- -->
### Take home message
<hr>


:::: {.columns}

::: {.column width="65%"}
- Challenges in citizen science: many and varied (need more attention)
- Crowdsourcing / Label uncertainty: helpful for **data curation**
- Improved **data quality** $\implies$ **improved learning** performance
- Prediction: theory can guide the set to display
:::


::: {.column width="33%"}

![](images/contact_js_short.svg)
<!-- ![](https://raw.githubusercontent.com/josephsalmon/OrganizationFiles/master/inkscape/images/contact_js.svg) -->

:::
::::


:::: {.columns}

::: {.column width="30%"}
**Dataset release**:
:::

::: {.column width="69%"}

- Pl@ntNet-300K: [https://zenodo.org/record/5645731](https://zenodo.org/record/5645731)
- Pl@ntNet SWE flora: [https://zenodo.org/records/10782465](https://zenodo.org/records/10782465)
:::
::::



:::: {.columns}

::: {.column width="30%"}
**Code release**:
:::

::: {.column width="69%"}

- Toolbox: [https://peerannot.github.io/](https://peerannot.github.io/)
- Some benchmarks: [https://benchopt.github.io/](https://benchopt.github.io/)
:::
::::

:::: {.columns}

::: {.column width="30%"}
**Future work**
:::

::: {.column width="69%"}

- Handling label hierarchy
- Human–computer interaction / performative learning / model collapse
- Improve robustness to adversarial users
- Leverage gamification for more quality labels [theplantgame.com](https://theplantgame.com)
:::
::::
<!-------------------------------------------------------------------------- -->




















# References {.section-background}


<!----------------------------------------------------------------------- -->
### References
<hr>

::: {#refs}
:::
<script>
document.addEventListener('DOMContentLoaded', function() {
    const refs = document.getElementById('refs');
    if (refs) {
        refs.innerHTML = refs.innerHTML.replace(/Salmon, J\./g, '<strong>Salmon, J.</strong>');
    }
});
</script>
<!-------------------------------------------------------------------------- -->


