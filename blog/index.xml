<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Joseph Salmon</title>
<link>https://josephsalmon.eu/blog/</link>
<atom:link href="https://josephsalmon.eu/blog/index.xml" rel="self" type="application/rss+xml"/>
<description>Machine Learning, Data Science Optimization &amp; Image Processing | Research</description>
<image>
<url>https://josephsalmon.eu/img/joseph_2018.png</url>
<title>Joseph Salmon</title>
<link>https://josephsalmon.eu/blog/</link>
<height>154</height>
<width>144</width>
</image>
<generator>quarto-1.6.40</generator>
<lastBuildDate>Mon, 08 Sep 2025 22:00:00 GMT</lastBuildDate>
<item>
  <title>Gaussian elimination in a glimpse</title>
  <dc:creator>Joseph Salmon</dc:creator>
  <link>https://josephsalmon.eu/blog/gaussian_elimination/</link>
  <description><![CDATA[ 
<div class="no-row-height column-margin column-container">
  <div class="">
    <img src="https://josephsalmon.eu/blog/gaussian_elimination/gaussian_elimination.gif" style="width:100%">
  </div>
</div>





<section id="gaussian-elimination" class="level1">
<h1>Gaussian elimination</h1>
<p>Here is a simple visualisation of the Gaussian elimination steps: <img src="https://raw.github.com/josephsalmon/Tweets/master/Pivot_Gauss_video/gauss_pivot.gif" title="Evolution of a random square matrix along the steps of a Gaussian elimination" style="width:100%"></p>
<p>and a more complete one: <img src="https://raw.github.com/josephsalmon/Tweets/master/Pivot_Gauss_video/gauss_pivot_4figs.gif" title="Evolution of a random square matrix along the steps of a Gaussian elimination: on the top left you have the transvection matrix used at each step, on the top right the original matrix, on the bottom left the matrix display the approximation of the inverse matrix, on the bottom right the remaining extra-diagonal terms of the matrix that need to be canceled to find the inverse." style="width:100%"></p>
<p>For more details, the Python source code is available here: <a href="https://github.com/josephsalmon/Tweets/tree/master/Pivot_Gauss_video" target="_blank">https://github.com/josephsalmon/Tweets/tree/master/Pivot_Gauss_video</a></p>


<!-- -->

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{salmon2025,
  author = {Salmon, Joseph},
  title = {Gaussian Elimination in a Glimpse},
  date = {2025-09-09},
  url = {https://josephsalmon.eu/blog/gaussian_elimination/},
  langid = {en}
}
</code></pre></div></section></div> ]]></description>
  <category>linear algebra</category>
  <category>math visualization</category>
  <guid>https://josephsalmon.eu/blog/gaussian_elimination/</guid>
  <pubDate>Mon, 08 Sep 2025 22:00:00 GMT</pubDate>
  <media:content url="https://josephsalmon.eu/blog/gaussian_elimination/gaussian_elimination.gif" medium="image" type="image/gif"/>
</item>
<item>
  <title>Isotonic regression</title>
  <dc:creator>Joseph Salmon</dc:creator>
  <link>https://josephsalmon.eu/blog/isotonic/</link>
  <description><![CDATA[ 
<div class="no-row-height column-margin column-container">
  <div class="">
    <img src="https://josephsalmon.eu/blog/isotonic/isotonic.png" style="width:100%">
  </div>
</div>





<div class="hidden">
{{
<p>% thin space, limits underneath in displays % thin space, limits underneath in displays }}</p>
</div>
<p><strong><u>Note</u></strong>: This blog is mainly inspired by the post by <span class="citation" data-cites="Pedregosa13">Pedregosa (2013)</span> on Isotonic regression, a version of the PAVA algorithm provided by <span class="citation" data-cites="Best_Chakravarti90">Best and Chakravarti (1990)</span>.</p>
<section id="introduction-formulation" class="level1">
<h1>Introduction &amp; formulation</h1>
<p>Isotonic regression is a technique used to fit a non-decreasing function to a set of data points. We can think of isotonic regression as a generalization of linear regression where the function is constrained to be non-decreasing.</p>
<p>More formally suppose that one collects <img src="https://latex.codecogs.com/png.latex?n"> sample points <img src="https://latex.codecogs.com/png.latex?y_1,%5Cdots,%20y_n"> and has weights <img src="https://latex.codecogs.com/png.latex?w_1,%20%5Cdots,%20w_n"> associated with each data point.</p>
<p><strong><u>Note</u></strong>: when no a priori weights are given, we can set <img src="https://latex.codecogs.com/png.latex?w_i%20=%201"> for all <img src="https://latex.codecogs.com/png.latex?i%20%5Cin%20%5Cllbracket%201,%20n%20%5Crrbracket">.</p>
<p>Then, the isotonic regression problem can be formulated as follows: <span id="eq-isotonic"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cmin_%7Bx%20%5Cin%20%5Cmathbb%7BR%7D%5En%7D%0A%5Cfrac%7B1%7D%7B2%7D%0A&amp;%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20w_i%20(x_i%20-%20y_i)%5E2%20%5C%5C%0A%5Ctext%7Bs.t.%7D%20&amp;%20%5Cquad%20x_1%20%5Cleq%20x_2%20%5Cleq%20%5Cldots%20%5Cleq%20x_n%20%5Cnonumber%0A%5Cend%7Balign%7D%0A%5Ctag%7B1%7D"></span></p>
<section id="visualization" class="level2">
<h2 class="anchored" data-anchor-id="visualization">Visualization</h2>
<p>Below you’ll find a visualization, on a synthetic dataset, of the most common algorithm, the Pools Adjacent Violators Algorithm (PAVA) to solve isotonic regression algorithm. The top plot shows the evolution of the PAVA algorithm, while the bottom plot shows the primal and dual objectives until convergence. Note that the essence of the algorithm is simple: it Pools Adjacent Violators, <em>i.e.,</em> it replaces adjacent points that are not in increasing order by averaging.</p>
<div id="338640cf" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div>                            <div id="18aaee70-0e7b-4480-b878-1689ff5312a2" class="plotly-graph-div" style="height:600px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("18aaee70-0e7b-4480-b878-1689ff5312a2")) {                    Plotly.newPlot(                        "18aaee70-0e7b-4480-b878-1689ff5312a2",                        [{"legendgroup":"1","marker":{"color":"black","opacity":1,"size":10},"mode":"markers","name":"Raw data","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter","xaxis":"x","yaxis":"y"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","name":"PAVA iterations","showlegend":true,"x":[0],"y":[-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","name":"Duals","showlegend":true,"x":[0],"y":[0],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","name":"Primals","showlegend":true,"x":[0],"y":[19218.89901471994],"type":"scatter","xaxis":"x2","yaxis":"y2"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(36,36,36)"},"error_y":{"color":"rgb(36,36,36)"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"baxis":{"endlinecolor":"rgb(36,36,36)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(36,36,36)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"histogram2d"}],"histogram":[{"marker":{"line":{"color":"white","width":0.6}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":1,"tickcolor":"rgb(36,36,36)","ticks":"outside"}},"colorscale":{"diverging":[[0.0,"rgb(103,0,31)"],[0.1,"rgb(178,24,43)"],[0.2,"rgb(214,96,77)"],[0.3,"rgb(244,165,130)"],[0.4,"rgb(253,219,199)"],[0.5,"rgb(247,247,247)"],[0.6,"rgb(209,229,240)"],[0.7,"rgb(146,197,222)"],[0.8,"rgb(67,147,195)"],[0.9,"rgb(33,102,172)"],[1.0,"rgb(5,48,97)"]],"sequential":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"sequentialminus":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]]},"colorway":["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],"font":{"color":"rgb(36,36,36)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","radialaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"zaxis":{"backgroundcolor":"white","gridcolor":"rgb(232,232,232)","gridwidth":2,"linecolor":"rgb(36,36,36)","showbackground":true,"showgrid":false,"showline":true,"ticks":"outside","zeroline":false,"zerolinecolor":"rgb(36,36,36)"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"baxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"},"bgcolor":"white","caxis":{"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside"}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"},"yaxis":{"automargin":true,"gridcolor":"rgb(232,232,232)","linecolor":"rgb(36,36,36)","showgrid":false,"showline":true,"ticks":"outside","title":{"standoff":15},"zeroline":false,"zerolinecolor":"rgb(36,36,36)"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"X"},"range":[-0.5,25.5]},"yaxis":{"anchor":"x","domain":[0.625,1.0],"title":{"text":"Y"},"range":[0,250]},"xaxis2":{"anchor":"y2","domain":[0.0,1.0],"range":[0,25]},"yaxis2":{"anchor":"x2","domain":[0.0,0.375],"range":[0,25000]},"annotations":[{"font":{"size":16},"showarrow":false,"text":"PAVA output evolution","x":0.5,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Primal and dual objectives","x":0.5,"xanchor":"center","xref":"paper","y":0.375,"yanchor":"bottom","yref":"paper"}],"legend":{"tracegroupgap":180},"height":600,"sliders":[{"active":1,"currentvalue":{"prefix":"Iteration: #"},"steps":[{"args":[["0"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"0","method":"animate"},{"args":[["1"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"1","method":"animate"},{"args":[["2"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"2","method":"animate"},{"args":[["3"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"3","method":"animate"},{"args":[["4"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"4","method":"animate"},{"args":[["5"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"5","method":"animate"},{"args":[["6"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"6","method":"animate"},{"args":[["7"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"7","method":"animate"},{"args":[["8"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"8","method":"animate"},{"args":[["9"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"9","method":"animate"},{"args":[["10"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"10","method":"animate"},{"args":[["11"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"11","method":"animate"},{"args":[["12"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"12","method":"animate"},{"args":[["13"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"13","method":"animate"},{"args":[["14"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"14","method":"animate"},{"args":[["15"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"15","method":"animate"},{"args":[["16"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"16","method":"animate"},{"args":[["17"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"17","method":"animate"},{"args":[["18"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"18","method":"animate"},{"args":[["19"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"19","method":"animate"},{"args":[["20"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"20","method":"animate"},{"args":[["21"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"21","method":"animate"},{"args":[["22"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"22","method":"animate"},{"args":[["23"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"23","method":"animate"},{"args":[["24"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"24","method":"animate"},{"args":[["25"],{"mode":"immediate","frame":{"duration":300,"redraw":true},"transition":{"duration":0}}],"label":"25","method":"animate"}]}],"updatemenus":[{"buttons":[{"args":[null,{"frame":{"duration":500,"redraw":false},"fromcurrent":true,"transition":{"duration":50,"easing":"linear"}}],"label":"Play","method":"animate"},{"args":[[null],{"frame":{"duration":0,"redraw":false},"mode":"immediate","transition":{"duration":0}}],"label":"Pause","method":"animate"}],"direction":"left","pad":{"b":20,"r":5,"t":5},"showactive":false,"type":"buttons","x":0.5,"xanchor":"center","y":-0.28,"yanchor":"top"}]},                        {"responsive": true}                    ).then(function(){
                            Plotly.addFrames('18aaee70-0e7b-4480-b878-1689ff5312a2', [{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0],"y":[-3.0],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0],"y":[0.0],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0],"y":[19218.899014719937],"type":"scatter"}],"name":"0"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1],"y":[-3.0,35.657359027997266],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1],"y":[0.0,0.0],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1],"y":[19218.899014719937,19218.899014719937],"type":"scatter"}],"name":"1"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2],"y":[-3.0,35.657359027997266,79.93061443340548],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2],"y":[0.0,0.0,0.0],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2],"y":[19218.899014719937,19218.899014719937,19218.899014719937],"type":"scatter"}],"name":"2"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3],"y":[0.0,0.0,0.0,0.0],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937],"type":"scatter"}],"name":"3"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4],"y":[-3.0,35.657359027997266,75.90574270370168,75.90574270370168,75.90574270370168],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4],"y":[0.0,0.0,0.0,0.0,1646.040179115953],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995],"type":"scatter"}],"name":"4"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002],"type":"scatter"}],"name":"5"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696,129.29550745276566],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084,1832.821238098084],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002,12439.088303163002],"type":"scatter"}],"name":"6"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696,129.29550745276566,147.9720770839918],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084,1832.821238098084,1832.821238098084],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002,12439.088303163002,12439.088303163002],"type":"scatter"}],"name":"7"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696,120.37627113452281,120.37627113452281,120.37627113452281],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084,1832.821238098084,1832.821238098084,2920.0360352551797],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002,12439.088303163002,12439.088303163002,11841.668995911108],"type":"scatter"}],"name":"8"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696,114.31451701331767,114.31451701331767,114.31451701331767,114.31451701331767],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084,1832.821238098084,1832.821238098084,2920.0360352551797,3140.5052134108846],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002,12439.088303163002,12439.088303163002,11841.668995911108,10811.879845480918],"type":"scatter"}],"name":"9"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696,114.31451701331767,114.31451701331767,114.31451701331767,114.31451701331767,155.89476363991855],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084,1832.821238098084,1832.821238098084,2920.0360352551797,3140.5052134108846,3140.5052134108846],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002,12439.088303163002,12439.088303163002,11841.668995911108,10811.879845480918,10811.879845480918],"type":"scatter"}],"name":"10"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696,114.31451701331767,114.31451701331767,114.31451701331767,114.31451701331767,136.0700480646593,136.0700480646593],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084,1832.821238098084,1832.821238098084,2920.0360352551797,3140.5052134108846,3140.5052134108846,3533.5245610508136],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002,12439.088303163002,12439.088303163002,11841.668995911108,10811.879845480918,10811.879845480918,10721.13678514058],"type":"scatter"}],"name":"11"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696,114.31451701331767,114.31451701331767,114.31451701331767,114.31451701331767,125.79585466746512,125.79585466746512,125.79585466746512],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084,1832.821238098084,1832.821238098084,2920.0360352551797,3140.5052134108846,3140.5052134108846,3533.5245610508136,3850.20171093964],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002,12439.088303163002,12439.088303163002,11841.668995911108,10811.879845480918,10811.879845480918,10721.13678514058,9947.091120346347],"type":"scatter"}],"name":"12"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696,114.31451701331767,114.31451701331767,114.31451701331767,114.31451701331767,125.79585466746512,125.79585466746512,125.79585466746512,163.9528664807629],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084,1832.821238098084,1832.821238098084,2920.0360352551797,3140.5052134108846,3140.5052134108846,3533.5245610508136,3850.20171093964,3850.20171093964],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002,12439.088303163002,12439.088303163002,11841.668995911108,10811.879845480918,10811.879845480918,10721.13678514058,9947.091120346347,9947.091120346347],"type":"scatter"}],"name":"13"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696,114.31451701331767,114.31451701331767,114.31451701331767,114.31451701331767,125.79585466746512,125.79585466746512,125.79585466746512,137.1776882679367,137.1776882679367],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084,1832.821238098084,1832.821238098084,2920.0360352551797,3140.5052134108846,3140.5052134108846,3533.5245610508136,3850.20171093964,3850.20171093964,4567.111879268254],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002,12439.088303163002,12439.088303163002,11841.668995911108,10811.879845480918,10811.879845480918,10721.13678514058,9947.091120346347,9947.091120346347,9754.99983674713],"type":"scatter"}],"name":"14"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696,114.31451701331767,114.31451701331767,114.31451701331767,114.31451701331767,125.79585466746512,125.79585466746512,125.79585466746512,134.3282708826208,134.3282708826208,134.3282708826208],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084,1832.821238098084,1832.821238098084,2920.0360352551797,3140.5052134108846,3140.5052134108846,3533.5245610508136,3850.20171093964,3850.20171093964,4567.111879268254,4591.469417575514],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002,12439.088303163002,12439.088303163002,11841.668995911108,10811.879845480918,10811.879845480918,10721.13678514058,9947.091120346347,9947.091120346347,9754.99983674713,9386.194758063913],"type":"scatter"}],"name":"15"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696,114.31451701331767,114.31451701331767,114.31451701331767,114.31451701331767,125.79585466746512,125.79585466746512,125.79585466746512,134.3282708826208,134.3282708826208,134.3282708826208,155.6606672028108],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084,1832.821238098084,1832.821238098084,2920.0360352551797,3140.5052134108846,3140.5052134108846,3533.5245610508136,3850.20171093964,3850.20171093964,4567.111879268254,4591.469417575514,4591.469417575514],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002,12439.088303163002,12439.088303163002,11841.668995911108,10811.879845480918,10811.879845480918,10721.13678514058,9947.091120346347,9947.091120346347,9754.99983674713,9386.194758063913,9386.194758063913],"type":"scatter"}],"name":"16"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696,114.31451701331767,114.31451701331767,114.31451701331767,114.31451701331767,125.79585466746512,125.79585466746512,125.79585466746512,134.3282708826208,134.3282708826208,134.3282708826208,152.08962754880952,152.08962754880952],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084,1832.821238098084,1832.821238098084,2920.0360352551797,3140.5052134108846,3140.5052134108846,3533.5245610508136,3850.20171093964,3850.20171093964,4567.111879268254,4591.469417575514,4591.469417575514,4604.221741785936],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002,12439.088303163002,12439.088303163002,11841.668995911108,10811.879845480918,10811.879845480918,10721.13678514058,9947.091120346347,9947.091120346347,9754.99983674713,9386.194758063913,9386.194758063913,9343.53676762003],"type":"scatter"}],"name":"17"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696,114.31451701331767,114.31451701331767,114.31451701331767,114.31451701331767,125.79585466746512,125.79585466746512,125.79585466746512,134.3282708826208,134.3282708826208,134.3282708826208,136.467068018647,136.467068018647,136.467068018647],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084,1832.821238098084,1832.821238098084,2920.0360352551797,3140.5052134108846,3140.5052134108846,3533.5245610508136,3850.20171093964,3850.20171093964,4567.111879268254,4591.469417575514,4591.469417575514,4604.221741785936,5336.414840606332],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002,12439.088303163002,12439.088303163002,11841.668995911108,10811.879845480918,10811.879845480918,10721.13678514058,9947.091120346347,9947.091120346347,9754.99983674713,9386.194758063913,9386.194758063913,9343.53676762003,8339.863786042017],"type":"scatter"}],"name":"18"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696,114.31451701331767,114.31451701331767,114.31451701331767,114.31451701331767,125.79585466746512,125.79585466746512,125.79585466746512,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084,1832.821238098084,1832.821238098084,2920.0360352551797,3140.5052134108846,3140.5052134108846,3533.5245610508136,3850.20171093964,3850.20171093964,4567.111879268254,4591.469417575514,4591.469417575514,4604.221741785936,5336.414840606332,5824.004139142984],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002,12439.088303163002,12439.088303163002,11841.668995911108,10811.879845480918,10811.879845480918,10721.13678514058,9947.091120346347,9947.091120346347,9754.99983674713,9386.194758063913,9386.194758063913,9343.53676762003,8339.863786042017,6105.701541579706],"type":"scatter"}],"name":"19"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696,114.31451701331767,114.31451701331767,114.31451701331767,114.31451701331767,125.79585466746512,125.79585466746512,125.79585466746512,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,188.22612188617114],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084,1832.821238098084,1832.821238098084,2920.0360352551797,3140.5052134108846,3140.5052134108846,3533.5245610508136,3850.20171093964,3850.20171093964,4567.111879268254,4591.469417575514,4591.469417575514,4604.221741785936,5336.414840606332,5824.004139142984,5824.004139142984],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002,12439.088303163002,12439.088303163002,11841.668995911108,10811.879845480918,10811.879845480918,10721.13678514058,9947.091120346347,9947.091120346347,9754.99983674713,9386.194758063913,9386.194758063913,9343.53676762003,8339.863786042017,6105.701541579706,6105.701541579706],"type":"scatter"}],"name":"20"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696,114.31451701331767,114.31451701331767,114.31451701331767,114.31451701331767,125.79585466746512,125.79585466746512,125.79585466746512,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,183.88912227704347,183.88912227704347],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084,1832.821238098084,1832.821238098084,2920.0360352551797,3140.5052134108846,3140.5052134108846,3533.5245610508136,3850.20171093964,3850.20171093964,4567.111879268254,4591.469417575514,4591.469417575514,4604.221741785936,5336.414840606332,5824.004139142984,5824.004139142984,5842.813704752596],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002,12439.088303163002,12439.088303163002,11841.668995911108,10811.879845480918,10811.879845480918,10721.13678514058,9947.091120346347,9947.091120346347,9754.99983674713,9386.194758063913,9386.194758063913,9343.53676762003,8339.863786042017,6105.701541579706,6105.701541579706,6068.430622939655],"type":"scatter"}],"name":"21"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696,114.31451701331767,114.31451701331767,114.31451701331767,114.31451701331767,125.79585466746512,125.79585466746512,125.79585466746512,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,183.88912227704347,183.88912227704347,189.7747107964575],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084,1832.821238098084,1832.821238098084,2920.0360352551797,3140.5052134108846,3140.5052134108846,3533.5245610508136,3850.20171093964,3850.20171093964,4567.111879268254,4591.469417575514,4591.469417575514,4604.221741785936,5336.414840606332,5824.004139142984,5824.004139142984,5842.813704752596,5842.813704752596],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002,12439.088303163002,12439.088303163002,11841.668995911108,10811.879845480918,10811.879845480918,10721.13678514058,9947.091120346347,9947.091120346347,9754.99983674713,9386.194758063913,9386.194758063913,9343.53676762003,8339.863786042017,6105.701541579706,6105.701541579706,6068.430622939655,6068.430622939655],"type":"scatter"}],"name":"22"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696,114.31451701331767,114.31451701331767,114.31451701331767,114.31451701331767,125.79585466746512,125.79585466746512,125.79585466746512,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,179.86391171698543,179.86391171698543,179.86391171698543,179.86391171698543],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084,1832.821238098084,1832.821238098084,2920.0360352551797,3140.5052134108846,3140.5052134108846,3533.5245610508136,3850.20171093964,3850.20171093964,4567.111879268254,4591.469417575514,4591.469417575514,4604.221741785936,5336.414840606332,5824.004139142984,5824.004139142984,5842.813704752596,5842.813704752596,6069.430709531298],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002,12439.088303163002,12439.088303163002,11841.668995911108,10811.879845480918,10811.879845480918,10721.13678514058,9947.091120346347,9947.091120346347,9754.99983674713,9386.194758063913,9386.194758063913,9343.53676762003,8339.863786042017,6105.701541579706,6105.701541579706,6068.430622939655,6068.430622939655,6069.430709531276],"type":"scatter"}],"name":"23"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696,114.31451701331767,114.31451701331767,114.31451701331767,114.31451701331767,125.79585466746512,125.79585466746512,125.79585466746512,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,179.86391171698543,179.86391171698543,179.86391171698543,179.86391171698543,191.94379124341003],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084,1832.821238098084,1832.821238098084,2920.0360352551797,3140.5052134108846,3140.5052134108846,3533.5245610508136,3850.20171093964,3850.20171093964,4567.111879268254,4591.469417575514,4591.469417575514,4604.221741785936,5336.414840606332,5824.004139142984,5824.004139142984,5842.813704752596,5842.813704752596,6069.430709531298,6069.430709531298],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002,12439.088303163002,12439.088303163002,11841.668995911108,10811.879845480918,10811.879845480918,10721.13678514058,9947.091120346347,9947.091120346347,9754.99983674713,9386.194758063913,9386.194758063913,9343.53676762003,8339.863786042017,6105.701541579706,6105.701541579706,6068.430622939655,6068.430622939655,6069.430709531276,6069.430709531276],"type":"scatter"}],"name":"24"},{"data":[{"legendgroup":"1","marker":{"color":"black","opacity":1},"mode":"markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,79.93061443340548,114.31471805599453,33.471895621705016,53.587973461402754,129.29550745276566,147.9720770839918,83.86122886681098,96.12925464970229,155.89476363991855,116.24533248940001,105.24746787307683,163.9528664807629,110.4025100551105,128.62943611198907,155.6606672028108,148.51858789480823,105.221948958322,101.78661367769953,188.22612188617114,179.5521226679158,189.7747107964575,161.9026915173973,191.94379124341003],"type":"scatter"},{"legendgroup":"1","marker":{"color":"red"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[-3.0,35.657359027997266,70.32630039312696,70.32630039312696,70.32630039312696,70.32630039312696,114.31451701331767,114.31451701331767,114.31451701331767,114.31451701331767,125.79585466746512,125.79585466746512,125.79585466746512,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,130.59609005450042,179.86391171698546,179.86391171698546,179.86391171698546,179.86391171698546,191.94379124341003],"type":"scatter"},{"legendgroup":"2","marker":{"color":"green"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[0.0,0.0,0.0,0.0,1646.040179115953,1832.821238098084,1832.821238098084,1832.821238098084,2920.0360352551797,3140.5052134108846,3140.5052134108846,3533.5245610508136,3850.20171093964,3850.20171093964,4567.111879268254,4591.469417575514,4591.469417575514,4604.221741785936,5336.414840606332,5824.004139142984,5824.004139142984,5842.813704752596,5842.813704752596,6069.430709531298,6069.430709531298],"type":"scatter"},{"legendgroup":"2","marker":{"color":"blue"},"mode":"lines+markers","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[19218.899014719937,19218.899014719937,19218.899014719937,19218.899014719937,15889.415926489995,12439.088303163002,12439.088303163002,12439.088303163002,11841.668995911108,10811.879845480918,10811.879845480918,10721.13678514058,9947.091120346347,9947.091120346347,9754.99983674713,9386.194758063913,9386.194758063913,9343.53676762003,8339.863786042017,6105.701541579706,6105.701541579706,6068.430622939655,6068.430622939655,6069.430709531276,6069.430709531276],"type":"scatter"}],"name":"24"}]);
                        }).then(function(){
                            
var gd = document.getElementById('18aaee70-0e7b-4480-b878-1689ff5312a2');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="applications" class="level2">
<h2 class="anchored" data-anchor-id="applications">Applications</h2>
<p>Isotonic regression is used in a variety of applications, including:</p>
<ul>
<li><p><strong>Monotonicity constraints</strong>: In many applications, it is important to ensure that the relationship between two variables is monotonic. This is the case in physics or biology for instance.</p></li>
<li><p><strong>Calibration</strong> for machine learning models: Isotonic regression can be used to calibrate the output of a machine learning model to ensure that it is well-calibrated. It is common for binary classifiers to output probabilities that are not well-calibrated, and isotonic regression can be used to correct this. You will find a some details and examples in the <a href="https://scikit-learn.org/1.5/modules/calibration.html" target="_blank">scikit-learn documentation</a>.</p></li>
<li><p><strong>Sparse regression</strong>: isotonic regression has some links with the Slope penalty <span class="citation" data-cites="Bogdan_vandenBerg_Sabatti_Su_Candes15">Bogdan et al. (2015)</span>, a generalization of the Lasso penalty. The Slope estimator has been introduced to improve False Discovery Rate control in high-dimensional settings. It is a weighted ordered <img src="https://latex.codecogs.com/png.latex?%5Cell_1"> penalty, whose proximity operator can be computing thanks to the PAVA algorithm <span class="citation" data-cites="Zeng_Figueiredo14">Zeng and Figueiredo (2014)</span> (using Moreau’s identity). I became aware of this while working on <span class="citation" data-cites="Bellec_Salmon_Vaiter17">Bellec, Salmon, and Vaiter (2017)</span> : we were using that property to compute efficiently the GSlope estimator (and to control duality gap in this context).</p></li>
</ul>
</section>
</section>
<section id="optimization-duality-etc." class="level1">
<h1>Optimization, duality, etc.</h1>
<p>The formulation of the isotonic regression problem given in Equation&nbsp;1 is a quadratic program (QP) with linear constraints. Using a matrix notation, introducing the matrix <img src="https://latex.codecogs.com/png.latex?A%20=%20%5Cbegin%7Bpmatrix%7D%201%20&amp;%20-1%20&amp;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;%20%20%20%20%5C%5C%0A%20%20&amp;%201%20%20&amp;%20-1%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;%20%20%20%20%5C%5C%0A%20%20&amp;%20%20%20%20&amp;%20%5Cddots%20&amp;%20%5Cddots%20&amp;%20%20%20%20%5C%5C%0A%20%20&amp;%20%20%20%20&amp;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;%201%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;%20-1%5Cend%7Bpmatrix%7D%0A=%0A%5Cbegin%7Bpmatrix%7D%0Aa_1%5E%5Ctop%20%5C%5C%0A%5Cvdots%20%20%20%5C%5C%0Aa_%7Bn-1%7D%5E%5Ctop%0A%5Cend%7Bpmatrix%7D%0A%5Cin%20%5Cmathbb%7BR%7D%5E%7Bn-1%20%5Ctimes%20n%7D%5Censpace,%0A"> the isotonic regression problem can be formulated as follows: <span id="eq-isotonic-matrix"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cmin_%7Bx%20%5Cin%20%5Cmathbb%7BR%7D%5En%7D%0A%5Cfrac%7B1%7D%7B2%7D%0A&amp;%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20w_i%20(x_i%20-%20y_i)%5E2%20%5C%5C%0A%5Ctext%7Bs.t.%7D%20&amp;%20%5Cquad%20Ax%20%5Cleq%200%20%5Cnonumber%0A%5Cend%7Balign%7D%0A%5Ctag%7B2%7D"></span></p>
<p>In what follows we will write <img src="https://latex.codecogs.com/png.latex?W=%5Cmathop%7B%5Cmathrm%7Bdiag%7D%7D(w_1,%5Cdots,w_n)">, assuming that <img src="https://latex.codecogs.com/png.latex?w_i%20%3E%200"> for all <img src="https://latex.codecogs.com/png.latex?i%20%5Cin%20%5Cllbracket%201,%20n%20%5Crrbracket">, so <img src="https://latex.codecogs.com/png.latex?W%5E%7B-1%7D=%20%5Cmathop%7B%5Cmathrm%7Bdiag%7D%7D(1/w_1,%5Cdots,1/w_n)">. Hence, we can rewrite the isotonic regression problem as</p>
<p><span id="eq-isotonic-matrix-2"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cmin_%7Bx%20%5Cin%20%5Cmathbb%7BR%7D%5En%7D%0A%5Cfrac%7B1%7D%7B2%7D%0A&amp;%20(x-y)%5E%5Ctop%20W%20(x-y)%20%5C%5C%0A%5Ctext%7Bs.t.%7D%20&amp;%20%5Cquad%20Ax%20%5Cleq%200%20%5Censpace.%0A%5Cend%7Balign%7D%0A%5Ctag%7B3%7D"></span></p>
<p>Hence, the isotonic regression problem can be formulated as a convex quadratic program with linear constraints.</p>
<section id="notation" class="level3">
<h3 class="anchored" data-anchor-id="notation">Notation</h3>
<p>The set of <strong>isotonic vectors</strong> <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BK%7D%20=%20%5Cleft%5C%7B%20x%20%5Cin%20%5Cmathbb%7BR%7D%5En%20:%20Ax%20%5Cleq%200%20%5Cright%5C%7D"> is a cone (stable by positive scalar multiplication). We remind also that the <strong>polar cone</strong> of <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BK%7D"> is <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BK%7D%5E%5Ccirc=%20%5Cleft%5C%7Bv%20%5Cin%20%5Cmathbb%7BR%7D%5En%20:%20%5Clangle%20v,%20x%20%5Crangle%20%5Cleq%200%20%5Ctext%7B%20for%20all%20%7D%20x%20%5Cin%20%5Cmathcal%7BK%7D%5Cright%5C%7D">.</p>
<p>For any set <img src="https://latex.codecogs.com/png.latex?S%20%5Csubset%20%5Cllbracket%201,%20n%5Crrbracket">, the weighted average of <img src="https://latex.codecogs.com/png.latex?y_i"> over the indices in <img src="https://latex.codecogs.com/png.latex?i%20%5Cin%20S"> reads: <img src="https://latex.codecogs.com/png.latex?%0A%5Cbar%7By%7D_S%20%5Ctriangleq%20%5Cfrac%7B%5Csum_%7Bi%20%5Cin%20S%7D%20w_i%20y_i%7D%7B%5Csum_%7Bi'%20%5Cin%20S%7D%20w_%7B'i'%7D%7D%20%5Censpace.%0A"></p>
<div id="lem-polar" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 1 (Polar cone of the isotonic cone)</strong></span> The polar cone of <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BK%7D"> is <img src="https://latex.codecogs.com/png.latex?%0A%5Cmathcal%7BK%7D%5E%5Ccirc%20=%5Cleft%5C%7B%20%5Csum_%7Bi=1%7D%5E%7Bn-1%7D%20%5Calpha_i%20a_i,%20%5Ctext%7B%20for%20%7D%20%5Calpha_1%20%5Cgeq%200,%20%5Cdots,%20%5Calpha_%7Bn-1%7D%20%5Cgeq%200%20%5Cright%5C%7D%20=%20A%5E%5Ctop%20%5Cmathbb%7BR%7D_+%5E%7Bn-1%7D%5Censpace.%0A"></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Let <img src="https://latex.codecogs.com/png.latex?x%20%5Cin%20%5Cmathcal%7BK%7D"> and <img src="https://latex.codecogs.com/png.latex?v%20=%20%5Csum_%7Bi=1%7D%5E%7Bn-1%7D%20%5Calpha_i%20a_i"> with <img src="https://latex.codecogs.com/png.latex?%5Calpha_1%20%5Cgeq%200,%20%5Cdots,%20%5Calpha_%7Bn-1%7D%20%5Cgeq%200">. Then, note that <img src="https://latex.codecogs.com/png.latex?A%20x%20%5Cleq%200"> is equivalent to <img src="https://latex.codecogs.com/png.latex?%5Clangle%20a_i,%20x%20%5Crangle%20%5Cleq%200"> for all <img src="https://latex.codecogs.com/png.latex?i%20%5Cin%20%5Cllbracket%201,%20n-1%20%5Crrbracket">. Hence, we have <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Clangle%20v,%20x%20%5Crangle%0A&amp;%20=%20%5Csum_%7Bi=1%7D%5E%7Bn-1%7D%20%5Calpha_i%20%5Clangle%20a_i,%20x%20%5Crangle%5C%5C%0A&amp;%20%5Cleq%200%20%5Censpace.%0A%5Cend%7Balign*%7D%0A"> So <img src="https://latex.codecogs.com/png.latex?%5Cleft%5C%7B%20%5Csum_%7Bi=1%7D%5E%7Bn-1%7D%20%5Calpha_i%20a_i,%20%5Ctext%7B%20with%20%7D%20%5Calpha_1%20%5Cgeq%200,%20%5Cdots,%20%5Calpha_%7Bn-1%7D%20%5Cgeq%200%20%5Cright%5C%7D%20%5Csubset%20%5Cmathcal%7BK%7D%5E%5Ccirc">.</p>
<p>For the converse, let <img src="https://latex.codecogs.com/png.latex?v%20%5Cin%20%5Cmathcal%7BK%7D%5E%5Ccirc">. One can check that <img src="https://latex.codecogs.com/png.latex?(a_i)_%7Bi=1,%5Cdots,n-1%7D"> are linearly independant, so adding the vector <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7B1%7D_n=(1,%5Cdots,1)%5E%5Ctop/n"> create a basis of <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5En">.</p>
<p>Hence one can write <img src="https://latex.codecogs.com/png.latex?v=%20%5Calpha_n%20%5Cmathbf%7B1%7D_n%20+%20%5Csum_%7Bi=1%7D%5E%7Bn-1%7D%20%5Calpha_i%20a_i">. Now choosing <img src="https://latex.codecogs.com/png.latex?x=%5Cmathbf%7B1%7D_n%20%5Cin%20%5Cmathcal%7BK%7D"> yields <img src="https://latex.codecogs.com/png.latex?%5Clangle%20v,%20%5Cmathbf%7B1%7D_n%20%5Crangle%20=%20%5Calpha_n%20%5Cleq%200">. Choosing <img src="https://latex.codecogs.com/png.latex?x%20=%20-%20%5Cmathbf%7B1%7D_n%20%5Cin%20%5Cmathcal%7BK%7D"> yields <img src="https://latex.codecogs.com/png.latex?%5Clangle%20v,%20-%20%5Cmathbf%7B1%7D_n%20%5Crangle%20=%20-%20%5Calpha_n%20%5Cleq%200">. Hence, <img src="https://latex.codecogs.com/png.latex?%5Calpha_n%20=%200">.</p>
<p>Now, for all <img src="https://latex.codecogs.com/png.latex?i%20%5Cin%20%5Cllbracket%201,%20n-1%20%5Crrbracket">, choosing <img src="https://latex.codecogs.com/png.latex?x%20=%20%5Csum_%7Bk=i%7D%5En%20e_i"> for <img src="https://latex.codecogs.com/png.latex?i%20%5Cin%20%5Cllbracket%202,n%5Crrbracket"> yields <img src="https://latex.codecogs.com/png.latex?%5Clangle%20v,%20x%20%5Crangle%20=%20-%5Calpha_%7Bi%7D%5Cleq%200">. Hence, for all $ i, n-1 $, we have <img src="https://latex.codecogs.com/png.latex?%5Calpha_i%20%5Cgeq%200">, so <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BK%7D%5E%5Ccirc%20%5Csubset%20%5Cleft%5C%7B%20%5Csum_%7Bi=1%7D%5E%7Bn-1%7D%20%5Calpha_i%20a_i,%20%5Ctext%7B%20with%20%7D%20%5Calpha_1%20%5Cgeq%200,%20%5Cdots,%20%5Calpha_%7Bn-1%7D%20%5Cgeq%200%20%5Cright%5C%7D"> and the lemma is proved.</p>
</div>
</section>
<section id="conic-duality-fenchel-transform" class="level2">
<h2 class="anchored" data-anchor-id="conic-duality-fenchel-transform">Conic duality / Fenchel transform</h2>
<p>Here we remind the definition of the Fenchel transform of a function <img src="https://latex.codecogs.com/png.latex?f"> defined on <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5En">: <img src="https://latex.codecogs.com/png.latex?%0Af%5E*(v)%20=%20%5Csup_%7Bx%20%5Cin%20%5Cmathbb%7BR%7D%5En%7D%20%5Cleft%5C%7B%20%5Clangle%20v,%20x%20%5Crangle%20-%20f(x)%20%5Cright%5C%7D%5Censpace.%0A"></p>
<p>We also write <img src="https://latex.codecogs.com/png.latex?%5Ciota_%7B%5Cmathcal%7BK%7D%7D"> the indicator function of the set <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BK%7D">, that is <img src="https://latex.codecogs.com/png.latex?%5Ciota_%7B%5Cmathcal%7BK%7D%7D(x)%20=%200"> if <img src="https://latex.codecogs.com/png.latex?x%20%5Cin%20%5Cmathcal%7BK%7D"> and <img src="https://latex.codecogs.com/png.latex?+%5Cinfty"> otherwise.</p>
<div id="lem-fenchel" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 2 (Fenchel transform of indicator of a cone)</strong></span> The Fenchel transform of the indicator function of a convex cone <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BK%7D"> is <img src="https://latex.codecogs.com/png.latex?%0A%5Ciota_%7B%5Cmathcal%7BK%7D%7D%5E*(v)%20=%20%5Ciota_%7B%5Cmathcal%7BK%7D%5E%5Ccirc%7D(v)%5Censpace,%0A"> where <img src="https://latex.codecogs.com/png.latex?%5Ciota_%7B%5Cmathcal%7BK%7D%5E%5Ccirc%7D"> is the indicator function of the set <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BK%7D%5E%5Ccirc">.</p>
</div>
</section>
<section id="dual-problem" class="level2">
<h2 class="anchored" data-anchor-id="dual-problem">Dual problem</h2>
<p>Let us now derive the dual problem of the isotonic regression problem given in Equation&nbsp;2.</p>
<div id="thm-dual" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (Dual problem of isotonic regression&gt;)</strong></span> The dual problem of the isotonic regression problem given in Equation&nbsp;2 is <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmax_%7B%5Calpha%20%5Cin%20%5Cmathbb%7BR%7D_+%5E%7Bn-1%7D%7D%20&amp;%0A%5Cleft%5B%0A%20%20%20%20-%20%5Cfrac%7B1%7D%7B2%7D%20(A%5E%5Ctop%20%5Calpha-W%20y)%5E%5Ctop%20W%5E%7B-1%7D%20(A%5E%5Ctop%20%5Calpha-W%20y)%0A%20%20%20%20+%20%5Cfrac%7B1%7D%7B2%7D%20y%5E%5Ctop%20W%20y%0A%5Cright%5D%20%5Censpace.%0A%5Cend%7Balign*%7D%0A"></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>With such ingredient we can write the isotonic regression problem as: <span id="eq-isotonic-matrix-2"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cmin_%7Bx%20%5Cin%20%5Cmathbb%7BR%7D%5En%7D%0A%5Cfrac%7B1%7D%7B2%7D%0A(y-x)%5E%5Ctop%20W%20(y-x)%20+%20%5Ciota_%7B%5Cmathcal%7BK%7D%7D(x)%20%5Censpace.%0A%5Cend%7Balign%7D%0A%5Ctag%7B4%7D"></span> We can now rewrite the formulation as</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmin_%7Bx%20%5Cin%20%5Cmathbb%7BR%7D%5En%7D%20&amp;%0A%5Cfrac%7B1%7D%7B2%7D%0Az%5E%5Ctop%20W%20z%20+%20%5Ciota_%7B%5Cmathcal%7BK%7D%7D(x)%5C%5C%0A%5Ctext%7Bs.t.%7D%20&amp;%20%5Cquad%20z%20=%20y%20-%20x%20%20%5Censpace.%0A%5Cend%7Balign*%7D%0A"> We can now introduce the Lagrangian of the problem: <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmathcal%7BL%7D(x,%20z,%20%5Clambda)%20&amp;%20=%20%5Cfrac%7B1%7D%7B2%7D%20z%5E%5Ctop%20W%20z%20+%20%5Ciota_%7B%5Cmathcal%7BK%7D%7D(x)%20+%20%5Clambda%5E%5Ctop%20(y%20-%20z%20-%20x)%5C%5C%0A&amp;%20=%20%5Cfrac%7B1%7D%7B2%7D%20z%5E%5Ctop%20W%20z%20+%20%5Ciota_%7B%5Cmathcal%7BK%7D%7D(x)%20+%20%5Clambda%5E%5Ctop%20y%20-%20%5Clambda%5E%5Ctop%20z%20-%20%5Clambda%5E%5Ctop%20x%20%5Censpace.%0A%5Cend%7Balign*%7D%0A"> Assuming strong duality holds, we can write the dual problem as <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmin_%7Bx%20%5Cin%20%5Cmathbb%7BR%7D%5En,%20z%20%5Cin%20%5Cmathbb%7BR%7D%5En%7D%20%5Cmax_%7B%5Clambda%20%5Cin%20%5Cmathbb%7BR%7D%5En%7D%20~%0A%5Cmathcal%7BL%7D(x,%20z,%20%5Clambda)%20=%0A%5Cmax_%7B%5Clambda%20%5Cin%20%5Cmathbb%7BR%7D%5En%7D%20%5Cmin_%7Bx%20%5Cin%20%5Cmathbb%7BR%7D%5En,%20z%20%5Cin%20%5Cmathbb%7BR%7D%5En%7D%20&amp;%0A%5Cmathcal%7BL%7D(x,%20z,%20%5Clambda)%20%5Censpace.%0A%5Cend%7Balign*%7D%0A"> Now, one can check that the dual problem is equivalent to</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmax_%7B%5Clambda%20%5Cin%20%5Cmathbb%7BR%7D%5En%7D%20%5Cmin_%7Bx%20%5Cin%20%5Cmathbb%7BR%7D%5En,%20z%20%5Cin%20%5Cmathbb%7BR%7D%5En%7D%20%5Cleft%5C%7B%20%5Cfrac%7B1%7D%7B2%7D%20z%5E%5Ctop%20W%20z%20+%20%5Ciota_%7B%5Cmathcal%7BK%7D%7D(x)%20+%20%5Clambda%5E%5Ctop%20y%20-%20%5Clambda%5E%5Ctop%20z%20-%20%5Clambda%5E%5Ctop%20x%20%5Cright%5C%7D%20%5Censpace.%0A"> Separating the terms in <img src="https://latex.codecogs.com/png.latex?x"> and <img src="https://latex.codecogs.com/png.latex?z"> yields <img src="https://latex.codecogs.com/png.latex?%0A%5Cmax_%7B%5Clambda%20%5Cin%20%5Cmathbb%7BR%7D%5En%7D%0A%5Cleft%5B%0A%20%20%20%20%5Cmin_%7Bx%20%5Cin%20%5Cmathbb%7BR%7D%5En%7D%20%5Cleft%5C%7B%20%5Ciota_%7B%5Cmathcal%7BK%7D%7D(x)%20-%20%5Clambda%5E%5Ctop%20x%20+%20%5Clambda%5E%5Ctop%20y%20%5Cright%5C%7D%20+%20%5Cmin_%7Bz%20%5Cin%20%5Cmathbb%7BR%7D%5En%7D%20%5Cleft%5C%7B%20%5Cfrac%7B1%7D%7B2%7D%20z%5E%5Ctop%20W%20z%20-%20%5Clambda%5E%5Ctop%20z%20%5Cright%5C%7D%0A%5Cright%5D%0A%5Censpace.%0A"> The second term is a simple quadratic problem with a unique solution given by <img src="https://latex.codecogs.com/png.latex?z%20=%20W%5E%7B-1%7D%20%5Clambda">, hence this can be rewritten as <img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5B%0A-%20%5Cfrac%7B1%7D%7B2%7D%20%5Clambda%5E%5Ctop%20W%5E%7B-1%7D%20%5Clambda%0A%5Cright%5D%0A%5Censpace.%0A"> The first term is linked to the Fenchel transform of the indicator function of the cone <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BK%7D">, and reads <img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5B%0A%20%20%20%20-%20%5Ciota_%7B%5Cmathcal%7BK%7D%5E%5Ccirc%7D(%5Clambda)%20+%20%5Clambda%5E%5Ctop%20y%20=%20-%20%5Ciota_%7B%5Cmathcal%7BK%7D%5E%5Ccirc%7D(%5Clambda)%20+%20%5Clambda%5E%5Ctop%20W%5E%7B-1%7D%20W%20y%0A%5Cright%5D%0A%5Censpace.%0A"></p>
<p>Hence the dual problem reads: <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmax_%7B%5Clambda%20%5Cin%20%5Cmathbb%7BR%7D%5En%7D%20&amp;%0A%5Cleft%5B%0A%20%20%20%20-%20%5Ciota_%7B%5Cmathcal%7BK%7D%5E%5Ccirc%7D(%5Clambda)%20+%20%5Clambda%5E%5Ctop%20y%20-%20%5Cfrac%7B1%7D%7B2%7D%20%5Clambda%5E%5Ctop%20W%5E%7B-1%7D%20%5Clambda%0A%5Cright%5D%20%5Censpace,%0A%5Cend%7Balign*%7D%0A"> the later can be rewritten as</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmax_%7B%5Clambda%20%5Cin%20%5Cmathcal%7BK%7D%5E%7B%5Ccirc%7D%7D%20&amp;%0A%5Cleft%5B%0A%20%20%20%20-%20%5Cfrac%7B1%7D%7B2%7D%20(%5Clambda-W%20y)%5E%5Ctop%20W%5E%7B-1%7D%20(%5Clambda-W%20y)%0A%20%20%20%20+%20%5Cfrac%7B1%7D%7B2%7D%20y%5E%5Ctop%20W%20y%0A%5Cright%5D%20%5Censpace.%0A%5Cend%7Balign*%7D%0A"> Eventually, using the formulation of <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BK%7D%5E%7B%5Ccirc%7D"> given in Lemma&nbsp;1, the dual problem can be rewritten as <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmax_%7B%5Calpha%20%5Cin%20%5Cmathbb%7BR%7D_+%5E%7Bn-1%7D%7D%20&amp;%0A%5Cleft%5B%0A%20%20%20%20-%20%5Cfrac%7B1%7D%7B2%7D%20(A%5E%5Ctop%20%5Calpha-W%20y)%5E%5Ctop%20W%5E%7B-1%7D%20(A%5E%5Ctop%20%5Calpha-W%20y)%0A%20%20%20%20+%20%5Cfrac%7B1%7D%7B2%7D%20y%5E%5Ctop%20W%20y%0A%5Cright%5D%20%5Censpace,%0A%5Cend%7Balign*%7D%0A"> which is the targeted formulation.</p>
</div>
</section>
<section id="karush-kuhn-tucker-kkt-conditions" class="level2">
<h2 class="anchored" data-anchor-id="karush-kuhn-tucker-kkt-conditions">Karush-Kuhn-Tucker (KKT) conditions</h2>
<p>The KKT conditions for the isotonic regression problem are given by</p>
<div id="thm-kkt" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2 (KKT conditions for isotonic regression)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?x%5E%7B%5Cstar%7D%20%5Cin%20%5Cmathcal%7BK%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Calpha%5E%7B%5Cstar%7D%20%5Cin%20%5Cmathbb%7BR%7D_+%5E%7Bn-1%7D"> be primal and dual optimal solutions, then the KKT conditions for the isotonic regression problem reads <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AW%20(x%5E%7B%5Cstar%7D-y)%20+%20A%5E%5Ctop%20%5Calpha%5E%7B%5Cstar%7D%20&amp;%20=%200%20&amp;%20~%20(%5Ctextbf%7Bstationarity%7D)%5C%5C%0A%5Clangle%20%5Calpha%5E%7B%5Cstar%7D%20,%20A%20x%5E%7B%5Cstar%7D%20%5Crangle%20&amp;%20=%200%20&amp;%20~%20(%5Ctextbf%7Bcomplementary%20slackness%7D)%5C%5C%0A%5Calpha%5E%7B%5Cstar%7D%20&amp;%20%5Cgeq%200%20&amp;%20~%20(%5Ctextbf%7Bdual%20feasibility%7D)%5C%5C%0AA%20x%5E%7B%5Cstar%7D%20&amp;%20%5Cleq%200%20&amp;%20~%20%20(%5Ctextbf%7Bprimal%20feasibility%7D)%0A%5Cend%7Balign*%7D%0A"></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>See <span class="citation" data-cites="Boyd_Vandenberghe04">(Boyd and Vandenberghe 2004, sec. 5.5.3)</span></p>
</div>
<p>In this convex setting (a primal strictly feasible point exists, say <img src="https://latex.codecogs.com/png.latex?x=(1,%5Cdots,n)%5E%5Ctop">, so the Slater condition holds), the KKT conditions are necessary and sufficient for optimality.</p>
<p><strong>Stationarity</strong> can be rephrased as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Aw_1%20(x%5E%7B%5Cstar%7D_1-%20y_1)%20+%20%5Calpha%5E%7B%5Cstar%7D_1%20&amp;%20=%200%20%5C%5C%0Aw_i%20(x%5E%7B%5Cstar%7D_i-%20y_i)%20+%20%5Calpha%5E%7B%5Cstar%7D_%7Bi%7D%20-%20%5Calpha%5E%7B%5Cstar%7D_%7Bi-1%7D%20&amp;%20=%200,%20%5Cquad%20%5Ctext%7Bfor%20all%20%7D%20i%20%5Cin%20%5Cllbracket%202,%20n-1%20%5Crrbracket%5C%5C%0Aw_n%20(x%5E%7B%5Cstar%7D_n%20-%20y_n)%20-%20%5Calpha%5E%7B%5Cstar%7D_%7Bn-1%7D%20&amp;%20=%200%20%5Censpace.%0A%5Cend%7Balign*%7D%0A"> With the convention <img src="https://latex.codecogs.com/png.latex?%5Calpha_0%5E%7B%5Cstar%7D%20=%20%5Calpha_n%5E%7B%5Cstar%7D%20=%200">, this reduces to <span id="eq-stationarity"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Aw_i%20(x%5E%7B%5Cstar%7D_i%20-%20y_i)%20+%20%5Calpha%5E%7B%5Cstar%7D_%7Bi%7D%20-%20%5Calpha%5E%7B%5Cstar%7D_%7Bi-1%7D%20&amp;%20=%200,%20%5Cquad%20%5Ctext%7Bfor%20all%20%7D%20i%20%5Cin%20%5Cllbracket%201,%20n%20%5Crrbracket%5C%5C%0A%5Cend%7Balign*%7D%0A%5Ctag%7B5%7D"></span></p>
<p><strong>Complementarity slackness</strong> can also be rephrased: <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A&amp;%20%5Calpha_i%5E%7B%5Cstar%7D%20(A%20x%5E%7B%5Cstar%7D)_i%20%20=%200%20%5Cquad%20%5Ctext%7Bfor%20all%20%7D%20i%20%5Cin%20%5Cllbracket%201,%20n-1%20%5Crrbracket%20%5C%5C%0A%5Ciff%20&amp;%20%5Calpha_i%5E%7B%5Cstar%7D%20(x%5E%7B%5Cstar%7D_i-x%5E%7B%5Cstar%7D_%7Bi+1%7D)%20%20=%200%20%5Cquad%20%5Ctext%7Bfor%20all%20%7D%20i%20%5Cin%20%5Cllbracket%201,%20n-1%20%5Crrbracket%20%5Censpace.%0A%5Cend%7Balign*%7D%0A"></p>
<p>A simple consequence of the complementarity slackness is as follows: if <img src="https://latex.codecogs.com/png.latex?%5Calpha_i%5E%7B%5Cstar%7D%20%3E%200"> for some <img src="https://latex.codecogs.com/png.latex?i%20%5Cin%20%5Cllbracket%201,%20n-1%20%5Crrbracket">, then <img src="https://latex.codecogs.com/png.latex?x%5E%7B%5Cstar%7D_i%20=%20x%5E%7B%5Cstar%7D_%7Bi+1%7D">. Hence, the set of (<img src="https://latex.codecogs.com/png.latex?n-1">) constraints can be partitioned into contiguous blocks where <img src="https://latex.codecogs.com/png.latex?x%5E%5Cstar"> has constant value. Each block B can be written as <img src="https://latex.codecogs.com/png.latex?B%20=%20%5Cllbracket%20%5Cunderline%7Bb%7D,%20%5Coverline%7Bb%7D%20%5Crrbracket"> for some <img src="https://latex.codecogs.com/png.latex?%5Cunderline%7Bb%7D%20%5Cleq%20%5Coverline%7Bb%7D"> and <img src="https://latex.codecogs.com/png.latex?x%5E%7B%5Cstar%7D_%7B%5Cunderline%7Bb%7D%7D%20=%20x%5E%7B%5Cstar%7D_%7B%5Cunderline%7Bb%7D+1%7D%20=%20%5Cldots%20=%20x%5E%7B%5Cstar%7D_%7B%5Coverline%7Bb%7D%7D">. When needed we use the convention <img src="https://latex.codecogs.com/png.latex?x%5E%7B%5Cstar%7D_%7B0%7D=0"> and <img src="https://latex.codecogs.com/png.latex?x%5E%7B%5Cstar%7D_%7Bn+1%7D=n+1">. and <img src="https://latex.codecogs.com/png.latex?x%5E%7B%5Cstar%7D_%7Bn+1%7D=0">. Then, note that by definition of a block, <img src="https://latex.codecogs.com/png.latex?x%5E%7B%5Cstar%7D_%7B%5Cunderline%7Bb%7D-1%7D%3Cx%5E%7B%5Cstar%7D_%7B%5Cunderline%7Bb%7D%7D"> and <img src="https://latex.codecogs.com/png.latex?x%5E%7B%5Cstar%7D_%7B%5Coverline%7Bb%7D%7D%3Cx%5E%7B%5Cstar%7D_%7B%5Coverline%7Bb%7D+1%7D">, and by complementarity <img src="https://latex.codecogs.com/png.latex?%5Calpha%5E%7B%5Cstar%7D_%7B%5Cunderline%7Bb%7D-1%7D%20=%20%5Calpha%5E%7B%5Cstar%7D_%7B%5Coverline%7Bb%7D+1%7D%20=%200">.</p>
<p>Summing over the elements of <img src="https://latex.codecogs.com/png.latex?B"> in Equation&nbsp;5 yields (telescopic sum): <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Csum_%7Bi%20%5Cin%20B%20%7Dw_i%20(x%5E%7B%5Cstar%7D_i%20-%20y_i)%20+%20%20%5Calpha_%7B%5Coverline%7Bb%7D+1%7D%5E%7B%5Cstar%7D%20-%20%5Calpha_%7B%5Cunderline%7Bb%7D-1%7D%5E%7B%5Cstar%7D%20&amp;%20=%200%20%5Censpace.%0A%5Cend%7Balign*%7D%0A"> Hence, noticing that the <img src="https://latex.codecogs.com/png.latex?x_i%5E%7B%5Cstar%7D"> in block <img src="https://latex.codecogs.com/png.latex?B"> are all equal, we have that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Ax%5E%7B%5Cstar%7D_%7B%5Cunderline%7Bb%7D%7D%20=%20%5Cldots%20=%20x%5E%7B%5Cstar%7D_%7B%5Coverline%7Bb%7D%7D%20=%20%5Cbar%7By%7D_B%20%20%5Cbig(=%20%5Cbar%7By%7D_%7B%5Cllbracket%20%5Cunderline%7Bb%7D,%20%5Coverline%7Bb%7D%20%5Crrbracket%7D%20%5Cbig)%5Censpace.%0A%5Cend%7Balign*%7D%0A"></p>
<p>Now, from the values of <img src="https://latex.codecogs.com/png.latex?x%5E%7B%5Cstar%7D_%7B%5Cunderline%7Bb%7D%7D%20=%20%5Cldots%20=%20x%5E%7B%5Cstar%7D_%7B%5Coverline%7Bb%7D%7D"> on the block <img src="https://latex.codecogs.com/png.latex?B">, one can infer (by recursion) the <img src="https://latex.codecogs.com/png.latex?%5Calpha_i">’s for <img src="https://latex.codecogs.com/png.latex?i%5Cin%20B">.</p>
<div id="lem-lambda" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 3 (Expression of the dual variables)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?B%20=%5Cllbracket%20%5Cunderline%7Bb%7D,%20%5Coverline%7Bb%7D%20%5Crrbracket"> be partitionning block for <img src="https://latex.codecogs.com/png.latex?x%5E%5Cstar"> (into constants pieces). For any <img src="https://latex.codecogs.com/png.latex?i%20%5Cin%20B">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Calpha%5E%7B%5Cstar%7D_%7Bi%7D%20&amp;%20=%20%5CBig(%5Csum_%7Bj%20%5Cin%20B%20%5Ccap%20%5Cllbracket%201,%20i%20%5Crrbracket%7D%20w_j%20%5CBig)%5Cleft(%5Cbar%7By%7D_%7BB%20%5Ccap%20%5Cllbracket%201,%20i+1%20%5Crrbracket%7D%20-%20%5Cbar%7By%7D_%7BB%7D%5Cright)%20%5Censpace.%0A%5Cend%7Balign*%7D%0A"></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>The proof is a simple induction on the element of block <img src="https://latex.codecogs.com/png.latex?B">. For <img src="https://latex.codecogs.com/png.latex?i=%5Cunderline%7Bb%7D"> then Equation&nbsp;5 leads to <img src="https://latex.codecogs.com/png.latex?%5Calpha%5E%7B%5Cstar%7D_%7B%5Cunderline%7Bb%7D%7D%20=%20w_%7B%5Cunderline%7Bb%7D%7D%20(%5Cbar%7By%7D_%7B%5Cunderline%7Bb%7D%7D%20-%20x%5E%7B%5Cstar%7D_%7B%5Cunderline%7Bb%7D%7D)%20=%20%5CBig(%5Csum_%7Bj%20%5Cin%20B%20%5Ccap%20%5Cllbracket%201,%20i%20%5Crrbracket%7D%20w_j%20%5CBig)%5Cleft(%5Cbar%7By%7D_%7BB%20%5Ccap%20%5Cllbracket%201,%20i%20%5Crrbracket%7D%20-%20%5Cbar%7By%7D_%7BB%7D%20%5Cright)">. Now by induction assume the result for <img src="https://latex.codecogs.com/png.latex?i%5Cin%20B">, <img src="https://latex.codecogs.com/png.latex?%5Calpha%5E%7B%5Cstar%7D_%7Bi%7D%20%20=%20%5CBig(%5Csum_%7Bj%20%5Cin%20B%20%5Ccap%20%5Cllbracket%201,%20i%20%5Crrbracket%7D%20w_j%20%5CBig)%5Cleft(%5Cbar%7By%7D_%7BB%20%5Ccap%20%5Cllbracket%201,%20i%20%5Crrbracket%7D%20-%20%5Cbar%7By%7D_%7BB%7D%5Cright)">. Using Equation&nbsp;5 for <img src="https://latex.codecogs.com/png.latex?i+1%20%5Cin%20B"> yields</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Calpha%5E%7B%5Cstar%7D_%7Bi+1%7D%0A&amp;%20=%20w_%7Bi+1%7D%20(y_%7Bi+1%7D%20-%20x%5E%7B%5Cstar%7D_%7Bi+1%7D)%20+%20%5Calpha%5E%7B%5Cstar%7D_i%5C%5C%0A&amp;%20=%20w_%7Bi+1%7D%20(y_%7Bi+1%7D%20-%20%5Coverline%7By%7D_%7BB%7D)%20+%20%5Calpha%5E%7B%5Cstar%7D_i%5C%5C%0A&amp;%20=%20w_%7Bi+1%7D%20(y_%7Bi+1%7D%20-%20%5Coverline%7By%7D_%7BB%7D)%20+%20%5CBig(%5Csum_%7Bj%20%5Cin%20B%20%5Ccap%20%5Cllbracket%201,%20i%20%5Crrbracket%7D%20w_j%20%20%5CBig)%5Cleft(%5Cbar%7By%7D_%7BB%20%5Ccap%20%5Cllbracket%201,%20i%20%5Crrbracket%7D%20-%5Cbar%7By%7D_%7BB%7D%5Cright)%5C%5C%0A&amp;%20=%20%5CBig(%5Csum_%7Bj%20%5Cin%20B%20%5Ccap%20%5Cllbracket%201,%20i%20+%201%20%5Crrbracket%7D%20w_j%20%20%5CBig)%5Cleft(%5Cbar%7By%7D_%7BB%20%5Ccap%20%5Cllbracket%201,%20i+1%20%5Crrbracket%7D%20-%20%5Cbar%7By%7D_%7BB%7D%5Cright)%20%5Censpace,%0A%5Cend%7Balign*%7D%0A"> hence the result.</p>
</div>
</section>
</section>
<section id="algorithm" class="level1">
<h1>Algorithm</h1>
<p>The intuition behind the PAVA algorithm is to merge adjacent blocks of constant values in the primal vector, as the targeted solution is simply the average of the observe signal over each block. Hence, the algorithm aims at creating the blocks of constant values in the primal vector. The dual variables can be inferred from the solution from the previous lemma.</p>
<section id="pseudo-code-and-python-implementation" class="level2">
<h2 class="anchored" data-anchor-id="pseudo-code-and-python-implementation">Pseudo-code and Python implementation</h2>
<div class="pseudocode-container quarto-float" data-pseudocode-number="1" data-no-end="false" data-line-number-punc=":" data-indent-size="1.2em" data-line-number="true" data-comment-delimiter="//" data-caption-prefix="Algorithm">
<div class="pseudocode">
\begin{algorithm} \caption{PAVA} \begin{algorithmic} \REQUIRE $y \in\mathbb{R}^n, w \in \mathbb{R}^n_{+}$ \STATE $r \leftarrow y$ \STATE $W \leftarrow y$ \STATE $J = [\{1\},\dots, \{n\}]$ \COMMENT{lists of blocks} \STATE $i=1$ (index of list start at 0 here) \WHILE{$i&lt;n$} \IF{$r_i &lt; r_{i-1}$} \COMMENT{Find adjacent violators and merge groups} \STATE $r_i \leftarrow \frac{W_i r_i + W_{i-1} r_{i-1}}{W_i + W_{i-1}}$ \STATE $W_i \leftarrow W_i + W_{i-1}$ \STATE $J_i \leftarrow J_i \cup J_{i-1}$ \STATE Remove $r_{i-1}$, $W_{i-1}$ and $J_{i-1}$ from the lists \IF{$i &gt; 1$} \STATE{$i\leftarrow i-1$} \ENDIF \ELSE \STATE{$i \leftarrow i + 1$} \ENDIF \ENDWHILE \FOR{$i=1$ to len($J$)} \STATE{$r_{J_i} \leftarrow \bar{y}_{J_i} \mathbf{1}_{J_i}$} \COMMENT{Set the block to the average value} \ENDFOR \RETURN{$r, J$} \end{algorithmic} \end{algorithm}
</div>
</div>
<p>Below you will find a simple version of the PAVA algorithm coded in Python. The <code>sklearn</code> version (in particular the <code>_isotonic.pyx</code> file, as available in October 2024, see <a href="https://github.com/scikit-learn/scikit-learn/blob/04fbe04fedda0e86e67867854900a49fb53c4c01/sklearn/_isotonic.pyx" target="_blank">source</a>). is more efficient but a little less readable.</p>
<div id="7a4c51fb" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> PAVA(y, w):</span>
<span id="cb1-4">    n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y)</span>
<span id="cb1-5">    r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> y.copy()</span>
<span id="cb1-6">    ws <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> w.copy()</span>
<span id="cb1-7">    target <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [[i] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n)]</span>
<span id="cb1-8">    i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-9">    counter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb1-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> n:</span>
<span id="cb1-11">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> r[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> r[i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]:  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Find adjacent violators</span></span>
<span id="cb1-12">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pool the violators</span></span>
<span id="cb1-13">            r[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (ws[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> r[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ws[i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> r[i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (ws[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ws[i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb1-14">            ws[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> ws[i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb1-15">            target[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> target[i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> target[i]</span>
<span id="cb1-16">            r.pop(i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-17">            ws.pop(i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-18">            target.pop(i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-19">            n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-20">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Move back one step if possible</span></span>
<span id="cb1-21">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb1-22">                i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-23">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb1-24">            i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-25">            counter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-26"></span>
<span id="cb1-27">    sol <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros_like(y)</span>
<span id="cb1-28">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i, block <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(target):</span>
<span id="cb1-29">        sol[block] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> r[i]</span>
<span id="cb1-30">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> sol, ws, target</span></code></pre></div>
</div>
<p>Below is a version of the algorithm similar to the one implemented in <code>sklearn</code> (yet in pure Python here). Moreover, it can be made an inplace method (as in <code>sklearn</code>), which is more memory efficient.</p>
<div id="38edd9f0" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> isotonic_regression(z, w):</span>
<span id="cb2-2">    y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> z.copy()</span>
<span id="cb2-3">    n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y)</span>
<span id="cb2-4">    i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb2-5">    target <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y))</span>
<span id="cb2-6">    targets <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [target.copy()]</span>
<span id="cb2-7">    idx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb2-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> n:</span>
<span id="cb2-9">        k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> target[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-10">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> n:</span>
<span id="cb2-11">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">break</span></span>
<span id="cb2-12">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> y[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> y[k]:</span>
<span id="cb2-13">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># We are in an increasing subsequence.</span></span>
<span id="cb2-14">            i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> k</span>
<span id="cb2-15">            targets.append(target.copy())</span>
<span id="cb2-16">            idx.append(k)</span>
<span id="cb2-17">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span></span>
<span id="cb2-18">        sum_wy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> w[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y[i]</span>
<span id="cb2-19">        sum_w <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> w[i]</span>
<span id="cb2-20">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>:</span>
<span id="cb2-21">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># We are within a decreasing subsequence.</span></span>
<span id="cb2-22">            prev_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> y[k]</span>
<span id="cb2-23">            sum_wy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> w[k] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y[k]</span>
<span id="cb2-24">            sum_w <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> w[k]</span>
<span id="cb2-25">            k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> target[k] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-26">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">or</span> prev_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> y[k]:</span>
<span id="cb2-27">                targets.append(target.copy())</span>
<span id="cb2-28">                idx.append(k)</span>
<span id="cb2-29"></span>
<span id="cb2-30">                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Non-singleton decreasing subsequence is finished,</span></span>
<span id="cb2-31">                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update first entry.</span></span>
<span id="cb2-32">                y[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sum_wy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> sum_w</span>
<span id="cb2-33">                w[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sum_w</span>
<span id="cb2-34"></span>
<span id="cb2-35">                target[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-36">                target[k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> i</span>
<span id="cb2-37"></span>
<span id="cb2-38">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb2-39">                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Backtrack if we can.  This makes the algorithm</span></span>
<span id="cb2-40">                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># single-pass and ensures O(n) complexity.</span></span>
<span id="cb2-41">                    i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> target[i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb2-42">                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Otherwise, restart from the same point.</span></span>
<span id="cb2-43">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">break</span></span>
<span id="cb2-44"></span>
<span id="cb2-45">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reconstruct the solution.</span></span>
<span id="cb2-46">    i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb2-47">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> n:</span>
<span id="cb2-48">        k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> target[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-49">        y[i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> : k] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> y[i]</span>
<span id="cb2-50">        i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> k</span>
<span id="cb2-51">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> y, targets, idx</span></code></pre></div>
</div>
</section>
<section id="convergence" class="level2">
<h2 class="anchored" data-anchor-id="convergence">Convergence</h2>
<div id="thm-convergence" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3 (Convergence of the PAVA algorithm)</strong></span> The PAVA algorithm converges in a finite number of iterations and output the primal solution of the isotonic regression problem.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>To show the convergence we will create a dual variable <img src="https://latex.codecogs.com/png.latex?%5Calpha">, show that it is dual feasible, and that at the end of the algorithm it satisfies KKT along with the output of the PAVA algorithm.</p>
<p>For that let us first prove the following result:</p>
<p><strong>Fact 1</strong>. Let <img src="https://latex.codecogs.com/png.latex?B%20%5Cin%20J"> be a block at some stage of the algorithm. Then, <img src="https://latex.codecogs.com/png.latex?%5Cforall%20i%20%5Cin%20B,%20%5Coverline%7By%7D_%7BB%20%5Ccap%20%5Cllbracket%201,%20i%20%5Crrbracket%7D%20%5Cgeq%20%5Coverline%7By%7D_%7BB%7D%20%5Censpace.%0A"></p>
<p>To show this result, we will use induction and show that the merging process does maintain this condition. First, at initialization, the condition is true as the blocks have all size 1. Now, assume that the condition is true, and check what happen when we merge two consecutive groups <img src="https://latex.codecogs.com/png.latex?J_i"> and <img src="https://latex.codecogs.com/png.latex?J_%7Bi-1%7D"> into <img src="https://latex.codecogs.com/png.latex?B=J_%7Bi-1%7D%20%5Ccup%20J_%7Bi%7D">. First the condition is true for <img src="https://latex.codecogs.com/png.latex?J_i"> and <img src="https://latex.codecogs.com/png.latex?J_%7Bi-1%7D">, so <img src="https://latex.codecogs.com/png.latex?%5Coverline%7By%7D_%7BJ_i%20%5Ccap%20%5Cllbracket%201,%20k%20%5Crrbracket%7D%20%5Cgeq%20%5Coverline%7By%7D_%7BJ_i%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Coverline%7By%7D_%7BJ_%7Bi-1%7D%20%5Ccap%20%5Cllbracket%201,%20k'%20%5Crrbracket%7D%20%5Cgeq%20%5Coverline%7By%7D_%7BJ_%7Bi-1%7D%7D"> for any <img src="https://latex.codecogs.com/png.latex?k%20%5Cin%20J_i"> and <img src="https://latex.codecogs.com/png.latex?k'%20%5Cin%20J_%7Bi-1%7D">. Then, the test <img src="https://latex.codecogs.com/png.latex?r_i%20%3C%20r_%7Bi-1%7D"> is equivalent to <img src="https://latex.codecogs.com/png.latex?%5Coverline%7By%7D_%7BJ_i%7D%20%3C%20%5Coverline%7By%7D_%7BJ_%7Bi-1%7D%7D">. So for any <img src="https://latex.codecogs.com/png.latex?k%20%5Cin%20J_%7Bi-1%7D">, we have <img src="https://latex.codecogs.com/png.latex?%5Coverline%7By%7D_%7BJ_i%20%5Ccap%20%5Cllbracket%20k,%20n%20%5Crrbracket%7D%20%5Cgeq%20%5Coverline%7By%7D_%7BJ_i%7D"> using the induction hypothesis. For <img src="https://latex.codecogs.com/png.latex?k'%5Cin%20J_%7Bi%7D">, <img src="https://latex.codecogs.com/png.latex?%5Coverline%7By%7D_%7BB%20%5Ccap%20%5Cllbracket%201,%20k%20%5Crrbracket%7D%20=%20%5Coverline%7By%7D_%7BJ_%7Bi-1%7D%20%5Ccap%20%5Cllbracket%201,%20k%20%5Crrbracket%7D%20%5Cgeq%20%5Coverline%7By%7D_%7BJ_%7Bi-1%7D%7D%20%5Cgeq%20%5Coverline%7By%7D_%7BB%7D"> (where the last inequality is due to the test <img src="https://latex.codecogs.com/png.latex?r_i%20%3C%20r_%7Bi-1%7D">). For the case <img src="https://latex.codecogs.com/png.latex?k'%20%5Cin%20J_i">, we have</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Coverline%7By%7D_%7BB%20%5Ccap%20%5Cllbracket%201,%20k'%20%5Crrbracket%7D%0A&amp;%20=%20%5Coverline%7By%7D_%7B%20J_%7Bi-1%7D%20%5Ccup%20(J_%7Bi%7D%20%5Ccap%20%5Cllbracket%201,%20k'%20%5Crrbracket)%7D%20%5C%5C%0A&amp;%20%5Cgeq%20%5Cfrac%7B%5CBig(%5Csum_%7B%5Cell%20%5Cin%20J_%7Bi-1%7D%7D%20w_%7B%5Cell%7D%20%5CBig)%20%5Ccdot%20%5Coverline%7By%7D_%7BJ_%7Bi-1%7D%7D%20+%20%5CBig(%5Csum_%7B%5Cell%20%5Cin%20J_%7Bi%7D%20%5Ccap%20%5Cllbracket%201,%20k'%20%5Crrbracket%7D%20w_%7B%5Cell%7D%20%5CBig)%20%5Ccdot%20%5Coverline%7By%7D_%7BJ_%7Bi%7D%20%5Ccap%20%5Cllbracket%201,%20k'%20%5Crrbracket%7D%7D%7B%5Csum_%7BJ_%7Bi-1%7D%7D%20w_i%20+%20%5Csum_%7BJ_%7Bi%7D%20%5Ccap%20%5Cllbracket%201,%20k'%20%5Crrbracket%7D%20w_i%7D%5C%5C%0A&amp;%20%5Cgeq%20%5Cfrac%7B%5CBig(%5Csum_%7B%5Cell%20%5Cin%20J_%7Bi-1%7D%7D%20w_%7B%5Cell%7D%20%5CBig)%20%5Ccdot%20%5Coverline%7By%7D_%7BJ_%7Bi-1%7D%7D%20+%20%5CBig(%5Csum_%7B%5Cell%20%5Cin%20J_%7Bi%7D%20%5Ccap%20%5Cllbracket%201,%20k'%20%5Crrbracket%7D%20w_%7B%5Cell%7D%20%5CBig)%20%5Ccdot%20%5Coverline%7By%7D_%7BJ_%7Bi%7D%7D%7D%7B%5Csum_%7BJ_%7Bi-1%7D%7D%20w_i%20+%20%5Csum_%7BJ_%7Bi%7D%20%5Ccap%20%5Cllbracket%201,%20k'%20%5Crrbracket%7D%20w_i%7D%20%5Cquad%20(%5Ctext%7Binduction%7D)%5C%5C%0A&amp;%20%5Cgeq%20%5Cfrac%7B%5CBig(%5Csum_%7B%5Cell%20%5Cin%20J_%7Bi-1%7D%7D%20w_%7B%5Cell%7D%20%5CBig)%20%5Ccdot%20%5Coverline%7By%7D_%7BJ_%7Bi-1%7D%7D%20+%20%5CBig(%5Csum_%7B%5Cell%20%5Cin%20J_%7Bi%7D%20%5Ccap%20%5Cllbracket%201,%20k'%20%5Crrbracket%7D%20w_%7B%5Cell%7D%20%5CBig)%20%5Ccdot%20%5Coverline%7By%7D_%7BJ_%7Bi%7D%7D%7D%7B%5Csum_%7BJ_%7Bi-1%7D%7D%20w_i%20+%20%5Csum_%7BJ_%7Bi%7D%20%5Ccap%20%5Cllbracket%201,%20k'%20%5Crrbracket%7D%20w_i%7D%20%5Cquad%20(%5Ctext%7BPAVA%7D)%5C%5C%0A%5Cend%7Balign*%7D%0A"> Now, remember that <img src="https://latex.codecogs.com/png.latex?%5Coverline%7By%7D_%7BB%7D%20=%20%5Cfrac%7B%5CBig(%5Csum_%7B%5Cell%20%5Cin%20J_%7Bi-1%7D%7D%20w_%7B%5Cell%7D%20%5CBig)%20%5Ccdot%20%5Coverline%7By%7D_%7BJ_%7Bi-1%7D%7D%20+%20%5CBig(%5Csum_%7B%5Cell%20%5Cin%20J_%7Bi%7D%20%7D%20w_%7B%5Cell%7D%20%5CBig)%20%5Ccdot%20%5Coverline%7By%7D_%7BJ_%7Bi%7D%7D%7D%7B%5Csum_%7BJ_%7Bi-1%7D%7D%20w_i%20+%20%5Csum_%7BJ_%7Bi%7D%7D%20w_i%7D"> and that <img src="https://latex.codecogs.com/png.latex?%5Coverline%7By%7D_%7BJ_%7Bi-1%7D%7D%20%5Cgeq%20%20%5Coverline%7By%7D_%7BB%7D%20%5Cgeq%20%5Coverline%7By%7D_%7BJ_%7Bi%7D%7D"> (since <img src="https://latex.codecogs.com/png.latex?%5Coverline%7By%7D_%7BB%7D"> is a convex combination of <img src="https://latex.codecogs.com/png.latex?%5Coverline%7By%7D_%7BJ_%7Bi-1%7D%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Coverline%7By%7D_%7BJ_i%7D">), so the last inequality is true. One can check that the weight of <img src="https://latex.codecogs.com/png.latex?J_%7Bi%7D"> is larger in the definition of <img src="https://latex.codecogs.com/png.latex?%5Coverline%7By%7D_%7BB%7D"> than in the last inequality above, and so among the two convex combinations, the larger is the former. Hence, the fact is proved by induction.</p>
<p><strong>Fact 2.</strong> If you update <img src="https://latex.codecogs.com/png.latex?%5Calpha"> recursively, starting from <img src="https://latex.codecogs.com/png.latex?%5Calpha%20=%20%5Cmathbf%7B0%7D_%7Bn-1%7D"> and for if for each updated block <img src="https://latex.codecogs.com/png.latex?B%20%5Cin%20J"> you update <img src="https://latex.codecogs.com/png.latex?%5Calpha"> (as in Lemma&nbsp;3) by</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cforall%20i%20%5Cin%20B,%20%5Calpha_i%20&amp;%20=%20%5CBig(%5Csum_%7Bj%20%5Cin%20B%20%5Ccap%20%5Cllbracket%201,%20i%20%5Crrbracket%7D%20w_j%20%5CBig)%5Cleft(%20%5Cbar%7By%7D_%7BB%20%5Ccap%20%5Cllbracket%201,%20i%20%5Crrbracket%7D%20-%20%5Cbar%7By%7D_%7BB%7D%5Cright)%20%5Censpace,%0A%5Cend%7Balign*%7D%0A"> then <img src="https://latex.codecogs.com/png.latex?%5Calpha"> is dual feasible for all steps of the algorithm</p>
<p>The proof is a direct consequence of Fact 1 and the fact that the weights <img src="https://latex.codecogs.com/png.latex?w_i"> are non-negative.</p>
<p><strong>Fact 3.</strong> <img src="https://latex.codecogs.com/png.latex?%5Cforall%20i%20%5Cin%20B,%20%5Calpha_i=%5Calpha_%7Bi-1%7D%20+w_i(x_i%20-%20y_i)"> (where we assume that <img src="https://latex.codecogs.com/png.latex?x_i%20=%20%5Coverline%7By%7D_B">), which means that <img src="https://latex.codecogs.com/png.latex?%5Calpha"> and <img src="https://latex.codecogs.com/png.latex?x"> hence created satsfies.</p>
<p>Again this result is simple to prove, by following the exact same line encountered in the proof of Lemma&nbsp;3.</p>
<p><strong>Fact 4.</strong> When you exit the while loop, the output of the PAVA algorithm is a primal feasible point.</p>
<p>Indeed, the only way to exist is to have all blocks mean values ordered. Hence, when the algorithm stops the primal point create (after the block averaging step) is primal feasible.</p>
<p>Leveraging Fact 1. to 4. ensures that the KKT conditions are satisfied with the primal and dual points created. Hence, at the end of the algorithm, and the optimal solution is found.</p>
<section id="duality-gap" class="level2">
<h2 class="anchored" data-anchor-id="duality-gap">Duality Gap</h2>
<p>Given a primal feasible point <img src="https://latex.codecogs.com/png.latex?x%20%5Cin%20%5Cmathcal%7BK%7D"> and a dual feasible point <img src="https://latex.codecogs.com/png.latex?%5Calpha%20%5Cin%20%5Cmathbb%7BR%7D_+%5E%7Bn-1%7D">, we can obtain upper and lower bounds on the optimal value of the primal problem .</p>
<p>Note that at optimality <img src="https://latex.codecogs.com/png.latex?W%20x%5E%5Cstar%20=%20W%20y%20-%20A%5E%5Ctop%20%5Calpha%5E%5Cstar"> Hence, using a value of <img src="https://latex.codecogs.com/png.latex?x"> at some stage of the algorithm (corresponding to a feasible <img src="https://latex.codecogs.com/png.latex?%5Calpha">), the dual reads <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B2%7D%20y%5E%5Ctop%20W%20y%20-%20%5Cfrac%7B1%7D%7B2%7D%20x%5E%5Ctop%20W%20x">. For creating a primal feasible point, one can simply take the ordered version of the output, making the last element constant to create a non-decreasing vector. The later is coded in Python with the following function:</p>
<div id="e69ced72" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> replace_after_first_non_increasing(x, w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>w):</span>
<span id="cb3-2">    n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(x)</span>
<span id="cb3-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, n):</span>
<span id="cb3-4">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> x[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> x[i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]:</span>
<span id="cb3-5">            mean_value <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(x[i:] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> w[i:]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(w[i:])</span>
<span id="cb3-6">            x[i:] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mean_value</span>
<span id="cb3-7">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">break</span></span>
<span id="cb3-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> x</span></code></pre></div>
</div>
<p>As can be seen in the preliminary animation, the primal and dual objectives converge to the same value, which is the optimal value of the primal problem.</p>
</section>
</div>
</section>
</section>
<section id="references" class="level1">
<h1><i class="fa-solid fa-link" title="link" aria-label="link"></i> References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-Bellec_Salmon_Vaiter17" class="csl-entry">
Bellec, P. C., J. Salmon, and S. Vaiter. 2017. <span>“A Sharp Oracle Inequality for <span>Graph-Slope</span>.”</span> <em>Electron. J. Statist.</em> 11 (2): 4851–70. <a href="https://arxiv.org/pdf/1706.06977.pdf">https://arxiv.org/pdf/1706.06977.pdf</a>.
</div>
<div id="ref-Best_Chakravarti90" class="csl-entry">
Best, M. J., and N. Chakravarti. 1990. <span>“Active Set Algorithms for Isotonic Regression; a Unifying Framework.”</span> <em>Math. Programming</em> 47 (3): 425–39.
</div>
<div id="ref-Bogdan_vandenBerg_Sabatti_Su_Candes15" class="csl-entry">
Bogdan, M., E. van den Berg, C. Sabatti, W. Su, and E. J. Candès. 2015. <span>“<span class="nocase">SLOPE-adaptive</span> Variable Selection via Convex Optimization.”</span> <em>Ann. Appl. Stat.</em> 9 (3): 1103.
</div>
<div id="ref-Boyd_Vandenberghe04" class="csl-entry">
Boyd, S., and L. Vandenberghe. 2004. <em>Convex Optimization</em>. Cambridge University Press.
</div>
<div id="ref-Pedregosa13" class="csl-entry">
Pedregosa, F. 2013. <span>“Isotonic Regression.”</span> <a href="https://fa.bianp.net/blog/2013/isotonic-regression/" class="uri">https://fa.bianp.net/blog/2013/isotonic-regression/</a>.
</div>
<div id="ref-Zeng_Figueiredo14" class="csl-entry">
Zeng, X., and M. A. T. Figueiredo. 2014. <span>“<span class="nocase">The Ordered Weighted <img src="https://latex.codecogs.com/png.latex?%5Cell_1"> Norm: Atomic Formulation, Projections, and Algorithms</span>.”</span> <em>ArXiv e-Prints</em>.
</div>
</div>


<!-- -->

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{salmon2024,
  author = {Salmon, Joseph},
  title = {Isotonic Regression},
  date = {2024-11-10},
  url = {https://josephsalmon.eu/blog/isotonic/},
  langid = {en}
}
</code></pre></div></section></div> ]]></description>
  <category>Quadratic programming</category>
  <category>Calibration</category>
  <category>PAVA</category>
  <category>Optimization</category>
  <guid>https://josephsalmon.eu/blog/isotonic/</guid>
  <pubDate>Sat, 09 Nov 2024 23:00:00 GMT</pubDate>
  <media:content url="https://josephsalmon.eu/blog/isotonic/isotonic.png" medium="image" type="image/png" height="114" width="144"/>
</item>
<item>
  <title>LaTeX for scientific writing?</title>
  <dc:creator>Joseph Salmon</dc:creator>
  <link>https://josephsalmon.eu/blog/latex/</link>
  <description><![CDATA[ 
<div class="no-row-height column-margin column-container">
  <div class="">
    <img src="https://josephsalmon.eu/blog/latex/Tsybakov2009.svg" style="width:100%">
  </div>
</div>





<section id="history-of-latex" class="level2">
<h2 class="anchored" data-anchor-id="history-of-latex"><i class="fa-solid fa-book-open" title="an open box" aria-label="book-open"></i> History of <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"></h2>
<p>First a bit of history on <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> (pronounced “Lay-tech” or “Lah-tech”). is a typesetting system that was created by Leslie Lamport in 1984. It is based on Donald Knuth’s <img src="https://latex.codecogs.com/png.latex?%5CTeX"> typesetting system. LaTeX is widely used in academia for the communication and publication of scientific documents in many fields, including mathematics, computer science, engineering, physics, chemistry, biology, and economics. LaTeX is also used in the humanities and social sciences. LaTeX is free and open-source software. It was the prototype of the modern scientific writing, and it is still the standard in many fields, especially in mathematics and computer science as it’s a good way to write equations, and to go towards <a href="https://en.wikipedia.org/wiki/Literate_programming" target="_blank">literate programming</a>.</p>
<p>As a short motivation, I will show you two books from the same author, one written before using <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> and one after. Compare the two following images (you can click on them to enlarge):</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="Korostelev_Tsybakov93.svg" class="lightbox" data-gallery="my-gallery" title="[@Korostelev_Tsybakov93]: scientific writing before using \LaTeX"><img src="https://josephsalmon.eu/blog/latex/Korostelev_Tsybakov93.svg" class="img-fluid figure-img" width="350" alt="(Korostelëv and Tsybakov 1993): scientific writing before using \LaTeX"></a></p>
<figcaption><span class="citation" data-cites="Korostelev_Tsybakov93">(Korostelëv and Tsybakov 1993)</span>: scientific writing before using <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"></figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="Tsybakov2009.svg" class="lightbox" data-gallery="my-gallery" title="[@Tsybakov09]: scientific writing after using \LaTeX"><img src="https://josephsalmon.eu/blog/latex/Tsybakov2009.svg" class="img-fluid figure-img" width="350" alt="(Tsybakov 2009): scientific writing after using \LaTeX"></a></p>
<figcaption><span class="citation" data-cites="Tsybakov09">(Tsybakov 2009)</span>: scientific writing after using <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"></figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Conclusion: two books, same author, but very different scientific rendering.</p>
</section>
<section id="pros-for-latex" class="level2">
<h2 class="anchored" data-anchor-id="pros-for-latex"><i class="fa-solid fa-thumbs-up" title="a thumb up" aria-label="thumbs-up"></i> Pros for <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"></h2>
<p>Below I list some of the important points that make LaTeX the standard tool for scientific writing.</p>
<section id="stability-and-reusability" class="level3">
<h3 class="anchored" data-anchor-id="stability-and-reusability">Stability and reusability</h3>
<p>First, <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> guarantees stability in time. You can re-use your files from 20 years ago without any problem (and I did!). You can extract some code you used in a draft or an article, and then use it in a presentation (<code>beamer</code>), a poster, etc., by just copy pasting.</p>
<p>Moreover for large files (<em>e.g.</em>, books), when it compiles fine, it stays fine. Ok, you might suffer to reach this point though, but that’s another story.</p>
</section>
<section id="open-source-software-and-cross-platform" class="level3">
<h3 class="anchored" data-anchor-id="open-source-software-and-cross-platform">Open-source software and cross-platform</h3>
<p><img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> works fine on most operating systems (OS), for instance on</p>
<ul>
<li>Linux</li>
<li>Windows</li>
<li>MacOS</li>
</ul>
<div id="fig-os" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-os-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://josephsalmon.eu/blog/latex/Linux_logo.svg" class="img-fluid figure-img" width="150"></p>
<figcaption>Linux</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://josephsalmon.eu/blog/latex/Windows_logo.svg" class="img-fluid figure-img" width="150"></p>
<figcaption>Windows</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://josephsalmon.eu/blog/latex/MacOS_logo.svg" class="img-fluid figure-img" width="150"></p>
<figcaption>Mac OS</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-os-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> is friendly for multiple OS!
</figcaption>
</figure>
</div>
<p>Hence, you do not face the problem you might have met while opening a file from Word in Linux (it could be a nightmare, and you could loose information).</p>
</section>
<section id="default-language-in-scientific-writing" class="level3">
<h3 class="anchored" data-anchor-id="default-language-in-scientific-writing">Default language in scientific writing</h3>
<p><img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> is widely used academia, so you will find a lot of resources and support, including templates, packages, and tutorials (see for instance <a href="https://www.overleaf.com/learn/latex/Tutorials#Overleaf_LaTeX_tutorials" target="_blank">Overleaf tutorials</a>).</p>
<p>If you don’t know a command, you can try to find it with <a href="https://detexify.kirelabs.org/classify.html" target="_blank">detexify</a>: just draw the symbol you target and look for the closest output.</p>
</section>
<section id="quality-of-the-output" class="level3">
<h3 class="anchored" data-anchor-id="quality-of-the-output">Quality of the output</h3>
<p>The quality of the output produced by <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> is very high. The typesetting is very professional, and the documents look great. This is especially important for scientific writing, where you want your work to be taken seriously. Hence, publishers often ask for <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> files for the final version of the manuscript. Hence, you will produce <code>pdf</code> files thanks to <img src="https://latex.codecogs.com/png.latex?%5CLaTeX">. Alternatives formats exist but are now mostly outdated, like <code>dvi</code> files or <code>ps</code> files.</p>
</section>
<section id="collaborative-work-git-compatibility" class="level3">
<h3 class="anchored" data-anchor-id="collaborative-work-git-compatibility">Collaborative work: git compatibility</h3>
<p>For collaborating <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> is simple to use with <code>git</code>. This is not the case if you version a <code>pdf</code> or a <code>docx</code> file for instance, as they are binary files. Hence, you can use <code>git</code> to version your work, and to collaborate with others. This is especially useful if you are working on a large document with multiple authors, as it allows you to track changes, resolve conflicts, and keep everyone on the same page. Another popular alternative is to use <a href="https://www.overleaf.com/" target="_blank">Overleaf</a>, which is an online collaborative writing and publishing tool that makes it easy to work with others on a <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> document. I do not recommend this solution much as this is proprietary, and requires a good internet connection.</p>
</section>
<section id="hyperlinks-cross-references-citations-and-bibliographies" class="level3">
<h3 class="anchored" data-anchor-id="hyperlinks-cross-references-citations-and-bibliographies">Hyperlinks, cross-references, citations, and bibliographies</h3>
<p><img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> can handle hyperlinks, cross-references, citations, and bibliographies in a very efficient way. For cross-references, I recommend using the package <code>cleveref</code>, as it will simplify your life if you write a lot of equations, figures, tables, theorems, etc. Typically, this is what you will need in your Ph.D.&nbsp;or M.Sc. manuscript.</p>
<p>For bibliographies I recommend using the more modern <code>biblatex</code>, instead of <code>bibtex</code>. This prove useful if you have several bibliographies, or if you need customize a lot the way you cite your references. The Overleaf website provide a simple introduction to <a href="https://www.overleaf.com/learn/latex/Bibliography_management_with_biblatex" target="_blank">biblatex</a>.</p>
</section>
</section>
<section id="cons-for-latex" class="level2">
<h2 class="anchored" data-anchor-id="cons-for-latex"><i class="fa-solid fa-thumbs-down" title="a thumb down" aria-label="thumbs-down"></i> Cons for <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"></h2>
<p>As you have understood, <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> is a great tool for scientific writing, but it is not perfect. Here are some of the cons of using <img src="https://latex.codecogs.com/png.latex?%5CLaTeX">:</p>
<section id="steep-learning-curve" class="level3">
<h3 class="anchored" data-anchor-id="steep-learning-curve">Steep learning curve</h3>
<p>The learning curve for <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> can be steep, especially if you are not familiar with programming or markup languages. However, there are many resources available online to help you learn <img src="https://latex.codecogs.com/png.latex?%5CLaTeX">, including tutorials, forums, and books.</p>
</section>
<section id="not-wysiwyg" class="level3">
<h3 class="anchored" data-anchor-id="not-wysiwyg">Not WYSIWYG</h3>
<p><img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> is not a WYSIWYG (<strong>What You See Is What You Get</strong>) editor, which means that you have to write the code for your document and then compile it to see the final output. This can be frustrating for some people who are used to working with WYSIWYG editors like Microsoft Word. This is particularly annoying for very graphical documents, like posters, or presentations, where you might want to see the final rendering as you write. Hence for presentations, I would rather recommend using using <a href="https://quarto.org/" target="_blank">Quarto</a>, which is a markdown-based tool, that is lighter than <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> (though can use <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> for equations).</p>
<p>Such a drawback is also appearing with large documents. For instance, if you have a large document, you might have to compile it several times to get the references right, or to get the table of contents right. This can be time-consuming, especially if you have a slow computer. For instance, for a Ph.D.&nbsp;manuscript, a book or a very large <code>beamer</code> presentations, it can takes minutes to visualize the final output. It calls for compiling only a few chapters or a few slides at a time.</p>
</section>
<section id="debugging-is-hard-in-latex" class="level3">
<h3 class="anchored" data-anchor-id="debugging-is-hard-in-latex">Debugging is hard in <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"></h3>
<p>Debugging in <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> can be difficult, especially if you are not familiar with the language. Errors can be cryptic and hard to understand, and it can take some time to figure out what went wrong (enjoy the logs!). Some tools can help you debug your <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> code, including editors with built-in error checking, or <a href="https://www.charles-deledalle.fr/pages/moosetex.php" target="_blank">MooseTeX</a>.</p>
</section>
<section id="really-many-packages" class="level3">
<h3 class="anchored" data-anchor-id="really-many-packages">(Really) Many packages</h3>
<p>There are many packages available for <img src="https://latex.codecogs.com/png.latex?%5CLaTeX">. On one hand, packages can extend the functionality of <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> and make it more powerful and versatile. On the other hand, it can be difficult to find the right package for your needs, and some packages can be incompatible with others (which can be extremely hard to diagnose). Moreover, some packages are not maintained anymore, and might not work with the latest version of <img src="https://latex.codecogs.com/png.latex?%5CLaTeX">.</p>
</section>
<section id="tables-and-figures-are-not-easy-to-handle" class="level3">
<h3 class="anchored" data-anchor-id="tables-and-figures-are-not-easy-to-handle">Tables and figures are not easy to handle</h3>
<p>For tables, consider <a href="https://www.tablesgenerator.com/" target="_blank">Tables generator</a>, as modifying a <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> table could lead to horrible results. For instance, the following code will include a table in your document:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1">\begin{tabular}{lllll}</span>
<span id="cb1-2">    Col1  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> Col2  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>  ...   <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> Col4 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> Col5   \<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-3">    oih   <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> oih   <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> oih    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> oih    \<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-4">    oh    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> oih   <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> oi     <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> o    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> o</span>
<span id="cb1-5">\end{tabular}</span></code></pre></div>
<p>as follows:</p>
<div id="tbl-table" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: My first table
</figcaption>
<div aria-describedby="tbl-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Col1</th>
<th>Col2</th>
<th>…</th>
<th>Col4</th>
<th>Col5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>oih</td>
<td>oih</td>
<td>oih</td>
<td></td>
<td>oih</td>
</tr>
<tr class="even">
<td>oh</td>
<td>oih</td>
<td>oi</td>
<td>o</td>
<td>o</td>
</tr>
<tr class="odd">
<td>ooh</td>
<td>oh</td>
<td>oh</td>
<td>oho</td>
<td>oho</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Note that in Markdown (the language used to write this document), you can use the following code to include a table:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1">| Col1  | Col2  |  ...   | Col4 | Col5    |</span>
<span id="cb2-2">|-----|-----|-----|-----|-----|</span>
<span id="cb2-3">| oih | oih | oih |     | oih |</span>
<span id="cb2-4">| oh  | oih | oi  | o   | o   |</span>
<span id="cb2-5">| ooh | oh  | oh  | oho | oho |</span></code></pre></div>
<style>
  figure {
    float: right; /* Align the figure to the right of the text. Use 'left' to align it to the left */
    margin: 0 0 1em 1em; /* Add some space around the figure */
  }
    figcaption {
    text-align: center; /* Center-align the text of the figcaption */
  }
</style>
<figure class="figure">
<a href="https://inkscape.org/"> <img id="myimage" src="https://josephsalmon.eu/blog/latex/Inkscape_logo.svg" width="150" alt="Inkscape Logo" class="figure-img"> </a>
<figcaption>
Inkscape
</figcaption>
</figure>
<p>For images, that’s a long story. See for instance <a href="https://www.overleaf.com/learn/latex/Inserting_Images" target="_blank">this post</a>. Some authors recommend using <code>tikz</code> for simple figures, and <code>pgfplots</code> for plots:I don’t. You could instead use Inkscape to draw your figures, and then export as <code>pdf</code> files, and include the outputs in your <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> document. That’s what I do, and I am happy with the result. This is WYSIWYG (when you draw), and you can easily modify your figure afterwards, and version it ( <code>svg</code> is fine for versioning, while <code>pdf</code> is not). Alternative tools could be using R or Python to generate your plots, and then include them in your <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> document.</p>
</section>
</section>
<section id="whats-next" class="level2">
<h2 class="anchored" data-anchor-id="whats-next"><i class="fa-solid fa-magnifying-glass-arrow-right" title="magnifying glass over arrow right" aria-label="magnifying-glass-arrow-right"></i> What’s next?</h2>
<p>In the last few years, some alternatives to <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> have emerged, like <a href="https://en.wikipedia.org/wiki/Markdown" target="_blank">Markdown</a>, <a href="https://quarto.org/" target="_blank">Quarto</a>, or <a href="https://rmarkdown.rstudio.com/" target="_blank">RMarkdown</a>. These tools are simpler to use than <img src="https://latex.codecogs.com/png.latex?%5CLaTeX">, and they are more WYSIWYG. using I would recommend using Markdown, RMarkdown or Quarto for writing blog posts, reports, presentations or light documents with scientific content.</p>
<p>Moreover, a recent alternative to <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> is <a href="https://typst.app/" target="_blank">Typst</a>, which is a new typesetting system that is designed to be more user-friendly and easier to use than <img src="https://latex.codecogs.com/png.latex?%5CLaTeX">. Typst is still in development, but it shows promise as a modern alternative to <img src="https://latex.codecogs.com/png.latex?%5CLaTeX">.</p>
</section>
<section id="additional-resources" class="level2">
<h2 class="anchored" data-anchor-id="additional-resources"><i class="fa-solid fa-folder-open" title="open folder" aria-label="folder-open"></i> Additional resources</h2>
<ul>
<li><a href="https://guides.nyu.edu/LaTeX/bibtex" target="_blank">Getting Started with LaTeX</a> by M. Frenkel.</li>
<li><a href="https://github.com/josephsalmon/OrganizationFiles/tree/master/tex" target="_blank">Templates, tips and tools</a> by J. Salmon.</li>
</ul>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references"><i class="fa-solid fa-link" title="link" aria-label="link"></i> References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-Korostelev_Tsybakov93" class="csl-entry">
Korostelëv, A. P., and A. B. Tsybakov. 1993. <em>Minimax Theory of Image Reconstruction</em>. Vol. 82. Lecture Notes in Statistics. New York: Springer-Verlag.
</div>
<div id="ref-Tsybakov09" class="csl-entry">
Tsybakov, A. B. 2009. <em>Introduction to Nonparametric Estimation</em>. Springer Series in Statistics. New York: Springer.
</div>
</div>


<!-- -->

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{salmon2024,
  author = {Salmon, Joseph},
  title = {LaTeX for Scientific Writing?},
  date = {2024-09-05},
  url = {https://josephsalmon.eu/blog/latex/},
  langid = {en}
}
</code></pre></div></section></div> ]]></description>
  <category>Latex</category>
  <category>writing</category>
  <guid>https://josephsalmon.eu/blog/latex/</guid>
  <pubDate>Wed, 04 Sep 2024 22:00:00 GMT</pubDate>
  <media:content url="https://josephsalmon.eu/blog/latex/Tsybakov2009.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>Soft-max and Soft-argmax</title>
  <dc:creator>Joseph Salmon</dc:creator>
  <dc:creator>François-David Collin</dc:creator>
  <link>https://josephsalmon.eu/blog/softmax/</link>
  <description><![CDATA[ 
<div class="no-row-height column-margin column-container">
  <div class="">
    <img src="https://josephsalmon.eu/blog/softmax/softmax.png" style="width:100%">
  </div>
</div>





<p>The softmax function is a smooth approximation of the max function, and is used in many machine learning models. Similarly we can define the soft-argmax function, which is a smooth approximation of the argmax function.</p>
<section id="definition-and-notation" class="level2">
<h2 class="anchored" data-anchor-id="definition-and-notation"><i class="fa-solid fa-pencil-alt" title="pencil" aria-label="pencil-alt"></i> Definition and notation</h2>
<p>First, let us define <img src="https://latex.codecogs.com/png.latex?%5CDelta_%7BK%7D%20=%20%5C%7Bp%20%5Cin%20%5Cmathbb%7BR%7D%5EK%20%5Cgeq%200:%20%5Csum_%7Bk%7D%20p_k%20=%201%5C%7D"> the probability simplex in <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5EK">, and <img src="https://latex.codecogs.com/png.latex?u_K%20=%20(1/K,%20%5Cdots,%201/K)%5E%5Ctop"> the uniform distribution in <img src="https://latex.codecogs.com/png.latex?%5CDelta_%7BK%7D">, and the standard basis vectors <img src="https://latex.codecogs.com/png.latex?(%5Cdelta_k)_%7Bk=1,%5Cdots,K%7D">, where <img src="https://latex.codecogs.com/png.latex?%5Cdelta_k%20=%20(0,%5Cdots,%5Cunderbrace%7B1%7D_%7Bk-%5Crm%7Bth%7D%7D,%5Cdots,0)%5E%5Ctop%20%5Cin%20%5Cmathbb%7BR%7D%5EK">.</p>
<p>Formally, the standard <strong>soft-argmax</strong> function <img src="https://latex.codecogs.com/png.latex?%5Csigma%20%5Ccolon%20%5Cmathbb%7BR%7D%5E%7BK%7D%20%5Cto%20(0,%201)%5E%7BK%7D">, where <img src="https://latex.codecogs.com/png.latex?K%20%5Cgeq%201">, takes a vector <img src="https://latex.codecogs.com/png.latex?z%20=%20(z_%7B1%7D,%20%5Cdots,%20z_%7BK%7D)%5E%5Ctop%20%5Cin%20%5Cmathbb%7BR%7D%5E%7BK%7D"> and computes each component of the vector <img src="https://latex.codecogs.com/png.latex?%5Csigma(z)%20%5Cin%20%5B0,%201%5D%5E%7BK%7D"> by <img src="https://latex.codecogs.com/png.latex?%0A%5Cleft(%5Csigma(z)%5Cright)_k%20=%20%5Cfrac%7B%5Cexp(z_k)%7D%7B%5Csum_%7Bk'=1%7D%5E%7BK%7D%20%5Cexp(z_%7Bk'%7D)%7D%5Censpace,%20%5Cquad%20%5Ctext%7Bfor%20%7D%20k%20=%201,%20%5Cdots,%20K.%0A"></p>
<p>Note in particular that <img src="https://latex.codecogs.com/png.latex?%5Csigma(z)=%5Csigma_%7Bu_K,%201%7D(z)"> for any <img src="https://latex.codecogs.com/png.latex?z%20%5Cin%20%5Cmathbb%7BR%7D%5EK">.</p>
<p>We also define for any <img src="https://latex.codecogs.com/png.latex?q%20%5Cin%20%5CDelta_%7BK%7D"> with positive coordinates<sup>1</sup>, <em>i.e.</em>, <img src="https://latex.codecogs.com/png.latex?q_k%3E0">, for all <img src="https://latex.codecogs.com/png.latex?k%5Cin%20%5BK%5D">, the function <img src="https://latex.codecogs.com/png.latex?%5Csigma_%7Bq,%5Cbeta%7D%20%5Ccolon%20%5Cmathbb%7BR%7D%5E%7BK%7D%20%5Cto%20%5Cmathbb%7BR%7D%5EK"> as</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft(%5Csigma_%7Bq,%5Cbeta%7D(z)%5Cright)_k%20=%20%5Cfrac%7Bq_k%5Cexp(z_k/%5Cbeta)%7D%7B%5Csum_%7Bk'=1%7D%5E%7BK%7D%20q_%7Bk'%7D%5Cexp(z_%7Bk'%7D/%5Cbeta)%7D%20%5Censpace,%20%5Cquad%20%5Ctext%7Bfor%20%7D%20k%20=%201,%20%5Cdots,%20K.%0A"></p>
<p>Last but not least, we introduce the real valued log-sum-exp function (or weighted <strong>softmax</strong>), defined for any vector <img src="https://latex.codecogs.com/png.latex?z%20%5Cin%20%5Cmathbb%7BR%7D%5EK"> by</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctext%7Blogsumexp%7D_%7Bq,%5Cbeta%7D(z)%20=%20%5Cbeta%20%5Ccdot%20%5Clog%5Cleft(%5Csum_%7Bk=1%7D%5E%7BK%7D%20q_k%20%5Ccdot%20%5Cexp(z_k/%5Cbeta)%5Cright).%0A"></p>
</section>
<section id="variational-formulation" class="level2">
<h2 class="anchored" data-anchor-id="variational-formulation"><i class="fa-solid fa-wave-square" aria-label="wave-square"></i> Variational formulation</h2>
<p>In this note we show that the soft-argmax function can be written as the conjugate of the log-sum-exp function.</p>
<div id="thm-lfgn" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1</strong></span> Let <img src="https://latex.codecogs.com/png.latex?q%20%5Cin%20%5CDelta_%7BK%7D"> be with positive coordinates, <em>i.e.</em>, <img src="https://latex.codecogs.com/png.latex?q_k%3E0">, for all <img src="https://latex.codecogs.com/png.latex?k%5Cin%20%5BK%5D">, <img src="https://latex.codecogs.com/png.latex?%5Cbeta%3E0"> and let <img src="https://latex.codecogs.com/png.latex?z%20%5Cin%20%5Cmathbb%7BR%7D%5EK">. Then,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Ctext%7Blogsumexp%7D_%7Bq,%5Cbeta%7D(z)%0A&amp;%20=%0A%5Cmax_%7B%20p%20%5Cin%20%5CDelta_K%7D%20%5Clangle%20z,%20p%20%5Crangle%20-%20%5Cbeta%5Csum_%7Bk=1%7D%5E%7BK%7D%20p_k%20%5Clog(p_k%20/%20q_k)%20%5C%5C%0A%5Csigma_%7Bq,%5Cbeta%7D(z)%0A&amp;%20=%0A%5Cargmax_%7B%20p%20%5Cin%20%5CDelta_K%7D%20%5Clangle%20z,%20p%20%5Crangle%20-%20%5Cbeta%5Csum_%7Bk=1%7D%5E%7BK%7D%20p_k%20%5Clog(p_k%20/%20q_k)%5Censpace.%0A%5Cend%7Balign*%7D%0A"></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Using Lagrange multipliers <span class="citation" data-cites="Boyd_Vandenberghe04">(see for instance Ch. 5, Boyd and Vandenberghe 2004)</span> you get for <img src="https://latex.codecogs.com/png.latex?%5CLambda=(%5Clambda_1,%5Cdots,%5Clambda_K)%5E%5Ctop">, <img src="https://latex.codecogs.com/png.latex?%5Cmu%20%5Cin%20%5Cmathbb%7BR%7D"> and <img src="https://latex.codecogs.com/png.latex?p%20%5Cin%20%5CDelta_K"> the Lagrangian function:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathcal%7BL%7D(p,%5Cmu,%5CLambda)%20=%20%5Clangle%20z,%20p%20%5Crangle%20-%20%5Cbeta%5Csum_%7Bk=1%7D%5E%7BK%7D%20p_k%20%5Clog(p_k%20/%20q_k)%20+%20%5Cmu%5Cleft(%5Csum_%7Bk=1%7D%5E%7BK%7D%20p_k%20-%201%5Cright)%20-%20%5Csum_%7Bk=1%7D%5E%7BK%7D%20%5Clambda_k%20p_k.%0A"></p>
<p>The Slater condition is satisfied, so the KKT conditions are necessary and sufficient for optimality. The KKT conditions are <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20p_k%7D%20&amp;=%20z_k%20-%20%5Cbeta%5Clog(p_k%20/%20q_k)%20-%20%5Cbeta%20-%20%5Cmu%20-%20%5Clambda_k%20=%200,%20%5Cquad%20k%20=%201,%20%5Cdots,%20K,%5C%5C%0A%5Cmu%5Cleft(%5Csum_%7Bk=1%7D%5E%7BK%7D%20p_k%20-%201%5Cright)%20&amp;=%200,%5C%5C%0A%5Clambda_k%20p_k%20&amp;=%200,%20%5Cquad%20k%20=%201,%20%5Cdots,%20K,%5C%5C%0Ap_k%20&amp;%5Cgeq%200,%20%5Cquad%20k%20=%201,%20%5Cdots,%20K.%0A%5Cend%7Balign*%7D%0A"> From the first KKT condition we get <img src="https://latex.codecogs.com/png.latex?%0Ap_k%20=%20q_k%5Cexp%5Cleft(%5Cfrac%7Bz_k-%5Cbeta-%5Cmu-%5Clambda_k%7D%7B%5Cbeta%7D%5Cright),%20%5Cquad%20k%20=%201,%20%5Cdots,%20K.%0A"> Now, since <img src="https://latex.codecogs.com/png.latex?%5Clambda_k%20p_k%20=%200"> and that <img src="https://latex.codecogs.com/png.latex?q_k%3E0"> for all <img src="https://latex.codecogs.com/png.latex?k">, we have that <img src="https://latex.codecogs.com/png.latex?%5Clambda_k%20=%200"> for all <img src="https://latex.codecogs.com/png.latex?k">. Thus, we get after normalisation that <img src="https://latex.codecogs.com/png.latex?%0Ap_k%20=%20%5Cfrac%7Bq_k%5Cexp(z_k/%5Cbeta)%7D%7B%5Csum_%7Bk'=1%7D%5E%7BK%7D%20q_%7Bk'%7D%5Cexp(z_%7Bk'%7D/%5Cbeta)%7D,%20%5Cquad%20k%20=%201,%20%5Cdots,%20K.%0A"> Note that <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A&amp;%20p_k%20=%20%5Cfrac%7Bq_k%5Cexp(z_k/%5Cbeta)%7D%7B%5Csum_%7Bk'=1%7D%5E%7BK%7D%20q_%7Bk'%7D%5Cexp(z_%7Bk'%7D/%5Cbeta)%7D%5C%5C%0A%5Ciff%20&amp;%20%5Clog(%20p_k)%20=%20%5Clog(q_k)%20+%20%5Cfrac%7Bz_k%7D%7B%5Cbeta%7D%20-%20%5Cfrac%7B1%7D%7B%5Cbeta%7D%20%5Ccdot%20%20%5Ctext%7Blogsumexp%7D_%7Bq,%5Cbeta%7D(z).%0A%5Cend%7Balign*%7D%0A"> Finally, we have that <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cbeta%5Csum_%7Bk=1%7D%5E%7BK%7D%20p_k%20%5Clog(p_k%20/%20q_k)%20&amp;=%20%5Cbeta%5Csum_%7Bk=1%7D%5E%7BK%7D%20p_k%20%5Cleft(%5Cfrac%7Bz_k%7D%7B%5Cbeta%7D%20-%20%5Cfrac%7B1%7D%7B%5Cbeta%7D%20%5Ccdot%20%5Ctext%7Blogsumexp%7D_%7Bq,%5Cbeta%7D(z)%5Cright)%5C%5C%0A&amp;=%20%5Csum_%7Bk=1%7D%5E%7BK%7D%20p_k%20z_k%20-%20%5Ctext%7Blogsumexp%7D_%7Bq,%5Cbeta%7D(z),%0A%5Cend%7Balign*%7D%0A"> Hence, <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bk=1%7D%5E%7BK%7D%20p_k%20z_k%20-%20%5Cbeta%20%5Csum_%7Bk=1%7D%5E%7BK%7D%20p_k%20%5Clog(p_k%20/%20q_k)%20=%20%5Ctext%7Blogsumexp%7D_%7Bq,%5Cbeta%7D(z)">.</p>
</div>
<p>The following limit properties for infinitesimal <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> explain the naming and the regularizing property of the (temperature) parameter <img src="https://latex.codecogs.com/png.latex?%5Cbeta">:</p>
<div id="prp-soft" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 1</strong></span> Reminding that <img src="https://latex.codecogs.com/png.latex?u_K=(1/K,%5Cdots,1/K)%5E%5Ctop"> and <img src="https://latex.codecogs.com/png.latex?%5Cdelta_%7Bk%7D"> is the <img src="https://latex.codecogs.com/png.latex?k">-th standard basis vector, for any <img src="https://latex.codecogs.com/png.latex?z%20%5Cin%20%5Cmathbb%7BR%7D%5EK">, we have that</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Csigma_%7Bu_K,%5Cbeta%7D(z)%20&amp;%20%5Cxrightarrow%5B%5Cbeta%20%5Cto%200%5D%7B%7D%20%20%5Cdelta_%7Bk_0%7D,%20%5Ctext%7B%20where%20%7D%20k_0=%5Cargmax_%7Bk%5Cin%20%5BK%5D%7D%20z_k%20%5C%5C%0A%5Ctext%7Blogsumexp%7D_%7Bu_K,%5Cbeta%7D(z)%20&amp;%20%5Cxrightarrow%5B%5Cbeta%20%5Cto%200%5D%7B%7D%20%5Cmax_%7Bk%5Cin%20%5BK%5D%7D%20z_k%20%5Censpace.%0A%5Cend%7Balign*%7D%0A"></p>
</div>
<p>The first limit show that the soft-argmax function is a kind of smooth approximation of the argmax function, while the log-sum-exp function is a smooth approximation of the max function.</p>
</section>
<section id="invariance-properties" class="level2">
<h2 class="anchored" data-anchor-id="invariance-properties"><i class="fa-solid fa-sync-alt" aria-label="sync-alt"></i> Invariance properties</h2>
<p>The softmax function is invariant to the addition of a constant to each component of the input vector. More precisely, we have the following result:</p>
<div id="thm-invariance" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2</strong></span> Let <img src="https://latex.codecogs.com/png.latex?q%20%5Cin%20%5CDelta_%7BK%7D"> be with positive coordinates, <em>i.e.</em>, <img src="https://latex.codecogs.com/png.latex?q_k%3E0">, for all <img src="https://latex.codecogs.com/png.latex?k%5Cin%20%5BK%5D">, <img src="https://latex.codecogs.com/png.latex?%5Cbeta%3E0"> and let <img src="https://latex.codecogs.com/png.latex?z%20%5Cin%20%5Cmathbb%7BR%7D%5EK">. Then, for any <img src="https://latex.codecogs.com/png.latex?c%20%5Cin%20%5Cmathbb%7BR%7D">, we have that <img src="https://latex.codecogs.com/png.latex?%0A%5Csigma_%7Bq,%5Cbeta%7D(z)%20=%20%5Csigma_%7Bq,%5Cbeta%7D(z+c).%0A"></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>We have that <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Csigma_%7Bq,%5Cbeta%7D(z+c)_k%20&amp;=%20%5Cfrac%7Bq_k%5Cexp((z_k+c)/%5Cbeta)%7D%7B%5Csum_%7Bk'=1%7D%5E%7BK%7D%20q_%7Bk'%7D%5Cexp((z_%7Bk'%7D+c)/%5Cbeta)%7D%5C%5C%0A&amp;=%20%5Cfrac%7Bq_k%5Cexp(z_k/%5Cbeta)%5Cexp(c/%5Cbeta)%7D%7B%5Csum_%7Bk'=1%7D%5E%7BK%7D%20q_%7Bk'%7D%5Cexp(z_%7Bk'%7D/%5Cbeta)%5Cexp(c/%5Cbeta)%7D%5C%5C%0A&amp;=%20%5Cfrac%7Bq_k%5Cexp(z_k/%5Cbeta)%7D%7B%5Csum_%7Bk'=1%7D%5E%7BK%7D%20q_%7Bk'%7D%5Cexp(z_%7Bk'%7D/%5Cbeta)%7D%5C%5C%0A&amp;=%20%5Csigma_%7Bq,%5Cbeta%7D(z)_k.%0A%5Cend%7Balign*%7D%0A"></p>
</div>
<p>Let us consider also the effect of rescaling the input vector by a positive constant. We have the following result:</p>
<div id="thm-rescaling" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3</strong></span> Let <img src="https://latex.codecogs.com/png.latex?q%20%5Cin%20%5CDelta_%7BK%7D"> be with positive coordinates, <em>i.e.</em>, <img src="https://latex.codecogs.com/png.latex?q_k%3E0">, for all <img src="https://latex.codecogs.com/png.latex?k%5Cin%20%5BK%5D">, <img src="https://latex.codecogs.com/png.latex?%5Cbeta%3E0"> and let <img src="https://latex.codecogs.com/png.latex?z%20%5Cin%20%5Cmathbb%7BR%7D%5EK">. Then, for any <img src="https://latex.codecogs.com/png.latex?%5Calpha%20%3E0">, we have that <img src="https://latex.codecogs.com/png.latex?%0A%5Csigma_%7Bq,%5Cbeta%7D(%5Calpha%20z)%20=%20%5Csigma_%7Bq,%5Ctfrac%7B%5Cbeta%7D%7B%5Calpha%7D%7D(z).%0A"></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>We have that <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cleft(%5Csigma_%7Bq,%5Cbeta%7D(%5Calpha%20z)%5Cright)_k%20&amp;=%20%5Cfrac%7Bq_k%5Cexp(%5Calpha%20z_k/%5Cbeta)%7D%7B%5Csum_%7Bk'=1%7D%5E%7BK%7D%20q_%7Bk'%7D%5Cexp(%5Calpha%20z_%7Bk'%7D/%5Cbeta)%7D%5C%5C%0A&amp;=%20%5Cfrac%7Bq_k%5Cexp(z_k/%5Cfrac%7B%5Cbeta%7D%7B%5Calpha%7D)%7D%7B%5Csum_%7Bk'=1%7D%5E%7BK%7D%20q_%7Bk'%7D%5Cexp(z_%7Bk'%7D/%5Cfrac%7B%5Cbeta%7D%7B%5Calpha%7D)%7D%5C%5C%0A&amp;=%20%5Cleft(%5Csigma_%7Bq,%5Ctfrac%7B%5Cbeta%7D%7B%5Calpha%7D%7D(z)%5Cright)_k.%0A%5Cend%7Balign*%7D%0A"></p>
</div>
</section>
<section id="visualization" class="level2">
<h2 class="anchored" data-anchor-id="visualization"><i class="fa-solid fa-sliders" aria-label="sliders"></i> Visualization</h2>
<p>We consider the case <img src="https://latex.codecogs.com/png.latex?K=3"> for visualization. <!-- color a word in purple with html in the following sentence--></p>
<p>You can click on the plot to move <img src="https://latex.codecogs.com/png.latex?z"> <span style="color: purple;">(the purple dot)</span>, and see the corresponding soft-argmax <img src="https://latex.codecogs.com/png.latex?%5Csigma_%7Bq,%5Cbeta%7D"> <span style="color: red;">(the red dot)</span>. You can modify <img src="https://latex.codecogs.com/png.latex?q"> (the black dot) and <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> with the slider. The level sets displayed are for the function after the max in the log-sum-exp definition, <em>i.e.</em>, for a fixed <img src="https://latex.codecogs.com/png.latex?z%5Cin%20%5Cmathbb%7BR%7D%5E3">, <img src="https://latex.codecogs.com/png.latex?q%5Cin%20%5CDelta_K"> and <img src="https://latex.codecogs.com/png.latex?%5Cbeta%3E0">, the level set is the set of points <img src="https://latex.codecogs.com/png.latex?p%5Cin%20%5CDelta_K"> such that <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5CDelta_K%20&amp;%5Cto%20%5Cmathbb%7BR%7D%20%5C%5C%0Ap%20&amp;%20%5Cmapsto%20%5Clangle%20z,%20p%20%5Crangle%20-%20%5Cbeta%5Csum_%7Bk=1%7D%5E%7BK%7D%20p_k%20%5Clog(p_k%20/%20q_k)%0A%5Cend%7Balign*%7D%0A"></p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" data-startfrom="218" data-source-offset="-1" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 217;"><span id="cb1-218">d3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">require</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"d3@v6"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"d3-hexbin@0.2"</span>)</span>
<span id="cb1-219">math <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">require</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mathjs"</span>)</span>
<span id="cb1-220">digamma <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">require</span>( <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-digamma@umd/browser.js'</span> )</span>
<span id="cb1-221"></span>
<span id="cb1-222"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> {legend} <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@d3/color-legend"</span></span>
<span id="cb1-223"></span>
<span id="cb1-224"></span>
<span id="cb1-225">densityResolution <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb1-226">margin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ({ <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">left</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">top</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">right</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bottom</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span> })</span>
<span id="cb1-227">height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span></span>
<span id="cb1-228"></span>
<span id="cb1-229"></span>
<span id="cb1-230"></span>
<span id="cb1-231">beta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [inputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beta</span>]</span>
<span id="cb1-232"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// lbd = [0.3,0.3,0.4]</span></span>
<span id="cb1-233"></span>
<span id="cb1-234">viewof q1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Inputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">value</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">label</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tex</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`q_1`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">step</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>})</span>
<span id="cb1-235">viewof q2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Inputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">value</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">label</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tex</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`q_2`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">step</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>})</span>
<span id="cb1-236">viewof q3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Inputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">value</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">label</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tex</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`q_3`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">step</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>})</span>
<span id="cb1-237">viewof z1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Inputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>([<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">value</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">label</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tex</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`z_1`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">step</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>})</span>
<span id="cb1-238">viewof z2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Inputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>([<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">value</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">label</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tex</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`z_2`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">step</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>})</span>
<span id="cb1-239">viewof z3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Inputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>([<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">value</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">label</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tex</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`z_3`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">step</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>})</span>
<span id="cb1-240"></span>
<span id="cb1-241"></span>
<span id="cb1-242">viewof inputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Inputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">form</span>({</span>
<span id="cb1-243">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">z1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> viewof z1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-244">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">z2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> viewof z2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-245">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">z3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> viewof z3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-246">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">beta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> Inputs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">value</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">label</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tex</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\b</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">eta`</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">step</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>})<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-247">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">q1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> viewof q1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-248">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">q2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> viewof q2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-249">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">q3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> viewof q3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-250">})</span>
<span id="cb1-251"></span>
<span id="cb1-252">q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [q1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> q2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> q3]</span>
<span id="cb1-253">z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [z1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> z2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> z3]</span>
<span id="cb1-254"></span>
<span id="cb1-255">logsumexp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> beta) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> {</span>
<span id="cb1-256">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-257">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>) result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> alpha[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(x[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> beta)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-258">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> beta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(result)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-259">}</span>
<span id="cb1-260"></span>
<span id="cb1-261"></span>
<span id="cb1-262">objective <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> beta) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> {</span>
<span id="cb1-263">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-264">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>) result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> beta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(x[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> alpha[i])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-265">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>) result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> x[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> z[i]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-266">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> result<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-267">}</span>
<span id="cb1-268"></span>
<span id="cb1-269"></span>
<span id="cb1-270">kull_leibler <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> beta) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> {</span>
<span id="cb1-271">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-272">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>) result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> x[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(x[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> alpha[i])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-273">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> beta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> result<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-274">}</span>
<span id="cb1-275"></span>
<span id="cb1-276"></span>
<span id="cb1-277">softmax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> beta) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> {</span>
<span id="cb1-278">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-279">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> sum <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-280">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>) {</span>
<span id="cb1-281">    result<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">push</span>(alpha[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(x[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> beta))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-282">    sum <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> result[i]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-283">  }</span>
<span id="cb1-284">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>) result[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/=</span> sum<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-285">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> result<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-286">}</span>
<span id="cb1-287"></span>
<span id="cb1-288"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cartesianToBarycentric</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> corners) {</span>
<span id="cb1-289">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> C <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-290">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> v0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> { <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y</span> }<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-291">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> v1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> { <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y</span> }<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-292">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> v2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> { <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y</span> }<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-293"></span>
<span id="cb1-294">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> d00 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dot</span>(v0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> v0)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-295">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> d01 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dot</span>(v0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> v1)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-296">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> d11 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dot</span>(v1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> v1)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-297">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> d20 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dot</span>(v2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> v0)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-298">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> d21 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dot</span>(v2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> v1)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-299">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> denom <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d00 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> d11 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> d01 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> d01<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-300"></span>
<span id="cb1-301">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> lambda1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (d11 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> d20 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> d01 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> d21) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> denom<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-302">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> lambda2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (d00 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> d21 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> d01 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> d20) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> denom<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-303">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> lambda3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> lambda1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> lambda2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-304"></span>
<span id="cb1-305">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> [lambda1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> lambda2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> lambda3]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-306">}</span>
<span id="cb1-307"></span>
<span id="cb1-308"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">barycentricToCartesian</span>(q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> corners) {</span>
<span id="cb1-309">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> [</span>
<span id="cb1-310">    corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-311">    corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb1-312">  ]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-313">}</span>
<span id="cb1-314"></span>
<span id="cb1-315"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dot</span>(v1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> v2) {</span>
<span id="cb1-316">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> v1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> v2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> v1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> v2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-317">}</span>
<span id="cb1-318"></span>
<span id="cb1-319">ternaryDensity <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> resolution<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> lbd) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> {</span>
<span id="cb1-320">  options <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Object</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">assign</span>({</span>
<span id="cb1-321">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-322">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">margin</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> { <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">left</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">top</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">right</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bottom</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span> }<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-323">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">colorScheme</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> d3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">interpolateBlues</span></span>
<span id="cb1-324">  }<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> options)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-325"></span>
<span id="cb1-326"></span>
<span id="cb1-327">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> fillScale <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scaleSequential</span>(options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colorScheme</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">domain</span>([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb1-328">  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]))])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-329">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// const fillScale = d3.scaleSequential(options.colorScheme).domain(d3.extent(density.map(d =&gt; d.density)))</span></span>
<span id="cb1-330"></span>
<span id="cb1-331">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> svg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"svg"</span>)</span>
<span id="cb1-332">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"width"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size</span>)</span>
<span id="cb1-333">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"height"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-334"></span>
<span id="cb1-335">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scaleLinear</span>()</span>
<span id="cb1-336">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">domain</span>([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb1-337">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>([options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">left</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">right</span>])</span>
<span id="cb1-338"></span>
<span id="cb1-339">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scaleLinear</span>()</span>
<span id="cb1-340">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">domain</span>([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb1-341">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>([options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bottom</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">top</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-342"></span>
<span id="cb1-343"></span>
<span id="cb1-344">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inverseScaleX</span>(value) {</span>
<span id="cb1-345">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Constants from the original scale</span></span>
<span id="cb1-346">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> domainMin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-347">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> domainMax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-348">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> rangeMin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">left</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-349">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> rangeMax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">right</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-350"></span>
<span id="cb1-351">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Calculate the proportion of the input value within the range</span></span>
<span id="cb1-352">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> proportion <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (value <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> rangeMin) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (rangeMax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> rangeMin)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-353"></span>
<span id="cb1-354">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Apply the proportion to the domain</span></span>
<span id="cb1-355">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> proportion <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (domainMax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> domainMin) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> domainMin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-356">  }</span>
<span id="cb1-357"></span>
<span id="cb1-358">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inverseInverseScaleX</span>(value) {</span>
<span id="cb1-359">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Constants from the original scale</span></span>
<span id="cb1-360">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> domainMin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-361">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> domainMax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-362">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> rangeMin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">right</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-363">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> rangeMax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">left</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-364"></span>
<span id="cb1-365">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Calculate the proportion of the input value within the range</span></span>
<span id="cb1-366">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> proportion <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (rangeMax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> rangeMin)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-367"></span>
<span id="cb1-368">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Apply the proportion to the domain</span></span>
<span id="cb1-369">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> rangeMax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> proportion <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> value <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-370">  }</span>
<span id="cb1-371"></span>
<span id="cb1-372">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inverseScaleY</span>(value) {</span>
<span id="cb1-373">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Constants from the original scale</span></span>
<span id="cb1-374">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> domainMin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-375">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> domainMax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-376">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> rangeMin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bottom</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-377">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> rangeMax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">top</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-378"></span>
<span id="cb1-379">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Calculate the proportion of the input value within the range</span></span>
<span id="cb1-380">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> proportion <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (value <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> rangeMin) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (rangeMax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> rangeMin)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-381"></span>
<span id="cb1-382"></span>
<span id="cb1-383">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Apply the proportion to the domain</span></span>
<span id="cb1-384">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> proportion <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (domainMax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> domainMin) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> domainMin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-385">  }</span>
<span id="cb1-386"></span>
<span id="cb1-387">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inverseInverseScaleY</span>(value) {</span>
<span id="cb1-388">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Constants from the original scale</span></span>
<span id="cb1-389">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> domainMin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-390">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> domainMax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-391">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> rangeMin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bottom</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-392">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> rangeMax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">top</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-393"></span>
<span id="cb1-394">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Calculate the proportion of the input value within the range</span></span>
<span id="cb1-395">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> proportion <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (rangeMax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> rangeMin)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-396"></span>
<span id="cb1-397">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Apply the proportion to the domain</span></span>
<span id="cb1-398">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> proportion <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> value <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> rangeMin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-399">  }</span>
<span id="cb1-400"></span>
<span id="cb1-401"></span>
<span id="cb1-402"></span>
<span id="cb1-403">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> axisBottom <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> g <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> g<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">call</span>(d3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">axisBottom</span>(x)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ticks</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb1-404">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> axisTop <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> g <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> g<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">call</span>(d3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">axisTop</span>(x)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ticks</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-405"></span>
<span id="cb1-406">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> hexagonSize <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ((<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">x</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> resolution)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">x</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">PI</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-407"></span>
<span id="cb1-408">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> corners <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [{ <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> }<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> { <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> }<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> }]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-409">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> corners_expanded <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [{ <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span> }<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> { <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span> }<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span> }]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-410"></span>
<span id="cb1-411">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> line <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">line</span>()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">x</span>(d <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">x</span>(d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span>(d <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span>(d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-412"></span>
<span id="cb1-413">  svg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">append</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'defs'</span>)</span>
<span id="cb1-414">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">append</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'clipPath'</span>)</span>
<span id="cb1-415">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'id'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'triangle'</span>)</span>
<span id="cb1-416">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">append</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'path'</span>)</span>
<span id="cb1-417">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-418">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-419">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'d'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">line</span>(corners))</span>
<span id="cb1-420"></span>
<span id="cb1-421">  svg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">selectAll</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'.border'</span>)</span>
<span id="cb1-422">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>([[corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-423">           [corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-424">           [corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]]])</span>
<span id="cb1-425">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">enter</span>()</span>
<span id="cb1-426">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">append</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'line'</span>)</span>
<span id="cb1-427">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x1'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> (d) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">x</span>(d[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span>))</span>
<span id="cb1-428">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x2'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> (d) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">x</span>(d[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span>))</span>
<span id="cb1-429">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y1'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> (d) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span>(d[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y</span>))</span>
<span id="cb1-430">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y2'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> (d) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span>(d[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y</span>))</span>
<span id="cb1-431">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'border'</span>)</span>
<span id="cb1-432">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'stroke'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-433"></span>
<span id="cb1-434">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> hexbin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hexbin</span>()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-435"></span>
<span id="cb1-436">  svg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">append</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'g'</span>)</span>
<span id="cb1-437">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'clip-path'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'url(#triangle)'</span>)</span>
<span id="cb1-438">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">selectAll</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".point"</span>)</span>
<span id="cb1-439">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(density)</span>
<span id="cb1-440">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'path'</span>)</span>
<span id="cb1-441">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'transform'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> d <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`translate(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">x</span>(corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span>(corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> corners[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">)`</span>)</span>
<span id="cb1-442">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'fill'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> d <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fillScale</span>(d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">density</span>))</span>
<span id="cb1-443">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'d'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> hexbin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hexagon</span>(hexagonSize))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-444"></span>
<span id="cb1-445">  svg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">selectAll</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span>)</span>
<span id="cb1-446">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>([[corners_expanded[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> corners_expanded[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-447">           [corners_expanded[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> corners_expanded[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb1-448">           [corners_expanded[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> corners_expanded[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]]])</span>
<span id="cb1-449">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>)</span>
<span id="cb1-450">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text-anchor"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"middle"</span>)</span>
<span id="cb1-451">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"alignment-baseline"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"middle"</span>)</span>
<span id="cb1-452">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"font-style"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"italic"</span>)</span>
<span id="cb1-453">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> d <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">x</span>(d[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">x</span>(d[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x</span>)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-454">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> d <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span>(d[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span>(d[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y</span>)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-455">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span>((d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> i) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> {</span>
<span id="cb1-456">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x₂"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-457">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x₃"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-458">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x₁"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-459">    })</span>
<span id="cb1-460"></span>
<span id="cb1-461">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> xy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">barycentricToCartesian</span>(z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> corners)</span>
<span id="cb1-462">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> xyr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inverseInverseScaleX</span>(xy[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inverseInverseScaleY</span>(xy[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-463"></span>
<span id="cb1-464">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> xy_q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">barycentricToCartesian</span>(q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> corners)</span>
<span id="cb1-465">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> xyr_q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inverseInverseScaleX</span>(xy_q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inverseInverseScaleY</span>(xy_q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-466"></span>
<span id="cb1-467">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> sftmax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">softmax</span>([z1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> z2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> z3]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> beta)</span>
<span id="cb1-468">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> xy_s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">barycentricToCartesian</span>(sftmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> corners)</span>
<span id="cb1-469">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> xyr_s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inverseInverseScaleX</span>(xy_s[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inverseInverseScaleY</span>(xy_s[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-470"></span>
<span id="cb1-471">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// If it does not exist, append a new red circle</span></span>
<span id="cb1-472">    svg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">append</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"circle"</span>)</span>
<span id="cb1-473">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"class"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red-circle"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Add a class for easy selection</span></span>
<span id="cb1-474">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cx"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> xyr_s[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb1-475">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cy"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> xyr_s[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb1-476">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"z-index"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>)</span>
<span id="cb1-477">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"r"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Radius of the circle</span></span>
<span id="cb1-478">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fill"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Fill color of the circle</span></span>
<span id="cb1-479"></span>
<span id="cb1-480">    svg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">append</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"circle"</span>)</span>
<span id="cb1-481">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"class"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"purple-circle"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Add a class for easy selection</span></span>
<span id="cb1-482">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cx"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> xyr[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb1-483">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cy"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> xyr[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb1-484">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"z-index"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>)</span>
<span id="cb1-485">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"r"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Radius of the circle</span></span>
<span id="cb1-486">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fill"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"purple"</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Fill color of the circle</span></span>
<span id="cb1-487"></span>
<span id="cb1-488"></span>
<span id="cb1-489">    svg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">append</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"circle"</span>)</span>
<span id="cb1-490">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"class"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black-circle"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Add a class for easy selection</span></span>
<span id="cb1-491">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cx"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> xyr_q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb1-492">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cy"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> xyr_q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb1-493">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"z-index"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>)</span>
<span id="cb1-494">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"r"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Radius of the circle</span></span>
<span id="cb1-495">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fill"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Fill color of the circle</span></span>
<span id="cb1-496"></span>
<span id="cb1-497"></span>
<span id="cb1-498">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Append text for the coordinates</span></span>
<span id="cb1-499">    svg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">append</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>)</span>
<span id="cb1-500">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"class"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"coord-text"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Add a class for easy selection</span></span>
<span id="cb1-501">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// .attr("x", xyr[0] + 10) // Position the text right next to the circle</span></span>
<span id="cb1-502">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// .attr("y", xyr[1])</span></span>
<span id="cb1-503">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Position the text right next to the circle</span></span>
<span id="cb1-504">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>)</span>
<span id="cb1-505">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fill"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Text color</span></span>
<span id="cb1-506">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">style</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"font-size"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10px"</span>)</span>
<span id="cb1-507">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span>(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`q=(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span>q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toFixed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span>q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toFixed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span>q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toFixed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">)`</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Display coordinates</span></span>
<span id="cb1-508">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Append color legend for purple-circle and red-circle:</span></span>
<span id="cb1-509"></span>
<span id="cb1-510"></span>
<span id="cb1-511">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Append text for the coordinates</span></span>
<span id="cb1-512">    svg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">append</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>)</span>
<span id="cb1-513">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"class"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"coord-text"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Add a class for easy selection</span></span>
<span id="cb1-514">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// .attr("x", xyr[0] + 10) // Position the text right next to the circle</span></span>
<span id="cb1-515">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// .attr("y", xyr[1])</span></span>
<span id="cb1-516">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Position the text right next to the circle</span></span>
<span id="cb1-517">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb1-518">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fill"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Text color</span></span>
<span id="cb1-519">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">style</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"font-size"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10px"</span>)</span>
<span id="cb1-520">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span>(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`σ_{q,β}=(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span>sftmax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toFixed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span>sftmax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toFixed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span>sftmax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toFixed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">)`</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Display coordinates</span></span>
<span id="cb1-521">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Append color legend for purple-circle and red-circle:</span></span>
<span id="cb1-522"></span>
<span id="cb1-523">    svg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">append</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>)</span>
<span id="cb1-524">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"class"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"coord-text"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Add a class for easy selection</span></span>
<span id="cb1-525">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Position the text right next to the circle</span></span>
<span id="cb1-526">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">120</span>)</span>
<span id="cb1-527">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fill"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"purple"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Text color</span></span>
<span id="cb1-528">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">style</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"font-size"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10px"</span>)</span>
<span id="cb1-529">      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span>(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`z=(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span>z1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toFixed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span>z2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toFixed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span>z3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toFixed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">)`</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Display coordinates</span></span>
<span id="cb1-530"></span>
<span id="cb1-531"></span>
<span id="cb1-532">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> removeLine <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> g <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> g<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".domain"</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">remove</span>()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-533"></span>
<span id="cb1-534"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">set</span>(input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> value) {</span>
<span id="cb1-535">  input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> value<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-536">  input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dispatchEvent</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">new</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Event</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"input"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> {<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bubbles</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">true</span>}))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-537">}</span>
<span id="cb1-538"></span>
<span id="cb1-539"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Attach a click event listener to the SVG</span></span>
<span id="cb1-540">svg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">on</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"click"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">event</span>) {</span>
<span id="cb1-541">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Extract the click coordinates</span></span>
<span id="cb1-542">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> [clickX<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> clickY] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pointer</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">event</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-543">  lbd <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cartesianToBarycentric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inverseScaleX</span>(clickX)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inverseScaleY</span>(clickY)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> corners)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-544"></span>
<span id="cb1-545">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">set</span>(viewof z1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> lbd[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-546">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">set</span>(viewof z2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> lbd[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-547">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">set</span>(viewof z3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> lbd[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-548">})<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-549"></span>
<span id="cb1-550"> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// display axis values</span></span>
<span id="cb1-551">svg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">append</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"g"</span>)</span>
<span id="cb1-552">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transform"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`translate(0, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span>options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bottom</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">)`</span>)</span>
<span id="cb1-553">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">call</span>(axisBottom)</span>
<span id="cb1-554">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">call</span>(removeLine)</span>
<span id="cb1-555"></span>
<span id="cb1-556">  svg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">append</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"g"</span>)</span>
<span id="cb1-557">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transform"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`translate(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">x</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">right</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">26</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">) rotate(-120)`</span>)</span>
<span id="cb1-558">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">call</span>(axisBottom)</span>
<span id="cb1-559">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">call</span>(removeLine)</span>
<span id="cb1-560">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">call</span>(g <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> g<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">selectAll</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transform"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"translate(11, 22) rotate(120)"</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-561"></span>
<span id="cb1-562">  svg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">append</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"g"</span>)</span>
<span id="cb1-563">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transform"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">`translate(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">x</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">left</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">${</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">y</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">26</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">) rotate(120)`</span>)</span>
<span id="cb1-564">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">call</span>(axisBottom)</span>
<span id="cb1-565">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">call</span>(removeLine)</span>
<span id="cb1-566">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">call</span>(g <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">=&gt;</span> g<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">selectAll</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transform"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"translate(-11, 22) rotate(-120)"</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-567"></span>
<span id="cb1-568">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> svg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">node</span>()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-569">}</span>
<span id="cb1-570"></span>
<span id="cb1-571"></span>
<span id="cb1-572">levelLogsumexp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb1-573">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> density <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-574">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> densityResolution<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>) {</span>
<span id="cb1-575">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> densityResolution <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>) {</span>
<span id="cb1-576">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> densityResolution <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-577">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> x2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> densityResolution<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-578">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> x3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x2)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-579">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [ x1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> x2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> x3 ]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-580"></span>
<span id="cb1-581">      density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">push</span>({ x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">density</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">logsumexp</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> beta) })<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-582">    }</span>
<span id="cb1-583">  }</span>
<span id="cb1-584">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-585">}</span>
<span id="cb1-586"></span>
<span id="cb1-587">levelKL <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb1-588">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> density <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-589">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> densityResolution<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>) {</span>
<span id="cb1-590">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> densityResolution <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>) {</span>
<span id="cb1-591">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> densityResolution <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-592">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> x2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> densityResolution<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-593">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> x3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x2)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-594">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [ x1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> x2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> x3 ]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-595"></span>
<span id="cb1-596">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// density.push({ x, density: logsumexp(x, q, beta) / Math.log(Math.max(q[0],q[1], q[2]) * Math.exp(1/beta)) });</span></span>
<span id="cb1-597">      density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">push</span>({ x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">density</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kull_leibler</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> beta) })<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-598">    }</span>
<span id="cb1-599">  }</span>
<span id="cb1-600">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-601">}</span>
<span id="cb1-602"></span>
<span id="cb1-603"></span>
<span id="cb1-604">levelKL_full <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb1-605">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> density <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-606">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> densityResolution<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>) {</span>
<span id="cb1-607">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">let</span> j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> densityResolution <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>) {</span>
<span id="cb1-608">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> densityResolution <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-609">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> x2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> densityResolution<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-610">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> x3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Math</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x2)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-611">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">const</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [ x1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> x2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> x3 ]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-612"></span>
<span id="cb1-613">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// density.push({ x, density: logsumexp(x, q, beta) / Math.log(Math.max(q[0],q[1], q[2]) * Math.exp(1/beta)) });</span></span>
<span id="cb1-614">      density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">push</span>({ x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">density</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">objective</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> beta) })<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-615">    }</span>
<span id="cb1-616">  }</span>
<span id="cb1-617">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-618">}</span>
<span id="cb1-619"></span>
<span id="cb1-620"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ternaryDensity</span>(levelKL_full<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> densityResolution<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> { <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">size</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">colorScheme</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> d3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">interpolateBlues</span>})</span>
<span id="cb1-621">logsumexpColorScale <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">legend</span>({<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">color</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> d3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scaleSequential</span>(d3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extent</span>([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">logsumexp</span>(z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> beta)])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> d3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">interpolateBlues</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">title</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Intensity"</span>})</span></code></pre></div>
</details>
<div class="cell quarto-layout-panel" data-layout-ncol="1" data-layout-align="left">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-14" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-16" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-17" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-18" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-19" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-20" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-21" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-22" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-23" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-24" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-25" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-26" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-27" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-28" data-nodetype="declaration">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-29" data-nodetype="expression">

</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="ojs-cell-1-30" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</section>
<section id="credit" class="level2">
<h2 class="anchored" data-anchor-id="credit"><i class="fa-solid fa-handshake" title="handshakes" aria-label="handshake"></i> Credit</h2>
<ul>
<li><p>The observable code was made with the help of <a href="https://github.com/fradav" target="_blank">François-David Collin</a></p></li>
<li><p>The plot is freely inspired from <a href="http://herbsusmann.com/" target="_blank">Herb Susmann</a>’s code on <a href="https://observablehq.com/@herbps10/dirichlet-distribution" target="_blank">Dirichlet Distribution</a></p></li>
<li><p>The terminology is inspired by posts from Gabriel Peyré: <a href="https://x.com/gabrielpeyre/status/1830470713041354968" target="_blank">https://x.com/gabrielpeyre/status/1830470713041354968</a>, <a href="https://x.com/gabrielpeyre/status/1680804520862056448" target="_blank">https://x.com/gabrielpeyre/status/1680804520862056448</a></p></li>
</ul>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references"><i class="fa-solid fa-link" title="link" aria-label="link"></i> References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-Boyd_Vandenberghe04" class="csl-entry">
Boyd, S., and L. Vandenberghe. 2004. <em>Convex Optimization</em>. Cambridge University Press.
</div>
</div>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>the case with <img src="https://latex.codecogs.com/png.latex?q_k=0"> for some <img src="https://latex.codecogs.com/png.latex?k"> can be reduced to a case with fewer coordinates↩︎</p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{salmon2024,
  author = {Salmon, Joseph and Collin, François-David},
  title = {Soft-Max and {Soft-argmax}},
  date = {2024-09-03},
  url = {https://josephsalmon.eu/blog/softmax/},
  langid = {en}
}
</code></pre></div></section></div> ]]></description>
  <category>statistics</category>
  <category>optimization</category>
  <category>machine learning</category>
  <guid>https://josephsalmon.eu/blog/softmax/</guid>
  <pubDate>Mon, 02 Sep 2024 22:00:00 GMT</pubDate>
  <media:content url="https://josephsalmon.eu/blog/softmax/softmax.png" medium="image" type="image/png" height="120" width="144"/>
</item>
<item>
  <title>Public civil servant salaries and inflation</title>
  <dc:creator>Joseph Salmon</dc:creator>
  <link>https://josephsalmon.eu/blog/inflation/</link>
  <description><![CDATA[ 
<div class="no-row-height column-margin column-container">
  <div class="">
    <img src="https://josephsalmon.eu/blog/inflation/point_indice.png" style="width:100%">
  </div>
</div>





<p>This is a post with executable code. It actually loads an old post from another website, that updates with a GitHub action; see <a href="https://josephsalmon.github.io/Tweets/economics/index.html" target="_blank">https://josephsalmon.github.io/Tweets/economics/index.html</a></p>
<br> <br> <br> <br>
<div style="transform: scale(0.5); transform-origin: top left; width: 200%; height: 200%;">
<iframe src="https://josephsalmon.github.io/Tweets/economics/index.html" width="105%" height="280%">
</iframe>
</div>
<p><br> <br> <br></p>


<!-- -->


 ]]></description>
  <category>news</category>
  <category>code</category>
  <category>data science</category>
  <category>economics</category>
  <guid>https://josephsalmon.eu/blog/inflation/</guid>
  <pubDate>Sun, 01 Sep 2024 22:00:00 GMT</pubDate>
  <media:content url="https://josephsalmon.eu/blog/inflation/point_indice.png" medium="image" type="image/png" height="107" width="144"/>
</item>
<item>
  <title>Welcome to Donadas Brutas!</title>
  <dc:creator>Joseph Salmon</dc:creator>
  <link>https://josephsalmon.eu/blog/hello-world/</link>
  <description><![CDATA[ 
<div class="no-row-height column-margin column-container">
  <div class="">
    <img src="https://josephsalmon.eu/blog/hello-world/Bezier_good.gif" style="width:100%">
  </div>
</div>





<p>In this blog, I intend to talk about things I like, powered by Quarto, Python, and a bit of Observable for some visualizations. You can expect math, stats, machine learning, biking and whatever I feel like sharing. And sometimes, I will also share things just because I find them nice…</p>
<p>I shall also mention</p>
<ul>
<li><a href="https://emilhvitfeldt.com/blog" target="_blank">Emil Hvitfeldt’s blog</a></li>
<li><a href="freakonometrics.hypotheses.org" target="_blank">Freakonometrics</a></li>
<li><a href="ploum.net" target="_blank">ploum.net</a></li>
</ul>
<p>who are all great sources of inspiration. <!-- 
<div style="text-align: center">
<a href="https://github.com/josephsalmon/Tweets/tree/master/Spline-ish">
  <img src="Bezier_good.gif" width=95% loop=infinite>
</a>
</div> --></p>


<!-- -->


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{salmon2024,
  author = {Salmon, Joseph},
  title = {Welcome to {Donadas} {Brutas!}},
  date = {2024-09-01},
  url = {https://josephsalmon.eu/blog/hello-world/},
  langid = {en}
}
</code></pre></div></section></div> ]]></description>
  <category>news</category>
  <guid>https://josephsalmon.eu/blog/hello-world/</guid>
  <pubDate>Sat, 31 Aug 2024 22:00:00 GMT</pubDate>
  <media:content url="https://josephsalmon.eu/blog/hello-world/Bezier_good.gif" medium="image" type="image/gif"/>
</item>
</channel>
</rss>
