<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="<strong>?meta:description</strong>">

<title>Joseph Salmon - Fait par :</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<link href="../../../..//img/Flag_of_Occitania.svg" rel="icon" type="image/svg+xml">
<script src="../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../../../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background-image: url(../../../../img/bg_pine_trees.jpg);
background-size: cover;
      }
</style>
<meta name="author" content="Joseph Salmon">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../../img/Flag_of_Occitania.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../../index.html">
    <span class="navbar-title">Joseph Salmon</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../Courses/index.html"> 
<span class="menu-text">Courses</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../talks/index.html"> 
<span class="menu-text">Talks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../team/index.html"> 
<span class="menu-text">Team</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/josephsalmon"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://sigmoid.social/@josephsalmon"> <i class="bi bi-mastodon" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/joseph-salmon-6134262a6/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:joseph.salmon@inria.fr"> <i class="bi bi-envelope" role="img" aria-label="email">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default blog-post page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Fait par :</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#modèle-linéaire-à-effets-mixtes" id="toc-modèle-linéaire-à-effets-mixtes" class="nav-link active" data-scroll-target="#modèle-linéaire-à-effets-mixtes">Modèle linéaire à effets mixtes</a>
  <ul class="collapse">
  <li><a href="#description-des-données" id="toc-description-des-données" class="nav-link" data-scroll-target="#description-des-données">Description des données</a></li>
  <li><a href="#objectif" id="toc-objectif" class="nav-link" data-scroll-target="#objectif">Objectif</a></li>
  <li><a href="#aperçu-des-données" id="toc-aperçu-des-données" class="nav-link" data-scroll-target="#aperçu-des-données">Aperçu des données</a></li>
  <li><a href="#modèle-1" id="toc-modèle-1" class="nav-link" data-scroll-target="#modèle-1">Modèle 1</a></li>
  <li><a href="#modèle-2" id="toc-modèle-2" class="nav-link" data-scroll-target="#modèle-2">Modèle 2</a>
  <ul class="collapse">
  <li><a href="#esemble-de-nos-essais" id="toc-esemble-de-nos-essais" class="nav-link" data-scroll-target="#esemble-de-nos-essais">Esemble de nos essais</a></li>
  </ul></li>
  <li><a href="#évaluation-du-modèle" id="toc-évaluation-du-modèle" class="nav-link" data-scroll-target="#évaluation-du-modèle">Évaluation du modèle</a></li>
  <li><a href="#modèle-3" id="toc-modèle-3" class="nav-link" data-scroll-target="#modèle-3">Modèle 3</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="fait-par" class="level4">
<h4 class="anchored" data-anchor-id="fait-par">Fait par :</h4>
<p>#### Mohamed Akli Rabia &amp; Samuel Kaci &amp; Ali Abed Alsater</p>
</section>
<section id="modèle-linéaire-à-effets-mixtes" class="level1">
<h1>Modèle linéaire à effets mixtes</h1>
<p>Nous allons dans ce projet nous intéresser à une variante des modèles linéaires, le modèle linéaire à effets mixtes. Ce modèle est composé d’une partie fixe et d’une partie aléatoire. La partie fixe est identique pour chaque individu et représente l’effet de la population en général. La partie aléatoire est propre à chacun des individus et traduit la variabilité liée à chaque sujet.</p>
<section id="description-des-données" class="level2">
<h2 class="anchored" data-anchor-id="description-des-données">Description des données</h2>
<p>Nous allons travailler sur le jeu de données “politness” qui regroupe plusieurs données décrivant le ton de la voix (enregistrées en fréquences) afin de faire un lien avec la politesse. L’expérience est faite sur plusieurs sujets, ou ils devaient parler avec différents tons selon plusieurs scénarios.</p>
<p>On compte des scénarios formels nécessitant de la politesse et d’autres non. Le ton de la voix est mesuré à chaque fois, on note le sexe de chaque sujet aussi, car il peut être influent sur la voix.</p>
</section>
<section id="objectif" class="level2">
<h2 class="anchored" data-anchor-id="objectif">Objectif</h2>
<p>Le but est donc d’expliquer la variable “frequency” qui représente le ton de la voix avec les variables “sexe” et “attitude” cette dernière représente la politesse</p>
</section>
<section id="aperçu-des-données" class="level2">
<h2 class="anchored" data-anchor-id="aperçu-des-données">Aperçu des données</h2>
<p>Nous commençons par importer les données “politness”, et charger les librairies standards dont nous avons besoin.</p>
<div id="cell-9" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">## lecture des données</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#data = pd.read_csv("http://www.bodowinter.com/tutorial/politeness_data.csv") Le lien ne marche plus</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">'https://qubeshub.org/qubesresources/publications/901/serve/1/2691?el=1&amp;download=1'</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">subject</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">scenario</th>
<th data-quarto-table-cell-role="th">attitude</th>
<th data-quarto-table-cell-role="th">frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>F1</td>
<td>F</td>
<td>1</td>
<td>pol</td>
<td>213.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>F1</td>
<td>F</td>
<td>1</td>
<td>inf</td>
<td>204.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>F1</td>
<td>F</td>
<td>2</td>
<td>pol</td>
<td>285.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>F1</td>
<td>F</td>
<td>2</td>
<td>inf</td>
<td>259.7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>F1</td>
<td>F</td>
<td>3</td>
<td>pol</td>
<td>203.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="cell-10" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>?data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nous pouvons voir que le plan est équilibré.</p>
<div id="cell-12" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data.subject.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>M7    14
F3    14
F2    14
M4    14
M3    14
F1    14
Name: subject, dtype: int64</code></pre>
</div>
</div>
<div id="cell-13" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>pd.crosstab(data.subject, data.attitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">attitude</th>
<th data-quarto-table-cell-role="th">inf</th>
<th data-quarto-table-cell-role="th">pol</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">subject</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">F1</td>
<td>7</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">F2</td>
<td>7</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">F3</td>
<td>7</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">M3</td>
<td>7</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">M4</td>
<td>7</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">M7</td>
<td>7</td>
<td>7</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Boxplot qui exprime la variation de la fréquence par rapport aux deux modalités “inf” et “pol” de chaque sujet.</p>
<div id="cell-15" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>boxplot <span class="op">=</span> sns.boxplot(x<span class="op">=</span>data.attitude[data.subject<span class="op">==</span><span class="st">'F2'</span>],y<span class="op">=</span>data.frequency[data.subject<span class="op">==</span><span class="st">'F2'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ModelesLineairesMixtes_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-16" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>boxplot <span class="op">=</span> sns.boxplot(x<span class="op">=</span>data.attitude[data.subject<span class="op">==</span><span class="st">'M3'</span>],y<span class="op">=</span>data.frequency[data.subject<span class="op">==</span><span class="st">'M3'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ModelesLineairesMixtes_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Moyenne des fréquences par sujet.</p>
<div id="cell-18" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>data.groupby(<span class="st">'subject'</span>)[<span class="st">'frequency'</span>].mean()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>subject
F1    232.035714
F2    258.185714
F3    250.735714
M3    168.978571
M4    145.976923
M7    102.178571
Name: frequency, dtype: float64</code></pre>
</div>
</div>
<p>Affichage des modalités “pol” et “inf”.</p>
<div id="cell-20" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data[data.attitude <span class="op">==</span> <span class="st">"pol"</span> ].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">subject</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">scenario</th>
<th data-quarto-table-cell-role="th">attitude</th>
<th data-quarto-table-cell-role="th">frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>F1</td>
<td>F</td>
<td>1</td>
<td>pol</td>
<td>213.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>F1</td>
<td>F</td>
<td>2</td>
<td>pol</td>
<td>285.1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>F1</td>
<td>F</td>
<td>3</td>
<td>pol</td>
<td>203.9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>F1</td>
<td>F</td>
<td>4</td>
<td>pol</td>
<td>250.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>F1</td>
<td>F</td>
<td>5</td>
<td>pol</td>
<td>231.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="cell-21" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>data[data.attitude <span class="op">==</span> <span class="st">"inf"</span> ].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">subject</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">scenario</th>
<th data-quarto-table-cell-role="th">attitude</th>
<th data-quarto-table-cell-role="th">frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>F1</td>
<td>F</td>
<td>1</td>
<td>inf</td>
<td>204.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>F1</td>
<td>F</td>
<td>2</td>
<td>inf</td>
<td>259.7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>F1</td>
<td>F</td>
<td>3</td>
<td>inf</td>
<td>286.9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>F1</td>
<td>F</td>
<td>4</td>
<td>inf</td>
<td>276.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>F1</td>
<td>F</td>
<td>5</td>
<td>inf</td>
<td>252.4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Nous allons afficher un graphique de nos données, pour voir l’allure qu’elles ont.</p>
<div id="cell-23" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>matplotlib.style.use(<span class="st">'ggplot'</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>plt.scatter(data.frequency[data.attitude <span class="op">==</span> <span class="st">"pol"</span> ], data.frequency[data.attitude<span class="op">==</span><span class="st">"inf"</span>])</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ModelesLineairesMixtes_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>À l’oeil nu, le nuage paraît linéaire, nous remarquons aussi un individu qui se démarque du groupe, il se peut qu’il soit atypique.</p>
<p>Nous allons voir ici un aperçu des moyennes des fréquences de la voix par groupe.</p>
<div id="cell-26" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data.groupby(<span class="st">'subject'</span>)[<span class="st">'frequency'</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>subject
F1    232.035714
F2    258.185714
F3    250.735714
M3    168.978571
M4    145.976923
M7    102.178571
Name: frequency, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="modèle-1" class="level2">
<h2 class="anchored" data-anchor-id="modèle-1">Modèle 1</h2>
<p>Nous allons construire le modèle de régression mixte d’abord en s’appuyant sur l’effet aléatoire de la constante, on suppose que le ton moyen est différent pour chaque individu, on utilise la fonction “mixedlm” contenue dans “statmodels”. Pour ce faire, nous devons obligatoirement supprimer la ligne 38 qui contient une donnée manquante.</p>
<div id="cell-29" class="cell" data-scrolled="true" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Supprimé la valeur manquante</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span>data.dropna()</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>md <span class="op">=</span> smf.mixedlm(<span class="st">"frequency ~ 1"</span>, A, groups<span class="op">=</span>A[<span class="st">"subject"</span>])</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>mdf <span class="op">=</span> md.fit()</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mdf.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Mixed Linear Model Regression Results
=======================================================
Model:            MixedLM Dependent Variable: frequency
No. Observations: 83      Method:             REML     
No. Groups:       6       Scale:              941.2110 
Min. group size:  13      Likelihood:         -409.4981
Max. group size:  14      Converged:          Yes      
Mean group size:  13.8                                 
-------------------------------------------------------
           Coef.   Std.Err.   z   P&gt;|z|  [0.025  0.975]
-------------------------------------------------------
Intercept  193.025   25.913 7.449 0.000 142.236 243.815
Group Var 3960.949   85.703                            
=======================================================
</code></pre>
</div>
</div>
<p>Les résultats sont contenus dans l’objet ” mdf “, nous pouvons voir les valeurs de l’intercepte de chaque sujet dans” mdf.fittedvalues ”</p>
<div id="cell-31" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pd.crosstab(mdf.fittedvalues, A.subject)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">subject</th>
<th data-quarto-table-cell-role="th">F1</th>
<th data-quarto-table-cell-role="th">F2</th>
<th data-quarto-table-cell-role="th">F3</th>
<th data-quarto-table-cell-role="th">M3</th>
<th data-quarto-table-cell-role="th">M4</th>
<th data-quarto-table-cell-role="th">M7</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">row_0</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">103.694781</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">146.821466</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>13</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">169.379905</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>14</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">231.384639</td>
<td>14</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">249.772540</td>
<td>0</td>
<td>0</td>
<td>14</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">257.098202</td>
<td>0</td>
<td>14</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>L’estimation de la constante est donnée par la moyenne sur la variable à expliquer qui est “frequency” et l’estimation de la déviance est donnée son écart type.</p>
<div id="cell-33" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimation d'intercept</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>np.mean(A.frequency)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>193.58192771084342</code></pre>
</div>
</div>
<div id="cell-34" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#estimation de la déviance</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>np.std(A.frequency)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>65.14466042452061</code></pre>
</div>
</div>
</section>
<section id="modèle-2" class="level2">
<h2 class="anchored" data-anchor-id="modèle-2">Modèle 2</h2>
<p>Nous allons maintenant inclure les effets fixes dans le modèle, nous allons tenir compte du sexe et des effets aléatoires. Le modèle est <span class="math display"> frequecy = intercept + intercept_j + attitude + sexe </span></p>
<p>Nous devons d’abord transformé les variables “sexe” et “attitude” en variables numériques, codées en -1, 1. (femme=1 , homme=-1), (pol=-1, inf=1), afin d’avoir la somme des deux modalités de chaque variable est égale à 0.</p>
<p>Pour cette partie nous avons utilisé de nombreuses méthodes, qui se sont toutes retrouvées très peu fructueuses. Nous allons vous en présenter quelques-unes dans cette partie.</p>
<p>Afin de pouvoir continuer le Tp nous avons fait le choix de créer un nouveau data a format csv de la forme souhaité.</p>
<section id="esemble-de-nos-essais" class="level3">
<h3 class="anchored" data-anchor-id="esemble-de-nos-essais">Esemble de nos essais</h3>
<p>Nous avons commencé par utilisé la fonction “factorize” contenue dans pandas, mais elle transforme la variable en 0,1. Ce qui ne nous arrange pas.</p>
<div id="cell-41" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>pd.factorize(A.gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>(array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]),
 Index(['F', 'M'], dtype='object'))</code></pre>
</div>
</div>
<p>Puis nous avons essayé de le faire à la main avec une boucle for.</p>
<div id="cell-43" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.copy(A)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, A.shape[<span class="dv">0</span>]):</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data[<span class="st">'gender'</span>][i] <span class="op">==</span> <span class="st">'F'</span>:</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>        B[i][<span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        B[i][<span class="dv">1</span>] <span class="op">=</span> <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data[<span class="st">'attitude'</span>][i] <span class="op">==</span> <span class="st">'inf'</span>:</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>        B[i][<span class="dv">3</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>        B[i][<span class="dv">3</span>] <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>        </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-44" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>numpy.ndarray</code></pre>
</div>
</div>
<p>Ici nous pouvons voir que le type de B n’est pas le même que A, nous allons donc le convertir</p>
<div id="cell-46" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> pd.DataFrame(B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-47" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>B.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>F1</td>
<td>1</td>
<td>1</td>
<td>-1</td>
<td>213.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>F1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>204.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>F1</td>
<td>1</td>
<td>2</td>
<td>-1</td>
<td>285.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>F1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>259.7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>F1</td>
<td>1</td>
<td>3</td>
<td>-1</td>
<td>203.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Ici nous remarquons que nous avons perdu le nom des colonnes.</p>
<div id="cell-49" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>B.columns <span class="op">=</span> [<span class="st">'subject'</span>, <span class="st">'gender'</span>, <span class="st">'scenario'</span>, <span class="st">'attitude'</span>, <span class="st">'frequency'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-50" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(B))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;</code></pre>
</div>
</div>
<div id="cell-51" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(B.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  subject gender scenario attitude frequency
0      F1      1        1       -1     213.3
1      F1      1        1        1     204.5
2      F1      1        2       -1     285.1
3      F1      1        2        1     259.7
4      F1      1        3       -1     203.9</code></pre>
</div>
</div>
<p>À cette étape B est devenu une copie parfaite de A, avec les variables “gender” et “attitude” recoder en -1 et 1. Mais malgré cela il nous est impossible d’utiliser la matrice B avec les fonctions dont nous avons besoin.</p>
<p>Nous avons donc intégré le jeu de données suivant ayant la transformation voulue.</p>
<div id="cell-54" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>A2<span class="op">=</span>pd.read_csv(<span class="st">"data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-55" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Modèle 2</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>md2 <span class="op">=</span> smf.mixedlm(<span class="st">"frequency ~ attitude + gender"</span>, A2, groups<span class="op">=</span>A2[<span class="st">"subject"</span>])</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>mdf2 <span class="op">=</span> md2.fit()</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>mdf2.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td>Model:</td>
<td>MixedLM</td>
<td>Dependent Variable:</td>
<td>frequency</td>
</tr>
<tr class="even">
<td>No. Observations:</td>
<td>83</td>
<td>Method:</td>
<td>REML</td>
</tr>
<tr class="odd">
<td>No. Groups:</td>
<td>6</td>
<td>Scale:</td>
<td>850.9501</td>
</tr>
<tr class="even">
<td>Min. group size:</td>
<td>13</td>
<td>Likelihood:</td>
<td>-394.7583</td>
</tr>
<tr class="odd">
<td>Max. group size:</td>
<td>14</td>
<td>Converged:</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Mean group size:</td>
<td>13.8</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td></td>
<td data-quarto-table-cell-role="th">Coef.</td>
<td data-quarto-table-cell-role="th">Std.Err.</td>
<td data-quarto-table-cell-role="th">z</td>
<td data-quarto-table-cell-role="th">P&gt;|z|</td>
<td data-quarto-table-cell-role="th">[0.025</td>
<td data-quarto-table-cell-role="th">0.975]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Intercept</td>
<td>192.883</td>
<td>10.531</td>
<td>18.315</td>
<td>0.000</td>
<td>172.242</td>
<td>213.524</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">attitude</td>
<td>9.705</td>
<td>3.203</td>
<td>3.030</td>
<td>0.002</td>
<td>3.426</td>
<td>15.983</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">gender</td>
<td>54.102</td>
<td>10.531</td>
<td>5.137</td>
<td>0.000</td>
<td>33.462</td>
<td>74.743</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Group Var</td>
<td>603.873</td>
<td>16.530</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="évaluation-du-modèle" class="level2">
<h2 class="anchored" data-anchor-id="évaluation-du-modèle">Évaluation du modèle</h2>
<p>Pour évaluer la qualité d’un modèle, ou faire des comparaisons avec d’autres modèles, le critère AIC est souvent utilisé. Ce critère doit être minimisé, c’est-à-dire que l’on choisit le modèle ayant le AIC le plus faible. <span class="math display"> AIC = déviance + 2*(P+1)</span> <span class="math display"> déviance = -2 * logvraissemblance </span> P est le nombre de paramètres dans le modèle.</p>
<p>Afin de calculer la déviance, il nous faut la log-vraisemblance, elle est contenue dans l’objet “mdf2.llf”, nous allons donc calculer l’AIC du modèle 2 en appliquant la formule définie précédemment. Notons ici que “P” est égal à 4, nous comptons 3 paramètres fixes et 1 aléatoire.</p>
<div id="cell-58" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># D'abord la déviance</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>dev <span class="op">=</span> <span class="op">-</span><span class="dv">2</span><span class="op">*</span>mdf2.llf</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>789.5165130342868</code></pre>
</div>
</div>
<div id="cell-59" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># p = 4 </span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>AIC <span class="op">=</span> dev <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> (<span class="dv">4</span> <span class="op">+</span> <span class="dv">1</span>) </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(AIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>799.5165130342868</code></pre>
</div>
</div>
<p>Nous allons essayer de retrouver le résultat avec la fonction AIC contenue dans “RegscorePy”. Pour cela il nous faut la variable à prédire, c’est-à-dire <span class="math inline">y=frequency</span> et les valeurs ajustées <span class="math inline">\hat{y}</span> qui sont contenues dans l’objet “mdf2.fittedvalues”.</p>
<div id="cell-61" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>pip install RegscorePy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Requirement already satisfied: RegscorePy in /home/jo/anaconda3/lib/python3.7/site-packages (1.1)
Requirement already satisfied: pandas in /home/jo/anaconda3/lib/python3.7/site-packages (from RegscorePy) (0.24.2)
Requirement already satisfied: numpy in /home/jo/anaconda3/lib/python3.7/site-packages (from RegscorePy) (1.16.2)
Requirement already satisfied: python-dateutil&gt;=2.5.0 in /home/jo/anaconda3/lib/python3.7/site-packages (from pandas-&gt;RegscorePy) (2.8.0)
Requirement already satisfied: pytz&gt;=2011k in /home/jo/anaconda3/lib/python3.7/site-packages (from pandas-&gt;RegscorePy) (2018.9)
Requirement already satisfied: six&gt;=1.5 in /home/jo/anaconda3/lib/python3.7/site-packages (from python-dateutil&gt;=2.5.0-&gt;pandas-&gt;RegscorePy) (1.12.0)
Note: you may need to restart the kernel to use updated packages.</code></pre>
</div>
</div>
<div id="cell-62" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> RegscorePy <span class="im">import</span> <span class="op">*</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>aic.aic(A2.frequency,mdf2.fittedvalues, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>561.0373784032621</code></pre>
</div>
</div>
<p>Nous ne trouvons pas le même résultat ce qui n’est pas normal.</p>
</section>
<section id="modèle-3" class="level2">
<h2 class="anchored" data-anchor-id="modèle-3">Modèle 3</h2>
<p><span class="math display">frequency for subject A = intercept + subject A \text{'} s\hspace{0.1cm} intercept\hspace{0.1cm} \text{shift} + attitude + subject A\text{'}s \hspace{0.1cm} attitude \hspace{0.1cm}slope \hspace{0.1cm} \text{shift} + gender</span></p>
<p>Dans les modèles ci-dessus, nous avons supposé que l’effet de la “politesse” (représenté par la variable “attitude”) était le même pour tous les sujets, et a donc un seul coefficient pour la politesse. Cependant, l’effet de la politesse peut être différent pour différents sujets. Par exemple, on pourrait s’attendre à ce que certaines personnes soient plus polies que d’autres. Donc, ce qu’il nous faut c’est un modèle de pente aléatoire, où les sujets et les objets sont non seulement autorisés à avoir des intercepts différents, mais où ils sont également autorisés à avoir des pentes différentes pour l’effet de politesse.</p>
<div id="cell-66" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Modèle 3</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>md3 <span class="op">=</span> smf.mixedlm(<span class="st">"frequency ~ attitude + gender"</span>, A2, groups<span class="op">=</span> <span class="st">"attitude"</span> <span class="op">+</span> A2[<span class="st">"subject"</span>])</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>mdf3 <span class="op">=</span> md3.fit()</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>mdf3.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td>Model:</td>
<td>MixedLM</td>
<td>Dependent Variable:</td>
<td>frequency</td>
</tr>
<tr class="even">
<td>No. Observations:</td>
<td>83</td>
<td>Method:</td>
<td>REML</td>
</tr>
<tr class="odd">
<td>No. Groups:</td>
<td>6</td>
<td>Scale:</td>
<td>850.9501</td>
</tr>
<tr class="even">
<td>Min. group size:</td>
<td>13</td>
<td>Likelihood:</td>
<td>-394.7583</td>
</tr>
<tr class="odd">
<td>Max. group size:</td>
<td>14</td>
<td>Converged:</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Mean group size:</td>
<td>13.8</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td></td>
<td data-quarto-table-cell-role="th">Coef.</td>
<td data-quarto-table-cell-role="th">Std.Err.</td>
<td data-quarto-table-cell-role="th">z</td>
<td data-quarto-table-cell-role="th">P&gt;|z|</td>
<td data-quarto-table-cell-role="th">[0.025</td>
<td data-quarto-table-cell-role="th">0.975]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Intercept</td>
<td>192.883</td>
<td>10.531</td>
<td>18.315</td>
<td>0.000</td>
<td>172.242</td>
<td>213.524</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">attitude</td>
<td>9.705</td>
<td>3.203</td>
<td>3.030</td>
<td>0.002</td>
<td>3.426</td>
<td>15.983</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">gender</td>
<td>54.102</td>
<td>10.531</td>
<td>5.137</td>
<td>0.000</td>
<td>33.462</td>
<td>74.743</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Group Var</td>
<td>603.873</td>
<td>16.530</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Tout au long de ce Tp nous avons utilisé et mis en oeuvre les différentes techniques associées aux modèles linéaires mixtes.</p>


</section>
</section>

</main> <!-- /main -->
<hr>

<span style="margin-top:20px; margin-bottom: 20px"></span>

<!-- <img style="width:100%;" src="/img/marvins_log_thumbnail.png"> -->

<!-- <p style="margin: 20px"> Do you enjoy my blog? Subscribe here to get notifications and updates (it's free!):</p> -->

<!-- <div class="grid">
  <div class=".d-none .d-md-block g-col-md-1"></div>
  <div class="g-col-12 g-col-md-10">
    <iframe src="https://embeds.beehiiv.com/c7111066-479b-43db-ad92-8d703fe96bf0?slim=true" data-test-id="beehiiv-embed" frameborder="0" scrolling="no" style="margin: 0; border-radius: 0px !important; background-color: transparent; width:100%; padding: 20px"></iframe>
  </div>
  <div class=".d-none .d-md-block g-col-md-1"></div>
</div> -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><span class="faux-block"><i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i> 2024 Joseph Salmon</span> <span class="faux-block"><a href="https://github.com/josephsalmon/MyWebsite"><i class="fa-brands fa-github" aria-label="github"></i> Source Code</a></span></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p><span class="faux-block"> Designed with <i class="fa-solid fa-heart" aria-label="heart"></i></span> <span class="faux-block"> Built with <a href="https://quarto.org/">Quarto</a></span></p>
</div>
  </div>
</footer>




</body></html>